{
"version":3,
"file":"module$node_modules$$sentry$tracing$dist$integrations$node$express.js",
"lineCount":6,
"mappings":"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",
"sources":["node_modules/@sentry/tracing/dist/integrations/node/express.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$$sentry$tracing$dist$integrations$node$express\"] = function(global,require,module,exports) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar utils_1 = require(\"@sentry/utils\");\n/**\n * Express integration\n *\n * Provides an request and error handler for Express framework as well as tracing capabilities\n */\nvar Express = /** @class */ (function () {\n    /**\n     * @inheritDoc\n     */\n    function Express(options) {\n        if (options === void 0) { options = {}; }\n        /**\n         * @inheritDoc\n         */\n        this.name = Express.id;\n        this._router = options.router || options.app;\n        this._methods = (Array.isArray(options.methods) ? options.methods : []).concat('use');\n    }\n    /**\n     * @inheritDoc\n     */\n    Express.prototype.setupOnce = function () {\n        if (!this._router) {\n            utils_1.logger.error('ExpressIntegration is missing an Express instance');\n            return;\n        }\n        instrumentMiddlewares(this._router, this._methods);\n    };\n    /**\n     * @inheritDoc\n     */\n    Express.id = 'Express';\n    return Express;\n}());\nexports.Express = Express;\n/**\n * Wraps original middleware function in a tracing call, which stores the info about the call as a span,\n * and finishes it once the middleware is done invoking.\n *\n * Express middlewares have 3 various forms, thus we have to take care of all of them:\n * // sync\n * app.use(function (req, res) { ... })\n * // async\n * app.use(function (req, res, next) { ... })\n * // error handler\n * app.use(function (err, req, res, next) { ... })\n *\n * They all internally delegate to the `router[method]` of the given application instance.\n */\n// eslint-disable-next-line @typescript-eslint/ban-types, @typescript-eslint/no-explicit-any\nfunction wrap(fn, method) {\n    var arity = fn.length;\n    switch (arity) {\n        case 2: {\n            return function (req, res) {\n                var transaction = res.__sentry_transaction;\n                if (transaction) {\n                    var span_1 = transaction.startChild({\n                        description: fn.name,\n                        op: \"express.middleware.\" + method,\n                    });\n                    res.once('finish', function () {\n                        span_1.finish();\n                    });\n                }\n                return fn.call(this, req, res);\n            };\n        }\n        case 3: {\n            return function (req, res, next) {\n                var _a;\n                var transaction = res.__sentry_transaction;\n                var span = (_a = transaction) === null || _a === void 0 ? void 0 : _a.startChild({\n                    description: fn.name,\n                    op: \"express.middleware.\" + method,\n                });\n                fn.call(this, req, res, function () {\n                    var args = [];\n                    for (var _i = 0; _i < arguments.length; _i++) {\n                        args[_i] = arguments[_i];\n                    }\n                    var _a;\n                    (_a = span) === null || _a === void 0 ? void 0 : _a.finish();\n                    next.call.apply(next, tslib_1.__spread([this], args));\n                });\n            };\n        }\n        case 4: {\n            return function (err, req, res, next) {\n                var _a;\n                var transaction = res.__sentry_transaction;\n                var span = (_a = transaction) === null || _a === void 0 ? void 0 : _a.startChild({\n                    description: fn.name,\n                    op: \"express.middleware.\" + method,\n                });\n                fn.call(this, err, req, res, function () {\n                    var args = [];\n                    for (var _i = 0; _i < arguments.length; _i++) {\n                        args[_i] = arguments[_i];\n                    }\n                    var _a;\n                    (_a = span) === null || _a === void 0 ? void 0 : _a.finish();\n                    next.call.apply(next, tslib_1.__spread([this], args));\n                });\n            };\n        }\n        default: {\n            throw new Error(\"Express middleware takes 2-4 arguments. Got: \" + arity);\n        }\n    }\n}\n/**\n * Takes all the function arguments passed to the original `app` or `router` method, eg. `app.use` or `router.use`\n * and wraps every function, as well as array of functions with a call to our `wrap` method.\n * We have to take care of the arrays as well as iterate over all of the arguments,\n * as `app.use` can accept middlewares in few various forms.\n *\n * app.use([<path>], <fn>)\n * app.use([<path>], <fn>, ...<fn>)\n * app.use([<path>], ...<fn>[])\n */\nfunction wrapMiddlewareArgs(args, method) {\n    return args.map(function (arg) {\n        if (typeof arg === 'function') {\n            return wrap(arg, method);\n        }\n        if (Array.isArray(arg)) {\n            return arg.map(function (a) {\n                if (typeof a === 'function') {\n                    return wrap(a, method);\n                }\n                return a;\n            });\n        }\n        return arg;\n    });\n}\n/**\n * Patches original router to utilize our tracing functionality\n */\nfunction patchMiddleware(router, method) {\n    var originalCallback = router[method];\n    router[method] = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return originalCallback.call.apply(originalCallback, tslib_1.__spread([this], wrapMiddlewareArgs(args, method)));\n    };\n    return router;\n}\n/**\n * Patches original router methods\n */\nfunction instrumentMiddlewares(router, methods) {\n    if (methods === void 0) { methods = []; }\n    methods.forEach(function (method) { return patchMiddleware(router, method); });\n}\n//# sourceMappingURL=express.js.map\n};"],
"names":["shadow$provide","global","require","module","exports","wrap","fn","method","arity","length","req","res","transaction","__sentry_transaction","span_1","startChild","description","name","op","once","finish","call","next","_a","span","args","_i","arguments","apply","tslib_1","__spread","err","Error","wrapMiddlewareArgs","map","arg","Array","isArray","a","patchMiddleware","router","originalCallback","instrumentMiddlewares","methods","forEach","Object","defineProperty","value","utils_1","Express","options","id","_router","app","_methods","concat","prototype","setupOnce","Express.prototype.setupOnce","logger","error"]
}
