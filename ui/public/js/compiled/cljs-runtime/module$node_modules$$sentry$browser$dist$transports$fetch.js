shadow$provide.module$node_modules$$sentry$browser$dist$transports$fetch=function(global,require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("module$node_modules$tslib$tslib"),core_1=require("module$node_modules$$sentry$core$dist$index"),types_1=require("module$node_modules$$sentry$types$dist$index"),utils_1=require("module$node_modules$$sentry$utils$dist$index");global=require("module$node_modules$$sentry$browser$dist$transports$base");var utils_2=require("module$node_modules$$sentry$browser$dist$transports$utils");
require=function(_super){function FetchTransport(options,fetchImpl){void 0===fetchImpl&&(fetchImpl=utils_2.getNativeFetchImplementation());options=_super.call(this,options)||this;options._fetch=fetchImpl;return options}tslib_1.__extends(FetchTransport,_super);FetchTransport.prototype.sendEvent=function(event){return this._sendRequest(core_1.eventToSentryRequest(event,this._api),event)};FetchTransport.prototype.sendSession=function(session){return this._sendRequest(core_1.sessionToSentryRequest(session,
this._api),session)};FetchTransport.prototype._sendRequest=function(sentryRequest,originalPayload){var _this=this;if(this._isRateLimited(sentryRequest.type))return this.recordLostEvent(types_1.Outcome.RateLimitBackoff,sentryRequest.type),Promise.reject({event:originalPayload,type:sentryRequest.type,reason:"Transport for "+sentryRequest.type+" requests locked till "+this._disabledUntil(sentryRequest.type)+" due to too many requests.",status:429});var options={body:sentryRequest.body,method:"POST",
referrerPolicy:utils_1.supportsReferrerPolicy()?"origin":""};void 0!==this.options.fetchParameters&&Object.assign(options,this.options.fetchParameters);void 0!==this.options.headers&&(options.headers=this.options.headers);return this._buffer.add(function(){return new utils_1.SyncPromise(function(resolve,reject){void _this._fetch(sentryRequest.url,options).then(function(response){var headers={"x-sentry-rate-limits":response.headers.get("X-Sentry-Rate-Limits"),"retry-after":response.headers.get("Retry-After")};
_this._handleResponse({requestType:sentryRequest.type,response,headers,resolve,reject})}).catch(reject)})}).then(void 0,function(reason){reason instanceof utils_1.SentryError?_this.recordLostEvent(types_1.Outcome.QueueOverflow,sentryRequest.type):_this.recordLostEvent(types_1.Outcome.NetworkError,sentryRequest.type);throw reason;})};return FetchTransport}(global.BaseTransport);exports.FetchTransport=require}
//# sourceMappingURL=module$node_modules$$sentry$browser$dist$transports$fetch.js.map
