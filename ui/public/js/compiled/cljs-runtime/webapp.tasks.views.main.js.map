{"version":3,"sources":["webapp/tasks/views/main.cljs"],"mappings":"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","names":["webapp.tasks.views.main/template-params-configuration","p1__30257#","p2__30258#","template","re_frame.core.subscribe","state","reagent.core.atom","target","update-state","cljs.core.swap_BANG_","cljs.core/assoc","p1__30260#","cljs.core/deref","webapp.components.headings/h2","e","re-frame.core/dispatch","webapp.components.headings/h3","cljs.core.doall","iter__4652__auto__","s__30262","cljs.core/LazySeq","temp__5753__auto__","cljs.core/seq","cljs.core/chunked-seq?","c__4650__auto__","size__4651__auto__","cljs.core/count","b__30264","cljs.core/chunk-buffer","i__30263","cljs.core/-nth","cljs.core/chunk-append","p1__30259#","cljs.core/chunk-cons","cljs.core/chunk","iter__30261","cljs.core/chunk-rest","cljs.core/first","cljs.core/cons","cljs.core/rest","param","webapp.components.forms/input","cljs.core.get","webapp.components.divider/main","cljs.core/reset!","webapp.components.button/secondary","webapp.components.button/primary","cljs.core._EQ_","webapp.tasks.views.main/templates-list","templates","cljs.core/empty?","s__30266","b__30268","i__30267","iter__30265","webapp.tasks.views.main/new-task-from-template","js/webapp","js/webapp.tasks","js/webapp.tasks.views","js/webapp.tasks.views.main","js/webapp.tasks.views.main.tab-view","method-table__4747__auto__","cljs.core.atom","prefer-table__4748__auto__","method-cache__4749__auto__","cached-hierarchy__4750__auto__","hierarchy__4751__auto__","fexpr__30269","cljs.core/MultiFn","cljs.core.symbol","webapp.tasks.views.main/tab-view","cljs.core/identity","tasks","targets","webapp.tasks.views.tasks-filters/tasks-filters","webapp.tasks.views.tasks-list/tasks-list","webapp.tasks.views.item-detail/item-detail","reviews","webapp.tasks.views.reviews-list/reviews-list","webapp.tasks.views.review-detail/review-detail","webapp.tasks.views.main/panel","view","manage-tab-change","clicked-tab","webapp.components.tabs/tabs","cljs.core/chunk-first"],"sourcesContent":["(ns webapp.tasks.views.main\n  (:require\n   [reagent.core :as r]\n   [re-frame.core :as rf]\n   [webapp.tasks.events]\n   [webapp.tasks.events.templates]\n   [webapp.tasks.views.item-detail :as item-detail]\n   [webapp.tasks.views.review-detail :as review-detail]\n   [webapp.tasks.views.tasks-filters :as filters]\n   [webapp.tasks.views.tasks-list :as tasks-list]\n   [webapp.tasks.views.reviews-list :as reviews-list]\n   [webapp.components.tabs :as tabs]\n   [webapp.components.forms :as forms]\n   [webapp.components.headings :as h]\n   [webapp.components.divider :as divider]\n   [webapp.components.button :as button]\n   [webapp.subs :as subs]))\n\n(defn- template-params-configuration []\n  (let [template (rf/subscribe [::subs/active-template])\n        state (r/atom {})\n        target (r/atom \"\")\n        update-state #(swap! state assoc %1 %2)]\n    (fn []\n      [:div\n       [:header.mb-regular\n        [h/h2 \"Run task from Template\" {}]\n        [:div.text-sm.text-gray-500\n         \"Complete the last step to run a task from a template\"]]\n       [:section\n        [:form\n         {:on-submit (fn [e]\n                       (.preventDefault e)\n                       (rf/dispatch [:create-task-from-template (-> @template :template :name) @state @target]))}\n         [:header.mb-regular\n          [h/h3 (-> @template :template :name) {}]\n          [:span.text-gray-500.text-xs\n           \"Fill the params below for this template\"]]\n         (doall (for [param (-> @template :template :params)]\n                  ^{:key param}\n                  [:div\n                   [forms/input {:label param\n                                 :placeholder (str \"Define a value for \" param)\n                                 :value (get @state param)\n                                 :on-change #(update-state param (-> % .-target .-value))\n                                 :required true}]]))\n         [divider/main]\n\n         [:section\n          [:header.mb-regular\n           [h/h3 \"Target name\" {}]\n           [:span.text-gray-500.text-xs\n            \"Type the name of the target you want to run this task\"]]\n          [forms/input\n           {:placeholder \"Your-target-name\"\n            :required true\n            :on-change #(reset! target (-> % .-target .-value))\n            :value @target}]]\n         [divider/main]\n         [:footer.flex.gap-regular.justify-end\n          [button/secondary {:text \"Cancel\"\n                             :on-click #(rf/dispatch [:close-modal])}]\n          [button/primary {:text \"Create task\"\n                           :disabled (= (-> @template :status) :loading)\n                           :type \"submit\"}]]]]])))\n\n(defn- templates-list []\n  (let [templates (rf/subscribe [::subs/templates])]\n    (fn []\n      [:div\n       [:header.mb-regular\n        [h/h2 \"Run task from Template\" {}]\n        [:div.text-sm.text-gray-500\n         \"Select a template to run\"]]\n\n       (cond\n         (= :loading (:status @templates)) [:span {:class \"mt-regular\"} \"loading...\"]\n         (empty? @templates) [:<>\n                              [:p {:class \"my-large text-center\"} \"You don't have any Github repository integrate.\"]\n                              [:a {:class \"flex gap-regular items-center justify-center border rounded-lg p-regular cursor-pointer hover:bg-gray-100 transition\"\n                                   :href \"/settings\"\n                                   :on-click #(rf/dispatch [:close-select-templates-modal])}\n                               \"Go to settings\"]]\n         :else [:div.border.rounded-lg\n                (for [template @templates]\n                  ^{:key template}\n                  [:div.cursor-pointer.px-small.py-regular.text-sm.text-gray-700.hover:text-blue-500.hover:bg-gray-50.transition.border-b\n                   {:on-click #(rf/dispatch [:open-template-params-modal template [template-params-configuration]])}\n                   template])])])))\n\n(defn- new-task-from-template []\n  (rf/dispatch [:get-templates])\n  (rf/dispatch [:open-select-templates-modal [templates-list]]))\n\n(defmulti tab-view identity)\n(defmethod tab-view :Tasks []\n  (let [tasks @(rf/subscribe [::subs/tasks])\n        targets @(rf/subscribe [::subs/targets])]\n    [:div\n     [:header.flex.mb-regular.gap-regular\n      [:div.flex.flex-grow\n       [filters/tasks-filters (:filters tasks) targets]]\n      [:div.flex.justify-self-end.flex-shrink-0\n       [button/primary {:on-click #(rf/dispatch [:navigate :new-task])\n                        :more-options [\"New task from template\"]\n                        :on-click-option #(new-task-from-template)\n                        :text \"New task\"}]]]\n     [:div.grid.grid-cols-8.rounded-lg.border.h-tasks-list.overflow-hidden\n      [:div.col-span-2\n       [tasks-list/tasks-list (:results tasks)]]\n      [:div.col-span-6.p-regular.overflow-auto\n       (item-detail/item-detail)]]]))\n\n(defmethod tab-view :Reviews []\n  (let [reviews @(rf/subscribe [::subs/reviews])]\n    [:div\n     [:div.grid.grid-cols-8.rounded-lg.border.h-tasks-list.overflow-hidden\n      [:div.col-span-2\n       [reviews-list/reviews-list (:list reviews)]]\n      [:div.col-span-6.p-regular.overflow-auto\n       (review-detail/review-detail)]]]))\n\n(defn panel []\n  (let [view (r/atom :Tasks)\n        manage-tab-change (fn [clicked-tab]\n                            (when (= clicked-tab :Reviews) (rf/dispatch [:get-reviews]))\n                            (when (= clicked-tab :Tasks) (rf/dispatch [:get-tasks]))\n                            (reset! view clicked-tab))]\n    (fn []\n      [:div\n       [tabs/tabs {:on-change manage-tab-change\n                   :tabs [:Tasks :Reviews]}]\n       [tab-view @view]])))\n"]}