shadow$provide.module$node_modules$$datagridxl$datagridxl2$datagridxl$datagridxl2_umd=function(global,require,module,exports){!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).DataGridXL=e()}(this,function(){function e$jscomp$22(t){return Array.isArray(t)}function i$jscomp$20(t){return e$jscomp$22(t)&&e$jscomp$22(t[0])}function s$jscomp$8(t){return t instanceof Object&&t.constructor===Object}function n$jscomp$9(t){return e$jscomp$22(t)&&
s$jscomp$8(t[0])}function d$jscomp$2(t){return null!==t&&""!==t&&!isNaN(t)}function y$jscomp$2(t$jscomp$0,e$jscomp$2){void 0===t$jscomp$0&&(t$jscomp$0=null);void 0===e$jscomp$2&&(e$jscomp$2=null);this._dataFormat=i$jscomp$20(t$jscomp$0)?"arrayCollection":"objectCollection";for(var t=t$jscomp$0,e,i=0;i<t.length;i++)e=1+i,this._rows.store.push({id:e,title:void 0,_hide:!1,_pass:!0}),this._rows.indexList.push(e);this._rows.store._lastId=e;t=t$jscomp$0;e=e$jscomp$2;void 0===e&&(e=null);if(null!=e&&n$jscomp$9(e)){var e$jscomp$0=
e,e$jscomp$1=n$jscomp$9(t)?Object.keys(t[0]):null;t=void 0;void 0===e$jscomp$1&&(e$jscomp$1=null);void 0===t&&(t=0);var o=!1;for(e=0;e<e$jscomp$0.length;e++){t+=1;var l=i=void 0;null!=e$jscomp$1&&("source"in e$jscomp$0[e]?e$jscomp$0[e].source in e$jscomp$1&&(i=e$jscomp$0[e].source,l=e$jscomp$0[e].source):(i=e$jscomp$1[e]||void 0,l=e$jscomp$1[e]||void 0));var c=e$jscomp$0[e]._hide||!1;this._cols.store.push({id:t,field:e$jscomp$0[e].field||i,title:e$jscomp$0[e].title||l,width:e$jscomp$0[e].width||this.colWidth,
align:e$jscomp$0[e].align||this.colAlign,_hide:c,level:0,parent_id:void 0,_role:"data"});c||(o=!0)}o||(this._cols.store[this._cols.store.length-1]._hide=!1);e$jscomp$0=[];for(e$jscomp$1=0;e$jscomp$1<this._cols.store.length;e$jscomp$1++)e$jscomp$0.push(this._cols.store[e$jscomp$1].id);this._cols.indexList=e$jscomp$0;this._cols.store._lastId=this._cols.store[this._cols.store.length-1].id}else if(i$jscomp$20(t)){for(e$jscomp$1=0;e$jscomp$1<t[0].length;e$jscomp$1++)e$jscomp$0=1+e$jscomp$1,this._cols.store.push({id:e$jscomp$0,
field:void 0,title:void 0,width:this.colWidth,align:this.colAlign,_hide:!1,level:0,parent_id:void 0,_role:"data"}),this._cols.indexList.push(e$jscomp$0);this._cols.store._lastId=e$jscomp$0}else if(n$jscomp$9(t)){e$jscomp$0=0;for(o in t[0])e$jscomp$1=1+e$jscomp$0,this._cols.store.push({id:e$jscomp$1,field:o,title:o,width:this.colWidth,align:this.colAlign,_hide:!1,level:0,parent_id:void 0,_role:"data"}),this._cols.indexList.push(e$jscomp$1),e$jscomp$0++;this._cols.store._lastId=e$jscomp$1}void 0===
e$jscomp$2&&(e$jscomp$2=null);this._cellStore=[];if(null!=e$jscomp$2&&n$jscomp$9(e$jscomp$2))if(i$jscomp$20(t$jscomp$0))for(e$jscomp$0=0;e$jscomp$0<this._rows.store.length;e$jscomp$0++)for(this._cellStore[this._rows.store[e$jscomp$0].id-1]=[],e$jscomp$1=0;e$jscomp$1<this._cols.store.length;e$jscomp$1++)o="source"in e$jscomp$2[e$jscomp$1]&&d$jscomp$2(e$jscomp$2[e$jscomp$1].source)?Number(e$jscomp$2[e$jscomp$1].source):e$jscomp$1,this._cellStore[this._rows.store[e$jscomp$0].id-1][this._cols.store[e$jscomp$1].id-
1]={value:t$jscomp$0[e$jscomp$0][o],_found:!1};else{if(n$jscomp$9(t$jscomp$0))for(e$jscomp$0=0;e$jscomp$0<this._rows.store.length;e$jscomp$0++)for(this._cellStore[this._rows.store[e$jscomp$0].id-1]=[],e$jscomp$1=0;e$jscomp$1<this._cols.store.length;e$jscomp$1++)o="source"in e$jscomp$2[e$jscomp$1]?e$jscomp$2[e$jscomp$1].source:Object.keys(t$jscomp$0[0])[e$jscomp$1],this._cellStore[this._rows.store[e$jscomp$0].id-1][this._cols.store[e$jscomp$1].id-1]={value:t$jscomp$0[e$jscomp$0][o],_found:!1}}else if(i$jscomp$20(t$jscomp$0))for(e$jscomp$2=
0;e$jscomp$2<this._rows.store.length;e$jscomp$2++)for(this._cellStore[this._rows.store[e$jscomp$2].id-1]=[],e$jscomp$0=0;e$jscomp$0<this._cols.store.length;e$jscomp$0++)this._cellStore[this._rows.store[e$jscomp$2].id-1][this._cols.store[e$jscomp$0].id-1]={value:t$jscomp$0[e$jscomp$2][e$jscomp$0],_found:!1};else if(n$jscomp$9(t$jscomp$0))for(e$jscomp$2=0;e$jscomp$2<this._rows.store.length;e$jscomp$2++)for(this._cellStore[this._rows.store[e$jscomp$2].id-1]=[],e$jscomp$0=0;e$jscomp$0<this._cols.store.length;e$jscomp$0++)this._cellStore[this._rows.store[e$jscomp$2].id-
1][this._cols.store[e$jscomp$0].id-1]={value:t$jscomp$0[e$jscomp$2][this._cols.store[e$jscomp$0].field],_found:!1}}function x$jscomp$1(){for(var t=[],e=0,i=[],o=-1,s=[],n=!1,r=[[],[],[]],l=[[],[],[]],h=null!=this._freezeLineColAfterId?0:1,a=0;a<this._cols.indexList.length;a++)this._cols.store[this._cols.indexList[a]-1]._hide?(n?i[o].push(this._cols.indexList[a]):(i[++o]=[this._cols.indexList[a]],0<e&&(s[e-1][1]=o)),n=!0):(t.push(this._cols.indexList[a]),r[h].push(this._cols.indexList[a]),n?s.push([o,
null]):s.push([null,null]),e++,n=!1),l[h].push(this._cols.indexList[a]),this._cols.indexList[a]==this._freezeLineColAfterId&&(h=1);this._cols.hiddenGroups=i;this._cols.iconList=s;this._cols.coordList=t;this._cols.coordSections=r;this._cols.indexSections=l}function w$jscomp$0(){for(var t=[],e=0,i=[],o=-1,s=[],n=!1,r=[[],[],[]],l=[[],[],[]],h=null!=this._freezeLineRowAfterId?0:1,a=0;a<this._rows.indexList.length;a++){var c=this._rows.store[this._rows.indexList[a]-1];c._hide?(n?i[o].push(this._rows.indexList[a]):
(i[++o]=[this._rows.indexList[a]],0<e&&(s[e-1][1]=o)),n=!0):c._pass&&(t.push(this._rows.indexList[a]),r[h].push(this._rows.indexList[a]),n?s.push([o,null]):s.push([null,null]),e++,n=!1);l[h].push(this._rows.indexList[a]);this._rows.indexList[a]==this._freezeLineRowAfterId&&(h=1)}this._rows.hiddenGroups=i;this._rows.iconList=s;this._rows.coordList=t;this._rows.coordSections=r;this._rows.indexSections=l}function C$jscomp$0(t){for(var e=[],i=0;i<t.length;i++)"string"==typeof t[i]?!(t[i]in this._presetParts)||
"include"in this._presetParts[t[i]]&&!this._presetParts[t[i]].include.call(this)||e.push(this._presetParts[t[i]]):e.push(t[i]);return e}function b$jscomp$0(t){for(var e in t)e in this&&(this[e]=t[e]);if("data"in t&&e$jscomp$22(t.data))y$jscomp$2.call(this,t.data,t.columns||null);else if("columns"in t&&e$jscomp$22(t.columns)){e=t.columns;for(var e$jscomp$0=[],i=0;3>i;i++){e$jscomp$0.push([]);for(var o=0;o<e.length;o++)e$jscomp$0[i].push(null)}y$jscomp$2.call(this,e$jscomp$0,t.columns)}else y$jscomp$2.call(this,
this.constructor.createEmptyData(3,3));t=this.frozenCols;e=this.frozenRows;this.frozenCols>=this._cols.indexList.length&&(t=0);this.frozenRows>=this._rows.indexList.length&&(e=0);this._freezeLineColAfterId=this._cols.indexList[t-1]||null;this._freezeLineRowAfterId=this._rows.indexList[e-1]||null;x$jscomp$1.call(this);w$jscomp$0.call(this);this._validatedTopBar=C$jscomp$0.call(this,this.topBar);this._validatedBottomBar=C$jscomp$0.call(this,this.bottomBar)}function L$jscomp$0(t,e){void 0===t&&(t={});
void 0===e&&(e={});var i={};if(null!=t&&Object.keys(t).length)for(var o in t)i[o]=t[o];if(null!=e&&Object.keys(e).length)for(o in e)i[o]=e[o];return i}function P$jscomp$0(t,e,i){void 0===t&&(t=null);void 0===e&&(e={});void 0===i&&(i=!1);i&&(e=L$jscomp$0({margin:0,padding:0,"font-weight":"normal","font-size":"100%","font-family":"inherit","vertical-align":"baseline","list-style":"none","box-sizing":"border-box","text-align":"left"},e));i=["user-select","user-drag","touch-callout"];var o=["-ktml","-moz-",
"-ms-","-webkit-","-o-"],s;for(s in e){if(-1<i.indexOf(s))for(var n=0;n<o.length;n++)o[n]+s in e||(t.style[o[n]+s]=e[s]);null!==e[s]&&(t.style[s]=e[s])}}function k$jscomp$0(t,i){void 0===i&&(i=!1);var o="",s;for(s in t){if(e$jscomp$22(t[s]))for(var n=0;n<t[s].length;n++)o+=s+": "+t[s][n]+";";else i&&(o+="\t"),o+=s+": "+t[s]+";";i&&(o+="\n")}return o}function H(t,e){void 0===t&&(t="div");void 0===e&&(e={});t=document.createElement(t);for(var o in e)if("name"!=o&&"tag"!=o&&"domNodes"!=o&&"children"!=
o)if("text"==o)t.textContent=e.text;else if("html"==o)t.innerHTML=e.html;else if("style"==o){var s=!0;"_reset"in e&&(s=e._reset);P$jscomp$0(t,e.style,s)}else"noCSS"==o?P$jscomp$0(t,e.noCSS,!1):"styleText"==o?t.style.cssText=k$jscomp$0(e.styleText):o.startsWith("_")?t[o]=e[o]:("string"==typeof e[o]||d$jscomp$2(e[o]))&&t.setAttribute(o,e[o]);return t}function A$jscomp$0(t,e){void 0===t&&(t=null);void 0===e&&(e=[]);for(var i=document.createDocumentFragment(),o=0;o<e.length;o++)null!=e[o]&&i.appendChild(e[o]);
return t.appendChild(i),t}function T$jscomp$0(t,e){return void 0===e&&(e=this._domNodes),F$jscomp$0.call(this,t,e)}function W(t){for(var e=t.parentNode.children,i=0;i<e.length;i++)if(e[i]==t)return i;return-1}function K(t,e){for(;"classList"in t&&!t.classList.contains(e);)t=t.parentNode;return"classList"in t&&t.classList.contains(e)?t:null}function j(t$jscomp$0,e,i){if(void 0===e&&(e="#fff"),void 0===i&&(i="#000"),"rgb"==t$jscomp$0.substring(0,3)){var o=t$jscomp$0.replace(/[^\d,.]/g,"").split(",");
t$jscomp$0=o[0];var n=o[1];o=o[2]}else o="#"===t$jscomp$0.charAt(0)?t$jscomp$0.substring(1,7):t$jscomp$0,t$jscomp$0=parseInt(o.substring(0,2),16),n=parseInt(o.substring(2,4),16),o=parseInt(o.substring(4,6),16);t$jscomp$0=[t$jscomp$0/255,n/255,o/255].map(function(t){return.03928>=t?t/12.92:Math.pow((t+.055)/1.055,2.4)});return.179<.2126*t$jscomp$0[0]+.7152*t$jscomp$0[1]+.0722*t$jscomp$0[2]?i:e}function J(){null===this._container?this._domNodes.container=null:this._container instanceof HTMLElement?
this._domNodes.container=this._container:this._domNodes.container=document.getElementById(this._container);null===this._container?T$jscomp$0.call(this,{name:"container",style:{overflow:"hidden",position:"relative","text-align":"left","touch-action":"auto"}}):this._domNodes.container.innerHTML="";Object.keys(this.constructor._domNodes).length||(A$jscomp$0(document.body,[T$jscomp$0.call(this,{name:"contextMenu theme-"+this.cssTheme,style:{position:"absolute",top:0,left:0,"z-index":99999,"-webkit-touch-callout":"none",
"user-select":"none","font-family":this.fontFamily,"font-size":this.fontSize,display:"none"}},this.constructor._domNodes),T$jscomp$0.call(this,{name:"contextMenuTouch theme-"+this.cssTheme,style:{position:"absolute",top:0,left:0,padding:"0","z-index":99999,"-webkit-touch-callout":"none","user-select":"none","font-family":"sans-serif","font-size":"14px","overflow-x":"auto",visibility:"hidden"}},this.constructor._domNodes),T$jscomp$0.call(this,{name:"scrollbarMeter",style:{position:"absolute",width:"100px",
height:"100px","pointer-events":"none",visibility:"hidden",top:0,left:0,overflow:"scroll"},children:[{name:"scrollbarMeterSurface",style:{width:"200px",height:"200px"}}]},this.constructor._domNodes)]),this.constructor.contextMenu=new U(this.constructor._domNodes.contextMenu));var JSCompiler_temp_const=document.body,JSCompiler_temp_const$jscomp$0=T$jscomp$0.call(this,{name:"textWidthMeter",style:{position:"absolute",top:0,left:0,"pointer-events":"none",visibility:"hidden"},children:[{tag:"canvas",
name:"textWidthMeterCanvas"}]}),JSCompiler_temp_const$jscomp$1={"white-space":"pre",overflow:"hidden",position:"absolute",display:"inline-block","z-index":1E3,top:0,left:0,"line-height":this.rowHeight+"px","font-family":this.fontFamily,"font-size":this.fontSize+"px","pointer-events":"none",visibility:"hidden"};var JSCompiler_inline_result="";for(var e=0;3>e;e++)JSCompiler_inline_result+="abc\n";JSCompiler_inline_result=JSCompiler_inline_result.trim();A$jscomp$0(JSCompiler_temp_const,[JSCompiler_temp_const$jscomp$0,
T$jscomp$0.call(this,{name:"lineHeightMeter",style:JSCompiler_temp_const$jscomp$1,text:JSCompiler_inline_result})]);this._textWidthMeterCanvasContext=this._domNodes.textWidthMeterCanvas.getContext("2d");this._textWidthMeterCanvasContext.font=this.fontSize+"px "+this.fontFamily;this.constructor._isIOS&&(JSCompiler_temp_const=T$jscomp$0.call(this,{tag:"style",html:"\n    .dgxl-ios-fullscreen {\n      width: 100vw !important;\n      height: 100vh !important;\n    }\n  "}),document.head.appendChild(JSCompiler_temp_const))}
function vt(t){for(var e=0,i=t[0];i<=t[1];i++)e+=this.getColWidthById(this.getColIdByCoord(i));return e}function xt(t){for(var e=0,i=t[0];i<=t[1];i++)e+=this.getRowHeightById(this.getRowIdByCoord(i));return e}function Bt(){this._isFullscreen?(window.getComputedStyle(this._domNodes.component),this._cd.componentWidth=this._domNodes.component.clientWidth,this._cd.componentHeight=this._domNodes.component.clientHeight):(this._cd.componentWidth=this._cd.containerWidth,this._cd.componentHeight=this._cd.containerHeight);
this._cd.topBarSpace=this.topBar&&this.topBar.length?48:0;this._cd.bottomBarSpace=this.bottomBar&&this.bottomBar.length?48:0;this._cd.displayWidth=this._cd.componentWidth;this._cd.displayHeight=this._cd.componentHeight-this._cd.topBarSpace-this._cd.bottomBarSpace;this._cd.scrollbarSpace=this.constructor._browserScrollbarSize||10;this._cd.viewportWidth=this._cd.displayWidth-this._cd.scrollbarSpace;this._cd.viewportHeight=this._cd.displayHeight-this._cd.scrollbarSpace;this._cd.colHeaderLevelsSpace=
this._cols.headerLevels.length*this.colHeaderHeight;this._cd.rowHeaderLevelsSpace=this._rows.headerLevels.length*this.rowHeaderWidth;this._cd.colHeaderSpace=this._cd.colHeaderLevelsSpace+this.colHeaderHeight;this._cd.rowHeaderSpace=this._cd.rowHeaderLevelsSpace+this.rowHeaderWidth;var JSCompiler_temp_const=this._cd,t=this._cd.rowHeaderSpace;this._cols.coordSections[0].length&&(t+=vt.call(this,[0,0+this._cols.coordSections[0].length-1]));JSCompiler_temp_const.virtualPanesX={left:t,center:this._cd.viewportWidth-
t};JSCompiler_temp_const=this._cd;t=this._cd.colHeaderSpace;this._rows.coordSections[0].length&&(t+=xt.call(this,[0,0+this._rows.coordSections[0].length-1]));JSCompiler_temp_const.virtualPanesY={top:t,center:this._cd.viewportHeight-t};200<=this._cd.virtualPanesX.center?this._sectionsPerPaneX={left:[0],center:[1]}:this._sectionsPerPaneX={left:[],center:[0,1]};120<=this._cd.virtualPanesY.center?this._sectionsPerPaneY={top:[0],center:[1]}:this._sectionsPerPaneY={top:[],center:[0,1]};this._panesXids=
{left:Nt.call(this,"left"),center:Nt.call(this,"center")};this._panesYids={top:Lt.call(this,"top"),center:Lt.call(this,"center")};JSCompiler_temp_const=this._cd;var t$jscomp$0=this._cd.rowHeaderSpace;for(t=0;t<this._sectionsPerPaneX.left.length;t++){var JSCompiler_inline_result=this._sectionsPerPaneX.left[t];for(var e=0,i=0;i<this._cols.coordSections.length&&!(i>=JSCompiler_inline_result);i++)e+=this._cols.coordSections[i].length;JSCompiler_inline_result=vt.call(this,[e,e+this._cols.coordSections[JSCompiler_inline_result].length-
1]);t$jscomp$0+=JSCompiler_inline_result}t=t$jscomp$0;(t$jscomp$0>this._cd.rowHeaderSpace||this._freezeLineColAfterId&&this._sectionsPerPaneX.left.length&&!this._panesXids.left.length)&&(t+=6);t={space:t$jscomp$0,outer:t};t$jscomp$0=this._cd.viewportWidth-t.outer;t$jscomp$0={space:t$jscomp$0,outer:t$jscomp$0};t=(t.offset=0,t$jscomp$0.offset=t.outer,{left:t,center:t$jscomp$0});JSCompiler_temp_const.panesX=t;JSCompiler_temp_const=this._cd;t$jscomp$0=this._cd.colHeaderSpace;for(t=0;t<this._sectionsPerPaneY.top.length;t++){JSCompiler_inline_result=
this._sectionsPerPaneY.top[t];for(i=e=0;i<this._rows.coordSections.length&&!(i>=JSCompiler_inline_result);i++)e+=this._rows.coordSections[i].length;JSCompiler_inline_result=xt.call(this,[e,e+this._rows.coordSections[JSCompiler_inline_result].length-1]);t$jscomp$0+=JSCompiler_inline_result}t=t$jscomp$0;(t$jscomp$0>this._cd.colHeaderSpace||this._freezeLineRowAfterId&&this._sectionsPerPaneY.top.length&&!this._panesYids.top.length)&&(t+=6);t={space:t$jscomp$0,outer:t};t$jscomp$0=this._cd.viewportHeight-
t.outer;t$jscomp$0={space:t$jscomp$0,outer:t$jscomp$0,inner:t$jscomp$0,innerOffset:0};t=(t.offset=0,t$jscomp$0.offset=t.outer,{top:t,center:t$jscomp$0});JSCompiler_temp_const.panesY=t;JSCompiler_temp_const=this._cd;for(t$jscomp$0=t=0;t$jscomp$0<this._panesXids.center.length;t$jscomp$0++)t+=this.getColWidthById(this._panesXids.center[t$jscomp$0]);JSCompiler_temp_const.innerDocumentWidth=t;JSCompiler_temp_const=this._cd;for(t$jscomp$0=t=0;t$jscomp$0<this._panesYids.center.length;t$jscomp$0++)t+=this.getRowHeightById(this._panesYids.center[t$jscomp$0]);
JSCompiler_temp_const.innerDocumentHeight=t;var t$jscomp$1,e$jscomp$0;JSCompiler_temp_const=this._cd.innerDocumentWidth-this._cd.panesX.center.space;for(t$jscomp$0=t=0;t$jscomp$0<this._panesXids.center.length&&(t$jscomp$1=t$jscomp$0,e$jscomp$0=t,!(t>=JSCompiler_temp_const));t$jscomp$0++)t+=this.getColWidthById(this._panesXids.center[t$jscomp$0]);this._lastColView={startIndex:this._panesXids.left.length+t$jscomp$1,blankSpace:e$jscomp$0+this._cd.panesX.center.space-this._cd.innerDocumentWidth};var t$jscomp$2,
e$jscomp$1;t$jscomp$1=this._cd.innerDocumentHeight-this._cd.panesY.center.space;for(JSCompiler_temp_const=e$jscomp$0=0;JSCompiler_temp_const<this._panesYids.center.length&&(t$jscomp$2=JSCompiler_temp_const,e$jscomp$1=e$jscomp$0,!(e$jscomp$0>=t$jscomp$1));JSCompiler_temp_const++)e$jscomp$0+=this.getRowHeightById(this._panesYids.center[JSCompiler_temp_const]);this._lastRowView={startIndex:this._panesYids.top.length+t$jscomp$2,blankSpace:e$jscomp$1+this._cd.panesY.center.space-this._cd.innerDocumentHeight};
this._cd.scrollAreaWidth=this._cd.displayWidth;this._cd.scrollAreaHeight=this._cd.displayHeight;t$jscomp$2=this._lastColView.startIndex-this._panesXids.left.length;this._cd.scrollWidth=0==t$jscomp$2?1:this._cd.scrollAreaWidth+40*t$jscomp$2;t$jscomp$2=this._lastRowView.startIndex-this._panesYids.top.length;this._cd.scrollHeight=0==t$jscomp$2?1:this._cd.scrollAreaHeight+40*t$jscomp$2;this._cd.scrollableDocumentWidth=Math.max(this._cd.viewportWidth,this._cd.innerDocumentWidth+this._lastColView.blankSpace);
this._cd.scrollableDocumentHeight=this._cd.innerDocumentHeight+this._lastRowView.blankSpace}function Ot(){for(var t=this._viewportPosition.x-this._panesXids.left.length,e=[],i=0,o=this._cd.panesX.center.space;i<o&&!(t>this._panesXids.center.length-1);)e.push(this._panesXids.center[t]),i+=this.getColWidthById(this._panesXids.center[t]),t++;this._colViewOverflow=i-this._cd.panesX.center.space;this._colView=e}function Dt(){for(var t=this._viewportPosition.y-this._panesYids.top.length,e=[],i=0,o=this._cd.panesY.center.space;i<
o&&!(t>this._panesYids.center.length-1);)e.push(this._panesYids.center[t]),i+=this.getRowHeightById(this._panesYids.center[t]),t++;this._rowViewOverflow=i-this._cd.panesY.center.space;this._rowView=e}function Vt(t,e){void 0===t&&(t=!1);void 0===e&&(e=!1);null==this._viewportPosition&&(this._viewportPosition={x:this._panesXids.left.length,y:this._panesYids.top.length});this._viewportPosition={x:t?this._panesXids.left.length:this._viewportPosition.x,y:e?this._panesYids.top.length:this._viewportPosition.y};
this._viewportPosition={x:Math.max(this._panesXids.left.length,this._viewportPosition.x),y:Math.max(this._panesYids.top.length,this._viewportPosition.y)};Ot.call(this);Dt.call(this)}function Xt(){if(null==this.constructor_browserScrollbarSize){var t=this.constructor._domNodes.scrollbarMeter;this.constructor._browserScrollbarSize=t.offsetWidth-t.clientWidth}if(!this._isFullscreen){t=!1;var e=window.getComputedStyle(this._domNodes.container);this._cd.containerWidth=this._domNodes.container.clientWidth-
(parseFloat(e.paddingLeft)+parseFloat(e.paddingRight));this._cd.containerHeight=this._domNodes.container.clientHeight-(parseFloat(e.paddingTop)+parseFloat(e.paddingBottom));0==this._containerHeight&&(this._domNodes.container.style.height="300px",t=!0);0==this._containerWidth&&(this._domNodes.container.style.width="100%");"static"==e.position&&(this._domNodes.container.style.position="relative");"inline"==e.display&&(this._domNodes.container.style.display="inline-block",t=!0);"hidden"!=e.overflow&&
(this._domNodes.container.style.overflow="hidden");t&&(e=window.getComputedStyle(this._domNodes.container),this._cd.containerWidth=this._domNodes.container.clientWidth-(parseFloat(e.paddingLeft)+parseFloat(e.paddingRight)),this._cd.containerHeight=this._domNodes.container.clientHeight-(parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)))}t=this._domNodes.lineHeightMeter.getBoundingClientRect();this._actualRowHeight=Math.round(t.height/3*100)/100;Bt.call(this);Vt.call(this)}function Wt(t,e,i){var o;
return function(){var s=this,n=arguments,l=i&&!o;clearTimeout(o);o=setTimeout(function(){o=null;i||t.apply(s,n)},e);l&&t.apply(s,n)}}function Zt(){var t=this._cd.panesY.top.space-this._cd.colHeaderSpace;return{name:"backgrounds",style:{width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px",position:"absolute",top:0,left:0,overflow:"hidden"},children:[{name:"background.top-left",style:{position:"absolute",top:this._cd.panesY.top.offset+this._cd.colHeaderSpace+"px",left:this._cd.panesX.left.offset+
this._cd.rowHeaderSpace+"px",width:this._cd.panesX.left.space-this._cd.rowHeaderSpace+"px",height:t+"px",overflow:"hidden"},children:[$t.call(this,"top","left")]},{name:"background.top-center",style:{position:"absolute",width:this._cd.panesX.center.space+"px",height:t+"px",top:this._cd.panesY.top.offset+this._cd.colHeaderSpace+"px",left:this._cd.panesX.center.offset+"px",overflow:"hidden"},children:[$t.call(this,"top","center")]},{name:"background.center-left",style:{position:"absolute",width:this._cd.panesX.left.space-
this._cd.rowHeaderSpace+"px",height:this._cd.panesY.center.space+"px",top:this._cd.panesY.center.offset+"px",left:this._cd.panesX.left.offset+this._cd.rowHeaderSpace+"px",overflow:"hidden"},children:[$t.call(this,"center","left")]},{name:"background.center-center",style:{position:"absolute",width:this._cd.panesX.center.space+"px",height:this._cd.panesY.center.space+"px",top:this._cd.panesY.center.offset+"px",left:this._cd.panesX.center.offset+"px",overflow:"hidden"},children:[$t.call(this,"center",
"center")]}]}}function te(t){var e=t.cloneNode(!0);return"_opacity"in t&&(e._opacity=t._opacity),"_borderStyle"in t&&(e._borderStyle=t._borderStyle),e}function Oe(){var t=j(this.getThemeSetting("sheet"),"rgba(255,255,255,.35)","rgba(0,0,0,.35)");t={tag:"textarea",name:"cellEditorInputField",style:{"box-sizing":"border-box",background:this.getThemeSetting("sheet"),color:this.getThemeSetting("sheet|text"),"font-family":this.fontFamily,"font-size":this.fontSize+"px","border-width":"2px","border-style":"solid",
"border-color":this.getThemeSetting("celleditor"),"box-shadow":"1px 1px 2px "+t,height:"auto","min-height":"auto",resize:"none",overflow:"auto",outline:"none","overflow-y":"hidden","padding-left":"4px","padding-right":"4px","border-radius":0,"line-height":this.rowHeight-4+"px","-webkit-touch-callout":"none","user-drag":"none","user-select":"text"},tabIndex:-1,autoComplete:"off",wrap:"hard",value:"",spellcheck:!1,autocomplete:"off",_actualCommand:void 0,_isOpen:!1,_coords:null,_mode:null};return this.constructor._isTouchDevice&&
(t.readonly=!0),{name:"cellEditor",style:{position:"absolute",top:0,left:0,"user-select":"none",height:"1px",opacity:0,"z-index":-1},children:[t]}}function We(t,e){if(null==t)return[];for(var i=[],o=0;o<t.length;o++){var s=!0,n;for(n in e)if(!(n in t[o])||t[o][n]!=e[n]){s=!1;break}s&&i.push(t[o])}return i}function Ke(t){var e={},i;for(i in this.headerLabelSeries)e[i]=this.headerLabelSeries[i].indexToLabel(t,this.headerLabelSeries[i]);return e}function je(t){return null==t?"":String(t).replace(/\n/g,
"↵").replace(/\t/g," ")}function qe(t){for(var e,i,o="",s=We(this._selection,{type:"row"}),n=!1,r=0;r<t.length;r++){i=t[r];e=this.getRowCoordById(i);for(var l=0;l<s.length;l++)if(!n&&e>=s[l].range[0].y&&e<=s[l].range[1].y){o+='\x3cspan style\x3d"color:'+this.getThemeSetting("header:selected|text")+';"\x3e';n=!0;break}l=this.getRowIndexById(i);var i$jscomp$0=this.getRowCoordById(i),o$jscomp$0=Ke.call(this,l);i=je(this.rowHeaderLabelFunction.call(this,l,i$jscomp$0,this._rows.store[i-1],o$jscomp$0));
o+=i+"\n";for(l=0;l<s.length;l++)if(n&&e<=s[l].range[1].y){o+="\x3c/span\x3e";n=!1;break}}return n&&(o+="\x3c/span\x3e"),o}function Je(t){var e=this.getColIndexById(t),i=this.getColCoordById(t),o=Ke.call(this,e);return je(this.colHeaderLabelFunction.call(this,e,i,this._cols.store[t-1],o))}function ti(t){for(var e="",i=0;i<this._panesYids.top.length;i++)e+=je(this._cellStore[this._panesYids.top[i]-1][t-1].value)+"\n";return e}function ei(t){for(var e="",i=0;i<this._rowView.length;i++)e+=je(this._cellStore[this._rowView[i]-
1][t-1].value)+"\n";return e}function ii(t,e){t=e-1;this._columnNodes[t]={};var o=this._cols.store[t],JSCompiler_temp_const={position:"absolute",width:o.width+"px",height:this._cd.viewportHeight+"px","line-height":this.rowHeight+"px",overflow:"hidden",contain:"layout style","font-size":this.fontSize+"px","font-family":this.fontFamily,color:this.getThemeSetting("sheet|text")};var JSCompiler_inline_result={name:"columnHeader",style:{position:"absolute",top:0,left:0,right:0,height:this._cd.colHeaderSpace+
"px","line-height":this._cd.colHeaderSpace+"px"},children:[{name:"columnHeaderLabel",style:{position:"absolute",top:0,height:this._colHeaderSpace+"px","line-height":this._colHeaderSpace+"px",left:"6px",right:"6px",color:this.getThemeSetting("header|text"),"white-space":"pre","text-align":this.colHeaderLabelAlign},html:Je.call(this,e)},{name:"columnHeaderSortIndicator",style:{position:"absolute",top:0,height:this._cd.colHeaderSpace+"px",width:"12px",right:"2px",color:this.getThemeSetting("header|text")}}]};
var i=this._cols.store[e-1],o$jscomp$0={height:this._cd.panesY.top.outer-this._cd.colHeaderSpace+"px","padding-left":"6px","padding-right":"6px",overflow:"hidden"},s={height:this._cd.panesY.center.space+"px","padding-left":"6px","padding-right":"6px",clear:"both"};e=("center"==i.align?(o$jscomp$0["margin-left"]="-100%",o$jscomp$0["margin-right"]="-100%",o$jscomp$0["text-align"]="center",s["margin-left"]="-100%",s["margin-right"]="-100%",s["text-align"]="center"):"right"==i.align&&(o$jscomp$0.float=
"right",o$jscomp$0["text-align"]="right",s.float="right",s["text-align"]="right"),{name:"innerColumn",style:{position:"relative","margin-top":this._cd.colHeaderSpace+"px",color:this.getThemeSetting("sheet|text"),"white-space":"pre","line-height":this.rowHeight+"px"},children:[{name:"column-top",style:o$jscomp$0,text:ti.call(this,e)},{name:"column-center",style:s,text:ei.call(this,e)}]});T$jscomp$0.call(this,{name:"column",style:JSCompiler_temp_const,children:[JSCompiler_inline_result,e]},this._columnNodes[t])._colId=
o.id}function ni(){for(var t=0;t<this._cols.store.length;t++)ii.call(this,t,this._cols.store[t].id)}function ui(){var t='\n  \x3csvg height\x3d"8" width\x3d"8" style\x3d"position:absolute;top:3px;left:4px;fill:'+this.getThemeSetting("header-icon")+';"\x3e\n    \x3cpolygon points\x3d"6,4 0,0 0,8" class\x3d"triangle"\x3e\n  \x3c/svg\x3e\n  ';return{name:"hiddenColGroupIconPrev",style:{position:"absolute",top:this.colHeaderHeight/2-8+"px",left:0,height:"16px",width:"14px","border-radius":"0 2px 2px 0",
"border-width":"1px","border-style":"solid","border-left-style":"none","border-color":"transparent","box-sizing":"border-box","font-size":10,"text-align":"center"},html:t}}function pi(){var t='\n  \x3csvg height\x3d"8" width\x3d"8" style\x3d"position:absolute;top:3px;right:4px;fill:'+this.getThemeSetting("header-icon")+';"\x3e\n    \x3cpolygon points\x3d"2,4 8,0 8,8" class\x3d"triangle"\x3e\n  \x3c/svg\x3e\n  ';return{name:"hiddenColGroupIconNext",style:{position:"absolute",top:this.colHeaderHeight/
2-8+"px",left:0,height:"16px",width:"14px","border-radius":"2px 0 0 2px","border-width":"1px","border-style":"solid","border-right-style":"none","border-color":"transparent","box-sizing":"border-box","font-size":10,"text-align":"center"},html:t}}function mi(t,e){if(t in this._listeners&&e in this._listeners[t]){var i="document"==t||"window"==t?window[t]:this._domNodes[t],o=e.split("_");1==o.length?i.addEventListener(e,this._listeners[t][e]):"debounced"==o[1]?i.addEventListener(o[0],this._listeners[t][e]):
"passive"==o[1]&&i.addEventListener(o[0],this._listeners[t][e],{passive:!0})}}function xi(t,e){t in this._listeners&&e in this._listeners[t]&&("document"==t||"window"==t?window[t]:this._domNodes[t]).removeEventListener(e,this._listeners[t][e])}function wi(t){var e=this;void 0===t&&(t=!1);this.constructor._isIOS||(this.activeSheetDisplay&&(this._domNodes.cellEditor.style.top=this.getRowPositionInViewport(this._cellCursorPosition.y)+"px",this._domNodes.cellEditor.style.left=this.getColPositionInViewport(this._cellCursorPosition.x)+
"px"),t?Ci.call(this,this._domNodes.cellEditorInputField):setTimeout(function(){Ci.call(e,e._domNodes.cellEditorInputField)},0))}function bi(){"webkitCurrentFullScreenElement"in document?document.webkitCurrentFullScreenElement==this._domNodes.component?Ii.call(this):Ri.call(this):document.fullscreenElement==this._domNodes.component?Ii.call(this):Ri.call(this);this.constructor._isTouchDevice||wi.call(this)}function Ni(t){var e=this;setTimeout(function(){bi.call(e,t)},100)}function ki(t){var e=this;
setTimeout(function(){bi.call(e,t)},0)}function Hi(t){if(this.hijackNativeSearchCommand&&70==t.keyCode&&t[this._commandKey]){var e=We(this._topBarNodes,{type:"searchBar"}),i=We(this._bottomBarNodes,{type:"searchBar"});e=e.concat(i);e.length&&(t.preventDefault(),this.search(""),e[0].nodes.inputField.focus(),e[0].nodes.inputField.select())}}function Ti(t){if(!(this._domNodes.container.contains(t.target)||this.constructor._domNodes.contextMenu.contains(t.target)||this.constructor._domNodes.contextMenuTouch.contains(t.target))){for(var e=
document.getElementsByClassName("dgxl-app"),i=0;i<e.length;i++)if(e[i].contains(t.target))return;this.deactivate()}}function Fi(t){this.resize()}function Ei(t){}function Mi(t){this._isFullscreen||this.resize()}function Bi(t){"INPUT"!=t.target.tagName&&"TEXTAREA"!=t.target.tagName&&"A"!=t.target.tagName&&"IMG"!=t.target.tagName&&t.preventDefault()}function Oi(t,e){"clipboardData"in t?t.clipboardData.setData("text/plain",e):setTimeout(function(){window.clipboardData.setData("text",e)},100)}function Di(t){return null!=
t&&t[0].x==t[1].x&&t[0].y==t[1].y}function Vi(t){if(null==t)t=null;else{var JSCompiler_inline_result,s=!1,n=!1,r=0,l=this._cd.rowHeaderSpace,h=0,a=[];for(JSCompiler_inline_result=0;JSCompiler_inline_result<this._panesXids.left.length;JSCompiler_inline_result++){var i=JSCompiler_inline_result;var o=this.getColWidthById(this._panesXids.left[i]);i>=t[0].x&&i<=t[1].x&&(a.push({colIndex:i,visibleColIndex:r,visibleColOffset:l}),h+=o);l+=o;r++}(this._panesXids.left.length||this._freezeLineColAfterId&&this._sectionsPerPaneX.left.length&&
!this._panesXids.left.length)&&(l+=6);for(JSCompiler_inline_result=0;JSCompiler_inline_result<this._colView.length;JSCompiler_inline_result++)i=this._viewportPosition.x+JSCompiler_inline_result,o=this.getColWidthById(this._colView[JSCompiler_inline_result]),JSCompiler_inline_result==this._colView.length-1&&(o-=Math.max(this._colViewOverflow,0)),i>=t[0].x&&i<=t[1].x&&(a.push({colIndex:i,visibleColIndex:r,visibleColOffset:l}),h+=o),l+=o,r++;i=a.length?a[0].visibleColOffset:0;o=t[0].x<this._panesXids.left.length;
JSCompiler_inline_result=t[0].x>=this._viewportPosition.x&&t[0].x<=this._viewportPosition.x+this._colView.length-1;(o||JSCompiler_inline_result)&&(s=!0);JSCompiler_inline_result=t[1].x>=this._viewportPosition.x&&t[1].x<this._viewportPosition.x+this._colView.length-1||t[1].x==this._viewportPosition.x+this._colView.length-1&&0>=this._colViewOverflow;r=t[1].x>=this._viewportPosition.x;JSCompiler_inline_result=((t[1].x<this._panesXids.left.length||JSCompiler_inline_result)&&(n=!0),o&&r&&(h+=6),h&&(h+=
1),{offset:i,size:h,lineLeft:s,lineRight:n});n=s=!1;l=0;a=this._cd.colHeaderSpace;h=0;var a$jscomp$0=[];for(i=0;i<this._panesYids.top.length;i++)o=i,r=this.getRowHeightById(this._panesYids.top[o]),o>=t[0].y&&o<=t[1].y&&(a$jscomp$0.push({rowIndex:o,visibleRowIndex:l,visibleRowOffset:a}),h+=r),a+=r,l++;(this._panesYids.top.length||this._freezeLineRowAfterId&&this._sectionsPerPaneY.top.length&&!this._panesYids.top.length)&&(a+=6);for(i=0;i<this._rowView.length;i++)o=this._viewportPosition.y+i,r=this.getRowHeightById(this._rowView[i]),
i==this._rowView.length-1&&(r-=Math.max(this._rowViewOverflow,0)),o>=t[0].y&&o<=t[1].y&&(a$jscomp$0.push({rowIndex:o,visibleRowIndex:l,visibleRowOffset:a}),h+=r),a+=r,l++;i=a$jscomp$0.length?a$jscomp$0[0].visibleRowOffset:0;o=t[0].y<this._panesYids.top.length;r=t[0].y>=this._viewportPosition.y&&t[0].y<=this._viewportPosition.y+this._rowView.length-1;(o||r)&&(s=!0);l=t[1].y>=this._viewportPosition.y&&t[1].y<this._viewportPosition.y+this._rowView.length-1||t[1].y==this._viewportPosition.y+this._rowView.length-
1&&0>=this._rowViewOverflow;r=t[1].y>=this._viewportPosition.y;t=((t[1].y<this._panesYids.top.length||l)&&(n=!0),o&&r&&(h+=6),h&&(h+=1),{offset:i,size:h,lineTop:s,lineBottom:n});t={x:JSCompiler_inline_result,y:t}}return t}function Wi(t,e){var i=t._borderStyle||"solid";if(null!=e){t.style.opacity=t._opacity;var o=Vi.call(this,e),s=i,n=i,r=i;o.y.lineTop&&0!=o.x.size||(s="none");o.y.lineBottom&&0!=o.x.size||(n="none");o.x.lineLeft&&0!=o.y.size||(r="none");o.x.lineRight&&0!=o.y.size||(i="none");"_actionProperties"in
e&&"dragDirection"in e._actionProperties&&("up"==e._actionProperties.dragDirection?n="none":"right"==e._actionProperties.dragDirection?r="none":"down"==e._actionProperties.dragDirection?s="none":"left"==e._actionProperties.dragDirection&&(i="none"));t.style["border-top-style"]=s;t.style["border-right-style"]=i;t.style["border-bottom-style"]=n;t.style["border-left-style"]=r;o.x.size+=2*t._extra;o.y.size+=2*t._extra;o.x.offset-=t._extra;o.y.offset-=t._extra;t.style.transform="translate("+o.x.offset+
"px,"+o.y.offset+"px)";t.style.width=o.x.size+"px";t.style.height=o.y.size+"px"}else t.style.opacity=0}function Ki(t,e,i){var o=this;void 0===i&&(i={});"cut"==t?(this._cutRange=e,this._copyRange=null):"copy"==t?(this._copyRange=e,this._cutRange=null):"fill"==t&&(this._fillRange=e,null!=this._fillRange&&(this._fillRange._actionProperties=i));requestAnimationFrame(function(){Wi.call(o,o._domNodes.copyRange,o._copyRange);Wi.call(o,o._domNodes.cutRange,o._cutRange);Wi.call(o,o._domNodes.fillRange,o._fillRange)})}
function Ui(t,e){void 0===t&&(t={});void 0===e&&(e=null);var i=this._selection[this._activeRangeIndex].range;if(t={text:this.getCellRangeText(i),cellRange:i},this.events.dispatch("beforecut",t))(null!=this.constructor._clipboardObject&&Ki.call(this,this.constructor._clipboardObject.type,null),this.instantCut)?this.clearCellValues(t.cellRange):(i=(Ki.call(this,"cut",t.cellRange),Di(i)&&"\n"==t.text)?!0:!1,this.constructor._clipboardObject={type:"cut",text:t.text,cellRange:t.cellRange,isSingleEmptyCell:i,
instance:this}),Oi.call(this,e,t.text),this.events.dispatch("cut",t)}function qi(t$jscomp$0){t$jscomp$0.preventDefault();if("cut"==this._domNodes.cellEditor._actualCommand)Ui.call(this,{},t$jscomp$0);else if("copy"==this._domNodes.cellEditor._actualCommand||null==this._domNodes.cellEditor._actualCommand&&this.allowCopy){var t={};void 0===t&&(t={});void 0===t$jscomp$0&&(t$jscomp$0=null);var i=this._selection[this._activeRangeIndex].range;if(t={text:this.getCellRangeText(i),cellRange:i},this.events.dispatch("beforecopy",
t))i=(null!=this.constructor._clipboardObject&&Ki.call(this,this.constructor._clipboardObject.type,null),Ki.call(this,"copy",t.cellRange),Di(i)&&"\n"==t.text)?!0:!1,this.constructor._clipboardObject={type:"copy",text:t.text,cellRange:t.cellRange,isSingleEmptyCell:i,instance:this},Oi.call(this,t$jscomp$0,t.text),this.events.dispatch("copy",t)}this._domNodes.cellEditor._actualCommand=void 0}function Zi(t$jscomp$0,e){if(void 0===t$jscomp$0&&(t$jscomp$0={}),this.events.dispatch("beforepaste",t$jscomp$0)){var i=
t$jscomp$0.text;null!=this.constructor._clipboardObject&&"\n"==t$jscomp$0.text&&this.constructor._clipboardObject.isSingleEmptyCell&&(i="");(i.endsWith("\n")||i.endsWith("\r"))&&(i=i.replace(/(\r\n|\n|\r)+$/g,""));var t=i;e=(void 0===t&&(t=""),""==t?[[null]]:this.textParser.parse(t,{delimiter:"\t"}).data);i=null!=this.constructor._clipboardObject&&this.constructor._clipboardObject.instance==this&&"cut"==this.constructor._clipboardObject.type&&i==this.constructor._clipboardObject.text?!0:!1;this.events.dispatch("paste",
t$jscomp$0);this.setCellValues(this._selection,e,!0,i)}}function $i(t){t.preventDefault();if(this.allowPaste){var e=this.constructor._isIE?window.clipboardData.getData("text"):t.clipboardData.getData("text");Zi.call(this,{text:e},t)}}function Ji(t){t.preventDefault();this.allowCut&&Ui.call(this,{},t)}function to(t){if(t in this.keyActionSets&&t!=this._activeKeyActionSet){if(this._activeKeyActionSet)for(var e=0;e<this.keyActionSets[this._activeKeyActionSet].length;e++){var i=this.keyActionSets[this._activeKeyActionSet][e],
o=this._presetKeyActions[i];-1<this.keyActionSets[t].indexOf(i)||this.keys.off(o.keys,o.action,o.repeat,o.target)}for(e=0;e<this.keyActionSets[t].length;e++)i=this.keyActionSets[t][e],o=this._presetKeyActions[i],null!=this._activeKeyActionSet&&-1<this.keyActionSets[this._activeKeyActionSet].indexOf(i)||"active"in o&&!o.active.call(this)||this.keys.on(o.keys,o.action,o.repeat);this._activeKeyActionSet=t}}function eo(t){"edit"!=this._domNodes.cellEditor._mode&&(this._domNodes.cellEditor._mode="edit",
to.call(this,"inputModeEdit"))}function io(){var t=this.getColWidthById(this._cols.coordList[this._domNodes.cellEditor._coords.x]),e=Math.ceil(this._textWidthMeterCanvasContext.measureText(this._domNodes.cellEditorInputField.value).width)+12;this._domNodes.cellEditorInputField.style.width=Math.max(e,t)+1+"px"}function oo(t){if("contextMenuOpen"!=this._activeKeyActionSet&&this.allowEditCells&&(t.target.selectionEnd!=t.target.selectionStart+1||t.target!=document.activeElement)){if(this._isUndo||this._isRedo)return this._isUndo=
!1,void(this._isRedo=!1);this._domNodes.cellEditor._isOpen||this.openCellEditor("enter");io.call(this);this.events.dispatch("celleditorinput",{value:t.target.value})}}function no(t,e){return null==t&&null==e||null!=t&&null!=e&&(s$jscomp$8(t)&&s$jscomp$8(e)?t.x==e.x&&t.y==e.y:!(!d$jscomp$2(t)||!d$jscomp$2(e))&&t==e)}function uo(t$jscomp$0){this._domNodes.display._hasScrolled||(this._domNodes.display._hasScrolled=!0,this._domNodes.searchCursor.style.transition="");this._scrollLeft=Math.round(t$jscomp$0.currentTarget.scrollLeft);
this._scrollTop=Math.round(t$jscomp$0.currentTarget.scrollTop);if(this._domNodes.display._setViewportPositionOnScroll){var t={x:this._panesXids.left.length+Math.floor(this._scrollLeft/40),y:this._panesYids.top.length+Math.floor(this._scrollTop/40)};t$jscomp$0=void 0;void 0===t$jscomp$0&&(t$jscomp$0={x:0,y:0});t=(t.x<this._panesXids.left.length&&(t.x=this._panesXids.left.length),t.y<this._panesYids.top.length&&(t.y=this._panesYids.top.length),t.x>this._lastColView.startIndex&&(t.x=this._lastColView.startIndex),
t.y>this._lastRowView.startIndex&&(t.y=this._lastRowView.startIndex),t);no(this._viewportPosition,t)||(this._viewportPosition=t,this._viewportOverflowPx=t$jscomp$0,Ot.call(this),Dt.call(this),this._isViewportConnectedTo={top:this._viewportPosition.y==this._panesYids.top.length,left:this._viewportPosition.x==this._panesXids.left.length});this.redraw()}this._currentDragAction&&this._domNodes.display[this._currentDragAction+"MoveFunc"].call(this);this._domNodes.display._setViewportPositionOnScroll=!0}
function go(t){if(null==t)return null;var e={},i;for(i in t)e[i]=t[i];return e}function _o(t,e){var i=this._domNodes.eventArea.getBoundingClientRect();return{x:Math.round(t-i.left),y:Math.round(e-i.top)}}function yo(t){return t.y<=this._cd.scrollAreaHeight-this._cd.scrollbarSpace?null:{name:"horizontalScrollbar"}}function vo(t){return t.x<=this._cd.scrollAreaWidth-this._cd.scrollbarSpace?null:{name:"verticalScrollbar"}}function mo(t,e){void 0===e&&(e=!1);var i,o,s,n=null;if(t<this._cd.rowHeaderSpace)return-1;
t<=this._cd.panesX.left.space?(i=this._cd.rowHeaderSpace,o="left",s=this._panesXids.left):(i=this._cd.panesX.center.offset,o="center",s=this._colView);for(var l=0;i<t&&!(l>s.length-1);)i+=this.getColWidthById(s[l]),l++;(n=l-1,"center"==o&&(n+=this._viewportPosition.x),e)&&(0>n&&(n=0),t-this.getColPositionInViewport(n)>this.getColWidthById(this.getColIdByCoord(n))/2&&n++);return n}function xo(t,e){void 0===e&&(e=!1);var i,o,s,n=null;if(t<this._cd.colHeaderSpace)return-1;t<=this._cd.panesY.top.space?
(i=this._cd.colHeaderSpace,o="top",s=this._panesYids.top):(i=this._cd.panesY.center.offset,o="center",s=this._rowView);for(var l=0;i<t&&!(l>s.length-1);)i+=this.getRowHeightById(s[l]),l++;(n=l-1,"center"==o&&(n+=this._viewportPosition.y),e)&&(0>n&&(n=0),t-this.getRowPositionInViewport(n)>this.getRowHeightById(this.getRowIdByCoord(n))/2&&n++);return n}function wo(t){return{x:mo.call(this,t.x),y:xo.call(this,t.y)}}function Io(t,i){return null!=t&&null!=i&&(s$jscomp$8(t)&&n$jscomp$9(i)?t.x>=i[0].x&&
t.x<=i[1].x&&t.y>=i[0].y&&t.y<=i[1].y:d$jscomp$2(t)&&e$jscomp$22(i)?t>=i[0]&&t<=i[1]:void 0)}function No(t){return"string"!=typeof t?"":t.charAt(0).toUpperCase()+t.slice(1)}function ko(t){var e="allow"+No(t.slice(0,-5));return t.endsWith("touch")&&e.slice(0,-5),this[e]||!0}function Oo(t,e){if(void 0===t&&(t=null),void 0===e&&(e="mouse"),null==t)return null;var i,g,y,v=null;if(i=yo.call(this,t))v=i;else if(i=vo.call(this,t))v=i;else{if(i=this.allowFillCells){i=t;if(null==this._selection||0==this._selection.length)i=
null;else{var _=null;var i$jscomp$0=this._selection[this._selection.length-1].range,o=this.getColPositionInViewport(i$jscomp$0[1].x),s=this.getRowPositionInViewport(i$jscomp$0[1].y),n=this.getColWidthById(this.getColIdByCoord(i$jscomp$0[1].x)),r=this.getRowHeightById(this.getRowIdByCoord(i$jscomp$0[1].y));i=null==o||null==s?null:(i.x>=o+n-4&&i.x<=o+n+4&&i.y>=s+r-4&&i.y<=s+r+4&&(_={name:"fillHandle",coords:{x:i$jscomp$0[1].x,y:i$jscomp$0[1].y}}),_)}i=_=i}if(i)v=_;else{if(_=this.allowFreezeCols){_=
t;if(!ko.call(this,"freezeCols")||this._freezeLineColAfterId&&!this._sectionsPerPaneX.left.length)var l=null;else l=this._cd.panesX.center.offset-6,_.x<l||_.x>l+6?l=null:(_=wo.call(this,_),l=(_.x=this._viewportPosition.x,{name:"freezeLineCol",objectPosition:{x:l,y:0},coords:_}));_=l}if(_)v=l;else{if(l=this.allowFreezeRows){l=t;if(!ko.call(this,"freezeRows")||this._freezeLineRowAfterId&&!this._sectionsPerPaneY.top.length)var u=null;else u=this._cd.panesY.center.offset-6,l.y<u||l.y>u+6?u=null:(l=wo.call(this,
l),u=(l.y=this._viewportPosition.y,{name:"freezeLineRow",objectPosition:{x:0,y:u},coords:l}));l=u}if(l)v=u;else{if(u=this.allowFreezeCols){var n$jscomp$0=t;this._sectionsPerPaneX.left.length?n$jscomp$0=void 0:0>n$jscomp$0.y||n$jscomp$0.y>this._cd.colHeaderSpace?n$jscomp$0=null:(u=this.getColCoordById(this._freezeLineColAfterId)+1,l=this.getColPositionInViewport(u),n$jscomp$0=n$jscomp$0.x>=l&&n$jscomp$0.x<=l+6?{name:"freezeLinePlaceholderCol",coords:{x:u,y:-1},objectPosition:{},object:this._domNodes.freezeLinePlaceholder_col}:
null);u=n$jscomp$0}if(u)v=n$jscomp$0;else{if(n$jscomp$0=this.allowFreezeRows){var s$jscomp$0=t;this._sectionsPerPaneY.top.length?s$jscomp$0=void 0:0>s$jscomp$0.x||s$jscomp$0.x>this._cd.rowHeaderSpace?s$jscomp$0=null:(n$jscomp$0=this.getRowCoordById(this._freezeLineRowAfterId)+1,u=this.getRowPositionInViewport(n$jscomp$0),s$jscomp$0=s$jscomp$0.y>=u&&s$jscomp$0.y<=u+6?{name:"freezeLinePlaceholderRow",coords:{x:-1,y:n$jscomp$0},objectPosition:{},object:this._domNodes.freezeLinePlaceholder_row}:null);
n$jscomp$0=s$jscomp$0}if(n$jscomp$0)v=s$jscomp$0;else if(s$jscomp$0=t.x<=this._cd.rowHeaderSpace&&t.y<=this._cd.colHeaderSpace?{name:"jointHeader",coords:wo.call(this,t)}:null)v=s$jscomp$0;else if(l=t,s$jscomp$0=(this.colHeaderHeight-16)/2,l.y<s$jscomp$0||l.y>this.colHeaderHeight-s$jscomp$0?s$jscomp$0=null:(_=null,s$jscomp$0=wo.call(this,l),n$jscomp$0=this.getColPositionInViewport(s$jscomp$0.x),u=this.getColIdByCoord(s$jscomp$0.x),s$jscomp$0.x>=this._cols.iconList.length?s$jscomp$0=null:(null!==this._cols.iconList[s$jscomp$0.x][0]&&
l.x>=n$jscomp$0&&l.x<=n$jscomp$0+14?(u=s$jscomp$0.x-1,l=this.getColIdByCoord(u),u=0>u?null:{x:this.getColPositionInViewport(u)+this.getColWidthById(l)-14+1,y:0},_={name:"hiddenColGroupIcon",coords:s$jscomp$0,type:"prev",groupIndex:this._cols.iconList[s$jscomp$0.x][0],objectPositionNext:u,objectPositionPrev:{x:n$jscomp$0,y:0}}):null!==this._cols.iconList[s$jscomp$0.x][1]&&l.x>=n$jscomp$0+this.getColWidthById(u)-14+1&&l.x<=n$jscomp$0+this.getColWidthById(u)&&(l=s$jscomp$0.x+1,l=(this.getColIdByCoord(l),
l>this._cols.coordList.length-1?null:{x:this.getColPositionInViewport(l),y:0}),_={name:"hiddenColGroupIcon",coords:s$jscomp$0,type:"next",groupIndex:this._cols.iconList[s$jscomp$0.x][1],objectPositionNext:{x:n$jscomp$0+this.getColWidthById(u)-14+1,y:0},objectPositionPrev:l}),s$jscomp$0=_)),s$jscomp$0)v=s$jscomp$0;else{if(e="touch"!=e&&this.allowResizeCols){var h=t;if(0>h.y||h.y>this._cd.colHeaderSpace)h=null;else{e=wo.call(this,h);s$jscomp$0=null;n$jscomp$0=this._cd.rowHeaderSpace;for(u=0;u<this._panesXids.left.length;u++)if(n$jscomp$0+=
this.getColWidthById(this._panesXids.left[u]),h.x<=n$jscomp$0){h.x>=n$jscomp$0-4&&(e.x=u,s$jscomp$0={name:"colHeaderEdge",coords:e,objectPosition:{x:n$jscomp$0-4,y:0}});break}this._panesXids.left.length&&(n$jscomp$0+=6);for(u=0;u<this._colView.length;u++)if(n$jscomp$0+=this.getColWidthById(this._colView[u]),h.x<=n$jscomp$0){h.x>=n$jscomp$0-4&&(e.x=this._viewportPosition.x+u,s$jscomp$0={name:"colHeaderEdge",coords:e,objectPosition:{x:n$jscomp$0-4,y:0}});break}h=s$jscomp$0}e=h}if(e)v=h;else{if(h=this.allowMoveCols){if(t.y>
this._cd.colHeaderSpace||0>this._colViewOverflow&&t.x>this._cd.viewportWidth-Math.abs(this._colViewOverflow))var c=null;else c=wo.call(this,t),h=this.getColRangesFromCoord(c.x),c=c.x>=this._cols.coordList.length?null:h.length?{name:"selectedColHeader",coords:c,ranges:h}:null;h=c}if(h)v=c;else if(c=t.y>this._cd.colHeaderSpace?null:{name:"colHeader",coords:wo.call(this,t)})v=c;else if(s$jscomp$0=t,2>s$jscomp$0.x||18<s$jscomp$0.x?c=null:(n$jscomp$0=null,c=wo.call(this,s$jscomp$0),h=this.getRowPositionInViewport(c.y),
e=this.getRowIdByCoord(c.y),c.y>=this._rows.iconList.length?c=null:(null!==this._rows.iconList[c.y][0]&&s$jscomp$0.y>=h&&s$jscomp$0.y<=h+16?(e=c.y-1,s$jscomp$0=this.getRowIdByCoord(e),e=0>e?null:{x:0,y:this.getRowPositionInViewport(e)+this.getRowHeightById(s$jscomp$0)-16+1},n$jscomp$0={name:"hiddenRowGroupIcon",coords:c,type:"prev",groupIndex:this._rows.iconList[c.y][0],objectPositionNext:e,objectPositionPrev:{x:0,y:h}}):null!=this._rows.iconList[c.y][1]&&s$jscomp$0.y>=h+this.getRowHeightById(e)-
16+1&&s$jscomp$0.y<=h+this.getRowHeightById(e)&&(s$jscomp$0=c.y+1,s$jscomp$0=(this.getRowIdByCoord(s$jscomp$0),s$jscomp$0>this._rows.coordList.length-1?null:{x:0,y:this.getRowPositionInViewport(s$jscomp$0)}),n$jscomp$0={name:"hiddenRowGroupIcon",coords:c,type:"next",groupIndex:this._rows.iconList[c.y][1],objectPositionNext:{x:0,y:h+this.getRowHeightById(e)-16+1},objectPositionPrev:s$jscomp$0}),c=n$jscomp$0)),c)v=c;else{if(c=this.allowMoveRows){if(t.x>this._cd.rowHeaderSpace||0>this._rowViewOverflow&&
t.y>this._cd.viewportHeight-Math.abs(this._rowViewOverflow))var f=null;else f=wo.call(this,t),c=this.getRowRangesFromCoord(f.y),f=c.length?{name:"selectedRowHeader",coords:f,ranges:c}:null;c=f}c?v=f:(g=t.x>this._cd.rowHeaderSpace?null:{name:"rowHeader",coords:wo.call(this,t)})?v=g:(y=t.x<this._cd.rowHeaderSpace||t.y<this._cd.colHeaderSpace?null:{name:"cell",coords:wo.call(this,t)})&&(v=y)}}}}}}}}return null!=v&&("coords"in v&&(v.colSection=this.getColSectionFromCellCoords(v.coords),v.rowSection=this.getRowSectionFromCellCoords(v.coords),
v.paneX=this.getPanePositionXfromCellCoords(v.coords),v.paneY=this.getPanePositionYfromCellCoords(v.coords)),v.pointerPositionPx=t),v}function Yo(t){return[t[0].y,t[1].y]}function Wo(t){this._domNodes.ghostForMoveRows.style.transform="translateY("+t+"px)"}function Ko(t){P$jscomp$0(this._domNodes.ghostForMoveRows,{height:xt.call(this,t)+"px",opacity:this._domNodes.ghostForMoveRows._opacity});Wo.call(this,this.getRowPositionInViewport(t[0]))}function jo(){this._domNodes.ghostForMoveRows.style.opacity=
0}function Uo(t){if(t<this._rows.coordList.length)t=this.getRowPositionInViewport(t);else{var i=this._rows.coordList.length-1;t=this.getRowPositionInViewport.call(this,i);t+=this.getRowHeightById(this._rows.coordList[i])}this._domNodes.guideForMoveRows.style.transform="translateY("+t+"px)"}function qo(t){P$jscomp$0(this._domNodes.guideForMoveRows,{width:this._cd.viewportWidth+"px",opacity:this._domNodes.guideForMoveRows._opacity});Uo.call(this,t[0])}function Go(){this._domNodes.guideForMoveRows.style.opacity=
0}function $o(t,e,i){return Math.min(Math.max(t,e),i)}function Qo(t){this._domNodes.ghostForFreezeRows.style.transform="translateY("+t+"px)"}function Jo(t){P$jscomp$0(this._domNodes.ghostForFreezeRows,{opacity:this._domNodes.ghostForFreezeRows._opacity});Qo.call(this,t)}function ts(){this._domNodes.ghostForFreezeRows.style.opacity=0}function es(t){if(t<this._rows.coordList.length)var e=this.getRowPositionInViewport(t);0!=t&&t!=this._panesYids.top.length||(e-=6);this._domNodes.guideForFreezeRows.style.transform=
"translateY("+e+"px)"}function is(t){P$jscomp$0(this._domNodes.guideForFreezeRows,{width:this._cd.viewportWidth+"px",opacity:this._domNodes.guideForFreezeRows._opacity});es.call(this,t)}function os(){this._domNodes.guideForFreezeRows.style.opacity=0}function rs(t){this._domNodes.ghostForFreezeCols.style.transform="translateX("+t+"px)"}function ls(t){P$jscomp$0(this._domNodes.ghostForFreezeCols,{opacity:this._domNodes.ghostForFreezeCols._opacity});rs.call(this,t)}function hs(){this._domNodes.ghostForFreezeCols.style.opacity=
0}function as(t){if(t<this._cols.coordList.length)var e=this.getColPositionInViewport(t);0!=t&&t!=this._panesXids.left.length||(e-=6);this._domNodes.guideForFreezeCols.style.transform="translateX("+e+"px)"}function cs(t){P$jscomp$0(this._domNodes.guideForFreezeCols,{height:this._cd.viewportHeight+"px",opacity:this._domNodes.guideForFreezeCols._opacity});as.call(this,t)}function ds(){this._domNodes.guideForFreezeCols.style.opacity=0}function ps(t){return[t[0].x,t[1].x]}function fs(t){this._domNodes.guideForResizeCols.style.transform=
"translateX("+t+"px)"}function gs(t){this._domNodes.guideForResizeCols.style.opacity=this._domNodes.guideForResizeCols._opacity;fs.call(this,t)}function _s(){this._domNodes.guideForResizeCols.style.opacity=0}function ys(t,e){if(null==t||null==e)return!1;for(var i=!1,o=0;o<e.length;o++)if(Io(t,e[o])){i=!0;break}return i}function ms(t){this._domNodes.ghostForMoveCols.style.transform="translateX("+t+"px)"}function xs(t){P$jscomp$0(this._domNodes.ghostForMoveCols,{width:vt.call(this,t)+"px",opacity:this._domNodes.ghostForMoveCols._opacity});
ms.call(this,this.getColPositionInViewport(t[0]))}function ws(){this._domNodes.ghostForMoveCols.style.opacity=0}function Cs(t){if(t<this._cols.coordList.length)t=this.getColPositionInViewport(t);else{var i=this._cols.coordList.length-1;t=this.getColPositionInViewport.call(this,i);t+=this.getColWidthById(this._cols.coordList[i])}this._domNodes.guideForMoveCols.style.transform="translateX("+t+"px)"}function bs(t){P$jscomp$0(this._domNodes.guideForMoveCols,{height:this._cd.viewportHeight+"px",opacity:this._domNodes.guideForMoveCols._opacity});
Cs.call(this,t[0])}function Ss(){this._domNodes.guideForMoveCols.style.opacity=0}function Is(t,e,i){if(void 0===e&&(e="document"),void 0===i&&(i=null),null==t)return null;t={x:t.x,y:t.y};if("document"==e)var s=Rs.call(this);else"cellSelection"==e&&(s=null==i?this._selection[this._activeRangeIndex].range:this._selection[i].range,s=null!=s?{top:s[0].y,right:s[1].x,bottom:s[1].y,left:s[0].x}:Rs.call(this,s));e=t.x>s.right;i=t.y>s.bottom;var a=t.x<s.left;return t.y<s.top&&(t.y=s.top),a&&(t.x=s.left),
e&&(t.x=s.right),i&&(t.y=s.bottom),t}function Ps(t){if(null==t)return null;if(e$jscomp$22(t)){if(d$jscomp$2(t[0])){var i=null,o=null,s=1==t.length?t[0]:t[1];return t[0]>s?(i=s,o=t[0]):(i=t[0],o=s),[i,o]}i={x:null,y:null};o={x:null,y:null};return t[0].x<t[1].x?(i.x=t[0].x,o.x=t[1].x):(i.x=t[1].x,o.x=t[0].x),t[0].y<t[1].y?(i.y=t[0].y,o.y=t[1].y):(i.y=t[1].y,o.y=t[0].y),[i,o]}return d$jscomp$2(t)?[t,t]:null}function Ts(){this._domNodes.hintForResizeCols.style.opacity=0}function Fs(){this._domNodes.hintForFreezeCols.style.opacity=
0}function Es(){this._domNodes.hintForFreezeRows.style.opacity=0}function Ms(){for(var t=["next","prev"],e=0;e<t.length;e++)P$jscomp$0(this._domNodes["hintForShowCols"+No(t[e])],{opacity:0})}function Bs(){for(var t=["next","prev"],e=0;e<t.length;e++)P$jscomp$0(this._domNodes["hintForShowRows"+No(t[e])],{opacity:0})}function Os(){var t=this;requestAnimationFrame(function(){Ts.call(t);Fs.call(t);Es.call(t);Ms.call(t);Bs.call(t)});this._hoverArea=null}function Ys(t){void 0===t&&(t="xy");var e=Math.floor(this._edgeOffsetX/
2),i=Math.floor(this._edgeOffsetY/2);-40>this._edgeOffsetX?e=-40:40<this._edgeOffsetX&&(e=40);-40>this._edgeOffsetY?i=-40:40<this._edgeOffsetY&&(i=40);0!=this._edgeOffsetX&&"y"!=t&&(this._domNodes.scrollArea.scrollLeft+=e);0!=this._edgeOffsetY&&"x"!=t&&(this._domNodes.scrollArea.scrollTop+=i);this._domNodes.display._edgeDetectTimeout=setTimeout(this._domNodes.display._edgeDetectFunction,50)}function Ks(t){if(void 0===t&&(t=null),null==t)return this._domNodes.eventArea.style.cursor="",void(this._domNodes.eventArea._mouseCursorState=
null);(t=this.mouseCursorStatesIdle[t])&&(this._domNodes.eventArea.style.cursor=t)}function $s(t){void 0===t&&(t=null);null==t&&(t=this._pointerPositionPx);t=Oo.call(this,t);Ts.call(this);Fs.call(this);Es.call(this);Ms.call(this);Bs.call(this);if(null==t)Ks.call(this,"default");else{if("hiddenRowGroupIcon"==t.name)for(var e,i=["next","prev"],o=0;o<i.length;o++){e=this._domNodes["hintForShowRows"+No(i[o])];var s=t["objectPosition"+No(i[o])];P$jscomp$0(e,null==s?{opacity:0}:{transform:"translateY("+
s.y+"px)",opacity:e._opacity})}else if("hiddenColGroupIcon"==t.name)for(i=["next","prev"],o=0;o<i.length;o++)e=this._domNodes["hintForShowCols"+No(i[o])],s=t["objectPosition"+No(i[o])],P$jscomp$0(e,null==s?{opacity:0}:{transform:"translateX("+s.x+"px)",opacity:e._opacity});"colHeaderEdge"==t.name?P$jscomp$0(this._domNodes.hintForResizeCols,{transform:"translateX("+t.objectPosition.x+"px)",opacity:this._domNodes.hintForResizeCols._opacity}):t.name.startsWith("freezeLineCol")?P$jscomp$0(this._domNodes.hintForFreezeCols,
{transform:"translateX("+t.objectPosition.x+"px)",opacity:this._domNodes.hintForFreezeCols._opacity}):t.name.startsWith("freezeLineRow")&&P$jscomp$0(this._domNodes.hintForFreezeRows,{transform:"translateY("+t.objectPosition.y+"px)",opacity:this._domNodes.hintForFreezeRows._opacity});Ks.call(this,t.name)}}function tn(t$jscomp$0,e){void 0===e&&(e={x:0,y:0});var t=t$jscomp$0=(t$jscomp$0.x<this._panesXids.left.length&&(t$jscomp$0.x=this._panesXids.left.length),t$jscomp$0.y<this._panesYids.top.length&&
(t$jscomp$0.y=this._panesYids.top.length),t$jscomp$0.x>this._lastColView.startIndex&&(t$jscomp$0.x=this._lastColView.startIndex),t$jscomp$0.y>this._lastRowView.startIndex&&(t$jscomp$0.y=this._lastRowView.startIndex),t$jscomp$0);no(this._viewportPosition,t)||(this._viewportPosition=t,this._viewportOverflowPx=e,Ot.call(this),Dt.call(this),this._isViewportConnectedTo={top:this._viewportPosition.y==this._panesYids.top.length,left:this._viewportPosition.x==this._panesXids.left.length});this._domNodes.display._setViewportPositionOnScroll=
!1;e=40*(t$jscomp$0.y-this._panesYids.top.length);this._domNodes.scrollArea.scrollLeft=40*(t$jscomp$0.x-this._panesXids.left.length);this._domNodes.scrollArea.scrollTop=e}function nn(t,e,i){!(t in Hs)||"allow"+No(t)in this&&!this["allow"+No(t)]||(i.panesY=[i.paneY],i.panesX=[i.paneX],window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty(),this._domNodes.display[t+"Properties"]=go(i),this._domNodes.display[t+"Flags"]={hasMoved:!1},t+"MoveFunc"in this._domNodes.display||
rn.call(this,t,e,i),t+"EndFunc"in this._domNodes.display||ln.call(this,t,e,i),xi.call(this,"eventArea","mousemove"),xi.call(this,"eventArea","mouseleave"),Os.call(this),e=t,(void 0===e&&(e=null),null==e)?(this._domNodes.eventArea.style.cursor="",this._domNodes.eventArea._mouseCursorState=null):(e=this.mouseCursorStatesDrag[e])&&(this._domNodes.eventArea.style.cursor=e),this._currentDragAction=t,Hs[t].handler.prepare.call(this,this._domNodes.display[t+"Properties"]),document.addEventListener("mousemove",
this._domNodes.display[t+"MoveFunc"]),document.addEventListener("mouseup",this._domNodes.display[t+"EndFunc"]))}function xn(t){if(this._domNodes.display._touchStartFired)this._domNodes.display._touchStartFired=!1;else{var e=_o.call(this,t.clientX,t.clientY);e=Oo.call(this,e);this._domNodes.display._initialMouseHitArea=go(e);null!=e&&(e.pointer="mouse","jointHeader"==e.name?this.selectAll():"fillHandle"==e.name?3==t.which&&this.getAnyRangesFromCellCoords(e.coords).length||nn.call(this,"fillCells",
t,e):"freezeLinePlaceholderCol"==e.name?3!=t.which&&nn.call(this,"freezeCols",t,e):"freezeLinePlaceholderRow"==e.name?3!=t.which&&nn.call(this,"freezeRows",t,e):"freezeLineRow"==e.name?3!=t.which&&nn.call(this,"freezeRows",t,e):"hiddenRowGroupIcon"==e.name?3!=t.which&&this.showRowsById(this._rows.hiddenGroups[e.groupIndex]):"selectedRowHeader"==e.name?3!=t.which&&nn.call(this,"moveRows",t,e):"rowHeader"==e.name?3==t.which&&this.getRowRangesFromCoord(e.coords.y).length||("mouse"==e.pointer?(t.shiftKey?
this.setRowRangeExtreme(e.coords.y,!0):t[this._commandKey]?this.addRowRangeToSelection([e.coords.y,e.coords.y]):this.setRowSelection(e.coords.y,!0,!1),nn.call(this,"selectRows",t,e)):"touch"==e.pointer&&this.setRowSelection(e.coords.y,!0,!1)):"freezeLineCol"==e.name?3!=t.which&&nn.call(this,"freezeCols",t,e):"hiddenColGroupIcon"==e.name?3!=t.which&&this.showColsById(this._cols.hiddenGroups[e.groupIndex]):"colHeaderEdge"==e.name?3!=t.which&&nn.call(this,"resizeCols",t,e):"selectedColHeader"==e.name?
3!=t.which&&nn.call(this,"moveCols",t,e):"colHeader"==e.name?3==t.which&&this.getColRangesFromCoord(e.coords.x).length||("mouse"==e.pointer?(t.shiftKey?this.setColRangeExtreme(e.coords.x,!0):t[this._commandKey]?this.addColRangeToSelection([e.coords.x,e.coords.x]):this.setColSelection(e.coords.x,!0,!1),nn.call(this,"selectCols",t,e)):"touch"==e.pointer&&this.setColSelection(e.coords.x,!0,!1)):"cell"==e.name&&(3==t.which&&this.getAnyRangesFromCellCoords(e.coords).length||("mouse"==e.pointer?(t.shiftKey?
this.setCellRangeExtreme(e.coords,!0):t[this._commandKey]?this.addCellRangeToSelection([e.coords,e.coords]):this.setCellSelection(e.coords),nn.call(this,"selectCells",t,e)):this.setCellSelection(e.coords))))}}function wn(t){this._pointerPositionPx=_o.call(this,t.clientX,t.clientY);this._pointerPosition=wo.call(this,this._pointerPositionPx);$s.call(this,this._pointerPositionPx)}function Cn(t){Os.call(this)}function bn(t){if(!(t.ctrlKey||t.metaKey||t.shiftKey)){var e=this._domNodes.display._initialMouseHitArea;
e&&(this._pointerPositionPx=_o.call(this,t.clientX,t.clientY),t=Oo.call(this,this._pointerPositionPx),null!=t&&(this.allowResizeCols&&"colHeaderEdge"==t.name&&"colHeaderEdge"==e.name&&no(t.coords.x,e.coords.x)?ys(t.coords.x,this.getColSelection())?this.resizeColsToFit(this.getColSelection()):this.resizeColsToFit(t.coords.x):this.allowEditCells&&"cell"==t.name&&"cell"==e.name&&no(t.coords,e.coords)&&this.openCellEditor("edit"),this._domNodes.display._initialMouseHitArea=void 0))}}function In(t$jscomp$0,
e$jscomp$0){void 0===t$jscomp$0&&(t$jscomp$0={});t$jscomp$0.contextMenu=this.constructor.contextMenu;e$jscomp$0=t$jscomp$0;for(var t=this.contextMenuItems,e=[],i=0;i<t.length;i++)"string"==typeof t[i]?!(t[i]in this._presetContextMenuItems)||"include"in this._presetContextMenuItems[t[i]]&&!this._presetContextMenuItems[t[i]].include.call(this)||e.push(this._presetContextMenuItems[t[i]]):e.push(t[i]);(e$jscomp$0.items=e,t$jscomp$0.items.length)&&this.events.dispatch("beforeopencontextmenu",t$jscomp$0)&&
(this.constructor.contextMenu.open(this,t$jscomp$0.items,t$jscomp$0.snapPointX,t$jscomp$0.snapPointY,this._handlers.contextMenu.selectItem,this._handlers.contextMenu.close),to.call(this,"contextMenuOpen"),this.events.dispatch("opencontextmenu",t$jscomp$0))}function Rn(t){3==t.which&&(this._pointerPositionPx=_o.call(this,t.clientX,t.clientY),null==yo.call(this,this._pointerPositionPx)&&null==vo.call(this,this._pointerPositionPx)&&In.call(this,{snapPointX:t.pageX-(this._isFullscreen?window.scrollX:
0),snapPointY:t.pageY-(this._isFullscreen?window.scrollY:0)},t))}function Ln(t){}function Pn(t){}function Nn(t){}function kn(){var t=this._selection[this._activeRangeIndex].range;1==this._selection.length&&Di.call(this,t)?to.call(this,"traverseSingleCell"):to.call(this,"traverseMultiCell")}function Hn(t,e){void 0===t&&(t={});t.contextMenu.execClose();this._isActive&&kn.call(this);this.events.dispatch("closecontextmenu",t)}function zn(t){void 0===t&&(t={});t.contextMenu.close();t.item.method.call(this);
this.events.dispatch("contextmenuselectitem",t)}function An(){this._handlers={contextMenu:{open:In.bind(this),selectItem:zn.bind(this),close:Hn.bind(this)}};this._listeners={document:{fullscreenchange:Ni.bind(this),webkitfullscreenchange:ki.bind(this),keydown:Hi.bind(this),mousedown:Ti.bind(this)},window:{resize:Fi.bind(this)},container:{resize:Mi.bind(this)},lineHeightMeter:{resize:Ei.bind(this)},component:{contextmenu:Bi.bind(this)},cellEditorInputField:{copy:qi.bind(this),paste:$i.bind(this),cut:Ji.bind(this),
mousedown:eo.bind(this),input:oo.bind(this)},scrollArea:{scroll:uo.bind(this),scroll_debounced:Wt(function(t){this._domNodes.display._hasScrolled=!1;this._domNodes.searchCursor.style.transition="transform 0.05s"},100).bind(this)},eventArea:{mousedown:xn.bind(this),mousemove:wn.bind(this),mouseleave:Cn.bind(this),dblclick:bn.bind(this),contextmenu:Rn.bind(this),touchstart_passive:Ln.bind(this),touchmove_passive:Pn.bind(this),touchend_passive:Nn.bind(this)}}}function Tn(){var t={document:["fullscreenchange",
"webkitfullscreenchange","keydown","mousedown"],component:["contextmenu"],cellEditorInputField:["copy","paste","cut","mousedown","input"],scrollArea:["scroll","scroll_debounced"],eventArea:["mousedown","mousemove","mouseleave","dblclick","contextmenu"]},e;for(e in t)for(var i=0;i<t[e].length;i++)mi.call(this,e,t[e][i]);this._domNodes.container._resizeSensor.events.on("resize",this._listeners.container.resize);this._domNodes.lineHeightMeter._resizeSensor.events.on("resize",this._listeners.lineHeightMeter.resize)}
function Mn(){for(var t in this._domNodes.canvas){var e=t.split("-"),i=e[0];e=e[1];var i$jscomp$0=this._domNodes.canvas[i+"-"+e],o=i$jscomp$0._displayWidth/1,s=i$jscomp$0._displayHeight/this.rowHeight;i$jscomp$0._drawWidth=o;i$jscomp$0._drawHeight=s;i$jscomp$0.width=o;i$jscomp$0.height=s;i=this._domNodes.canvas[i+"-"+e];i._context=i.getContext("2d",{alpha:!1});i._context.msImageSmoothingEnabled=!1;i._context.webkitImageSmoothingEnabled=!1;i._context.imageSmoothingEnabled=!1}}function Dn(){for(var t,
e,i=Array.prototype.slice.call(arguments),o=[0,0,0,0];e=i.shift();)void 0===e[3]&&(e[3]=1),o[3]&&e[3]?((t=[0,0,0,0])[3]=1-(1-e[3])*(1-o[3]),t[0]=Math.round(e[0]*e[3]/t[3]+o[0]*o[3]*(1-e[3])/t[3]),t[1]=Math.round(e[1]*e[3]/t[3]+o[1]*o[3]*(1-e[3])/t[3]),t[2]=Math.round(e[2]*e[3]/t[3]+o[2]*o[3]*(1-e[3])/t[3])):t=e||o,o=t;return t}function Vn(t$jscomp$0){if(""!==t$jscomp$0){if("transparent"===t$jscomp$0.toLowerCase())return[0,0,0,0];if("#"===t$jscomp$0[0])return 7>t$jscomp$0.length&&(t$jscomp$0="#"+t$jscomp$0[1]+
t$jscomp$0[1]+t$jscomp$0[2]+t$jscomp$0[2]+t$jscomp$0[3]+t$jscomp$0[3]+(4<t$jscomp$0.length?t$jscomp$0[4]+t$jscomp$0[4]:"")),[parseInt(t$jscomp$0.substr(1,2),16),parseInt(t$jscomp$0.substr(3,2),16),parseInt(t$jscomp$0.substr(5,2),16),7<t$jscomp$0.length?parseInt(t$jscomp$0.substr(7,2),16)/255:1];if(-1===t$jscomp$0.indexOf("rgb")){var e=document.body.appendChild(document.createElement("fictum"));if((e.style.color="rgb(1, 2, 3)","rgb(1, 2, 3)"!==e.style.color)||(e.style.color=t$jscomp$0,"rgb(1, 2, 3)"===
e.style.color||""===e.style.color))return;t$jscomp$0=getComputedStyle(e).color;document.body.removeChild(e)}return 0===t$jscomp$0.indexOf("rgb")?(-1===t$jscomp$0.indexOf("rgba")&&(t$jscomp$0+=",1"),t$jscomp$0.match(/[\.\d]+/g).map(function(t){return+t})):void 0}}function Jn(t){var e=!1,i=!1;return(0<=t.y&&t.y<this._panesYids.top.length||t.y>=this._viewportPosition.y&&t.y<this._viewportPosition.y+this._rowView.length)&&(e=!0),(0<=t.x&&t.x<this._panesXids.left.length||t.x>=this._viewportPosition.x&&
t.x<this._viewportPosition.x+this._colView.length)&&(i=!0),!(!e||!i)}function ir(t){return[{x:t[0],y:0},{x:t[1],y:this._rows.coordList.length-1}]}function or(t){return[{x:0,y:t[0]},{x:this._cols.coordList.length-1,y:t[1]}]}function ar(t,e,i){for(var o=0;o<t.length;o++)if(t[o][e]==i)return o;return-1}function Lr(){var t={top:this._panesYids.top,center:this._rowView},e;for(e in this._domNodes.canvas){var i=this._domNodes.canvas[e];i._context.fillStyle=this.getThemeSetting("sheet");i._context.fillRect(0,
0,i._drawWidth,i._drawHeight);for(var o=0;o<i._drawHeight&&!(o>t[i._panePositionY].length-1);o++)Yn.call(this,i,o,t[i._panePositionY][o],i._panePositionX),o==t[i._panePositionY].length-1&&Yn.call(this,i,o+1,t[i._panePositionY][o],i._panePositionX)}this._domNodes["column-top"].innerHTML=qe.call(this,this._panesYids.top);this._domNodes["column-center"].innerHTML=qe.call(this,this._rowView);for(var t$jscomp$0=document.createDocumentFragment(),e$jscomp$0=this._cd.rowHeaderSpace,i$jscomp$0=0;i$jscomp$0<
this._panesXids.left.length;i$jscomp$0++){var o$jscomp$0=this._panesXids.left[i$jscomp$0]-1,s=this._cols.store[o$jscomp$0],n=this._columnNodes[o$jscomp$0];n["column-top"].textContent=ti.call(this,s.id);n["column-center"].textContent=ei.call(this,s.id);n.column.style.transform="translateX("+e$jscomp$0+"px)";n.column.style.opacity=1;t$jscomp$0.appendChild(n.column);e$jscomp$0+=s.width}this._domNodes["pane-left"].insertBefore(t$jscomp$0,this._domNodes["pane-left"].firstChild);for(i$jscomp$0=0;i$jscomp$0<
this._domNodes["pane-left"].children.length;i$jscomp$0++){var r=this._domNodes["pane-left"].children[i$jscomp$0]._colId;this._domNodes["pane-left"].children[i$jscomp$0]==this._domNodes.rowHeaderColumn||-1<this._panesXids.left.indexOf(r)||(this._domNodes["pane-left"].children[i$jscomp$0].style.opacity=0)}for(var t$jscomp$1=document.createDocumentFragment(),e$jscomp$1=0,i$jscomp$1=0;i$jscomp$1<this._colView.length;i$jscomp$1++){var o$jscomp$1=this._colView[i$jscomp$1]-1,s$jscomp$0=this._cols.store[o$jscomp$1],
n$jscomp$0=this._columnNodes[o$jscomp$1];n$jscomp$0["column-top"].textContent=ti.call(this,s$jscomp$0.id);n$jscomp$0["column-center"].textContent=ei.call(this,s$jscomp$0.id);n$jscomp$0.column.style.transform="translateX("+e$jscomp$1+"px)";n$jscomp$0.column.style.opacity=1;t$jscomp$1.appendChild(n$jscomp$0.column);e$jscomp$1+=s$jscomp$0.width}this._domNodes["pane-center"].insertBefore(t$jscomp$1,this._domNodes["pane-center"].firstChild);for(i$jscomp$1=0;i$jscomp$1<this._domNodes["pane-center"].children.length;i$jscomp$1++)-1<
this._colView.indexOf(this._domNodes["pane-center"].children[i$jscomp$1]._colId)||(this._domNodes["pane-center"].children[i$jscomp$1].style.opacity=0);for(var t$jscomp$2,e$jscomp$2,i$jscomp$2=1==this._selection.length,o$jscomp$2=0;o$jscomp$2<this._selection.length;o$jscomp$2++){t$jscomp$2=Di.call(this,this._selection[o$jscomp$2].range);e$jscomp$2=o$jscomp$2==this._activeRangeIndex;var t$jscomp$3=this._selection[o$jscomp$2].range,e$jscomp$3=o$jscomp$2,i$jscomp$3=t$jscomp$2,o$jscomp$3=i$jscomp$2,s$jscomp$1=
e$jscomp$2;e$jscomp$3>this._domNodes.cellRangeContainer.children.length-1&&(this._domNodes.cellRangeContainer.appendChild(te(this._templates.cellRange)),this._domNodes.cellRangeForegroundContainer.appendChild(te(this._templates.cellRangeForeground)));var n$jscomp$1=Vi.call(this,t$jscomp$3),n$jscomp$2=this._domNodes.cellRangeContainer.children[e$jscomp$3];n$jscomp$2.style.opacity=null==n$jscomp$1||i$jscomp$3&&o$jscomp$3?0:n$jscomp$2._opacity;n$jscomp$2.style.transform="translate("+(n$jscomp$1.x.offset-
0)+"px,"+(n$jscomp$1.y.offset-0)+"px) scale("+(n$jscomp$1.x.size/100+","+n$jscomp$1.y.size/100+")");var n$jscomp$3=this._domNodes.cellRangeForegroundContainer.children[e$jscomp$3],r$jscomp$0=n$jscomp$3._borderStyle||"solid";null==n$jscomp$1||i$jscomp$3&&o$jscomp$3||s$jscomp$1&&String(this._currentDragAction).startsWith("select")?n$jscomp$3.style.opacity=0:n$jscomp$3.style.opacity=n$jscomp$3._opacity;n$jscomp$3.style.transform="translate("+(n$jscomp$1.x.offset-0)+"px,"+(n$jscomp$1.y.offset-0)+"px)";
n$jscomp$3.style.width=n$jscomp$1.x.size+"px";n$jscomp$3.style.height=n$jscomp$1.y.size+"px";n$jscomp$3.style["border-left-style"]=n$jscomp$1.x.lineLeft?r$jscomp$0:"none";n$jscomp$3.style["border-right-style"]=n$jscomp$1.x.lineRight?r$jscomp$0:"none";n$jscomp$3.style["border-top-style"]=n$jscomp$1.y.lineTop?r$jscomp$0:"none";n$jscomp$3.style["border-bottom-style"]=n$jscomp$1.y.lineBottom?r$jscomp$0:"none"}for(;this._domNodes.cellRangeContainer.children.length>this._selection.length;)this._domNodes.cellRangeContainer.removeChild(this._domNodes.cellRangeContainer.lastChild),
this._domNodes.cellRangeForegroundContainer.removeChild(this._domNodes.cellRangeForegroundContainer.lastChild);var t$jscomp$4=this._domNodes.cellCursor;if(this._selection.length&&!this._domNodes.cellEditor._isOpen){var t$jscomp$5=this._cellCursorPosition;var e$jscomp$4=[t$jscomp$5,t$jscomp$5];var i$jscomp$4=Vi.call(this,e$jscomp$4),o$jscomp$4=(t$jscomp$4=this._domNodes.cellCursor)._borderStyle||"solid";null!=e$jscomp$4?(t$jscomp$4.style.opacity=t$jscomp$4._opacity||"",i$jscomp$4.y.lineTop&&0!=i$jscomp$4.x.size?
t$jscomp$4.style["border-top-style"]=o$jscomp$4:t$jscomp$4.style["border-top-style"]="none",i$jscomp$4.y.lineBottom&&0!=i$jscomp$4.x.size?t$jscomp$4.style["border-bottom-style"]=o$jscomp$4:t$jscomp$4.style["border-bottom-style"]="none",i$jscomp$4.x.lineLeft&&0!=i$jscomp$4.y.size?t$jscomp$4.style["border-left-style"]=o$jscomp$4:t$jscomp$4.style["border-left-style"]="none",i$jscomp$4.x.lineRight&&0!=i$jscomp$4.y.size?t$jscomp$4.style["border-right-style"]=o$jscomp$4:t$jscomp$4.style["border-right-style"]=
"none",t$jscomp$4.style.transform="translate("+i$jscomp$4.x.offset+"px,"+i$jscomp$4.y.offset+"px)",t$jscomp$4.style.width=i$jscomp$4.x.size+"px",t$jscomp$4.style.height=i$jscomp$4.y.size+"px",Jn.call(this,this._cellCursorPosition)?this._domNodes.cellCursor.style.opacity=this._domNodes.cellCursor._opacity:this._domNodes.cellCursor.style.opacity=0):t$jscomp$4.style.opacity=0}else t$jscomp$4.style.opacity=0;var t$jscomp$6=this._domNodes.searchCursor;if(this._searchCellsFound.length){var e$jscomp$5=this._searchCellsFound[this._searchCellIndex],
t$jscomp$7={x:this.getColCoordById(e$jscomp$5[1]),y:this.getRowCoordById(e$jscomp$5[0])};var i$jscomp$5=[t$jscomp$7,t$jscomp$7];var o$jscomp$5=Vi.call(this,i$jscomp$5),s$jscomp$2=t$jscomp$6._borderStyle||"solid";null!=i$jscomp$5?(t$jscomp$6.style.opacity=t$jscomp$6._opacity||"",o$jscomp$5.y.lineTop&&0!=o$jscomp$5.x.size?t$jscomp$6.style["border-top-style"]=s$jscomp$2:t$jscomp$6.style["border-top-style"]="none",o$jscomp$5.y.lineBottom&&0!=o$jscomp$5.x.size?t$jscomp$6.style["border-bottom-style"]=s$jscomp$2:
t$jscomp$6.style["border-bottom-style"]="none",o$jscomp$5.x.lineLeft&&0!=o$jscomp$5.y.size?t$jscomp$6.style["border-left-style"]=s$jscomp$2:t$jscomp$6.style["border-left-style"]="none",o$jscomp$5.x.lineRight&&0!=o$jscomp$5.y.size?t$jscomp$6.style["border-right-style"]=s$jscomp$2:t$jscomp$6.style["border-right-style"]="none",t$jscomp$6.style.transform="translate("+(o$jscomp$5.x.offset-2)+"px,"+(o$jscomp$5.y.offset-2)+"px)",t$jscomp$6.style.width=o$jscomp$5.x.size+4+"px",t$jscomp$6.style.height=o$jscomp$5.y.size+
4+"px",Jn.call(this,i$jscomp$5[0])?this._domNodes.searchCursor.style.opacity=this._domNodes.searchCursor._opacity:this._domNodes.searchCursor.style.opacity=0):t$jscomp$6.style.opacity=0}else t$jscomp$6.style.opacity=0;for(var t$jscomp$8=We(this._selection,{type:"col"}),e$jscomp$6=We(this._selection,{type:"row"}),i$jscomp$6=t$jscomp$8.length,o$jscomp$6=this._selection.length-t$jscomp$8.length,s$jscomp$3=e$jscomp$6.length,n$jscomp$4=this._selection.length-e$jscomp$6.length,r$jscomp$1=0;r$jscomp$1<t$jscomp$8.length;r$jscomp$1++){var e$jscomp$7=
r$jscomp$1,i$jscomp$7=Vi.call(this,t$jscomp$8[r$jscomp$1].range);e$jscomp$7>this._domNodes.colHeaderRangeSelectedContainer.children.length-1&&this._domNodes.colHeaderRangeSelectedContainer.appendChild(te(this._templates.colHeaderRangeSelected));var o$jscomp$7=this._domNodes.colHeaderRangeSelectedContainer.children[e$jscomp$7];o$jscomp$7.style.opacity=null==i$jscomp$7?0:o$jscomp$7._opacity;o$jscomp$7.style.transform="translate("+(i$jscomp$7.x.offset-0)+"px,0px) scale("+(i$jscomp$7.x.size/100+","+this.colHeaderHeight/
100+")")}var l=0;for(r$jscomp$1=0;r$jscomp$1<this._selection.length;r$jscomp$1++)if("col"!=this._selection[r$jscomp$1].type){var e$jscomp$8=l,i$jscomp$8=Vi.call(this,this._selection[r$jscomp$1].range);e$jscomp$8>this._domNodes.colHeaderRangeHighlightContainer.children.length-1&&this._domNodes.colHeaderRangeHighlightContainer.appendChild(te(this._templates.colHeaderRangeHighlight));var o$jscomp$8=this._domNodes.colHeaderRangeHighlightContainer.children[e$jscomp$8];o$jscomp$8.style.opacity=null==i$jscomp$8?
0:o$jscomp$8._opacity;o$jscomp$8.style.transform="translate("+(i$jscomp$8.x.offset-0)+"px,0px) scale("+(i$jscomp$8.x.size/100+","+this.colHeaderHeight/100+")");l++}for(r$jscomp$1=0;r$jscomp$1<e$jscomp$6.length;r$jscomp$1++){var e$jscomp$9=r$jscomp$1,i$jscomp$9=Vi.call(this,e$jscomp$6[r$jscomp$1].range);e$jscomp$9>this._domNodes.rowHeaderRangeSelectedContainer.children.length-1&&this._domNodes.rowHeaderRangeSelectedContainer.appendChild(te(this._templates.rowHeaderRangeSelected));var o$jscomp$9=this._domNodes.rowHeaderRangeSelectedContainer.children[e$jscomp$9];
o$jscomp$9.style.opacity=null==i$jscomp$9?0:o$jscomp$9._opacity;o$jscomp$9.style.transform="translate(0px,"+(i$jscomp$9.y.offset-0)+"px) scale("+(this.rowHeaderWidth/100+","+i$jscomp$9.y.size/100+")")}for(r$jscomp$1=l=0;r$jscomp$1<this._selection.length;r$jscomp$1++)if("row"!=this._selection[r$jscomp$1].type){var e$jscomp$10=l,i$jscomp$10=Vi.call(this,this._selection[r$jscomp$1].range);e$jscomp$10>this._domNodes.rowHeaderRangeHighlightContainer.children.length-1&&this._domNodes.rowHeaderRangeHighlightContainer.appendChild(te(this._templates.rowHeaderRangeHighlight));
var o$jscomp$10=this._domNodes.rowHeaderRangeHighlightContainer.children[e$jscomp$10];o$jscomp$10.style.opacity=null==i$jscomp$10?0:o$jscomp$10._opacity;o$jscomp$10.style.transform="translate(0px,"+(i$jscomp$10.y.offset-0)+"px) scale("+(this.rowHeaderWidth/100+","+i$jscomp$10.y.size/100+")");l++}for(;this._domNodes.colHeaderRangeHighlightContainer.children.length>o$jscomp$6;)this._domNodes.colHeaderRangeHighlightContainer.removeChild(this._domNodes.colHeaderRangeHighlightContainer.lastChild);for(;this._domNodes.colHeaderRangeSelectedContainer.children.length>
i$jscomp$6;)this._domNodes.colHeaderRangeSelectedContainer.removeChild(this._domNodes.colHeaderRangeSelectedContainer.lastChild);for(;this._domNodes.rowHeaderRangeHighlightContainer.children.length>n$jscomp$4;)this._domNodes.rowHeaderRangeHighlightContainer.removeChild(this._domNodes.rowHeaderRangeHighlightContainer.lastChild);for(;this._domNodes.rowHeaderRangeSelectedContainer.children.length>s$jscomp$3;)this._domNodes.rowHeaderRangeSelectedContainer.removeChild(this._domNodes.rowHeaderRangeSelectedContainer.lastChild);
for(var t$jscomp$9=[],e$jscomp$11=0;e$jscomp$11<this._panesYids.top.length;e$jscomp$11++)null!==this._rows.iconList[e$jscomp$11][1]&&t$jscomp$9.push({groupIndex:this._rows.iconList[e$jscomp$11][1],position:this.getRowPositionInViewport(e$jscomp$11)+this.getRowHeightById(this._panesYids.top[e$jscomp$11])-16+1});for(e$jscomp$11=0;e$jscomp$11<this._rowView.length;e$jscomp$11++){var i$jscomp$11=this._viewportPosition.y+e$jscomp$11;null!==this._rows.iconList[i$jscomp$11][1]&&t$jscomp$9.push({groupIndex:this._rows.iconList[i$jscomp$11][1],
position:this.getRowPositionInViewport(i$jscomp$11)+this.getRowHeightById(this._rowView[e$jscomp$11])-16+1})}pr.call(this,"next",t$jscomp$9);for(var t$jscomp$10=[],e$jscomp$12=0;e$jscomp$12<this._panesYids.top.length;e$jscomp$12++)null!==this._rows.iconList[e$jscomp$12][0]&&t$jscomp$10.push({groupIndex:this._rows.iconList[e$jscomp$12][0],position:this.getRowPositionInViewport(e$jscomp$12)});for(e$jscomp$12=0;e$jscomp$12<this._rowView.length;e$jscomp$12++){var i$jscomp$12=this._viewportPosition.y+
e$jscomp$12;null!==this._rows.iconList[i$jscomp$12][0]&&t$jscomp$10.push({groupIndex:this._rows.iconList[i$jscomp$12][0],position:this.getRowPositionInViewport(i$jscomp$12)})}pr.call(this,"prev",t$jscomp$10);for(var t$jscomp$11=[],e$jscomp$13=0;e$jscomp$13<this._panesXids.left.length;e$jscomp$13++)null!==this._cols.iconList[e$jscomp$13][1]&&t$jscomp$11.push({groupIndex:this._cols.iconList[e$jscomp$13][1],position:this.getColPositionInViewport(e$jscomp$13)+this.getColWidthById(this._panesXids.left[e$jscomp$13])-
14+1});for(e$jscomp$13=0;e$jscomp$13<this._colView.length;e$jscomp$13++){var i$jscomp$13=this._viewportPosition.x+e$jscomp$13;null!==this._cols.iconList[i$jscomp$13][1]&&t$jscomp$11.push({groupIndex:this._cols.iconList[i$jscomp$13][1],position:this.getColPositionInViewport(i$jscomp$13)+this.getColWidthById(this._colView[e$jscomp$13])-14+1})}yr.call(this,"next",t$jscomp$11);for(var t$jscomp$12=[],e$jscomp$14=0;e$jscomp$14<this._panesXids.left.length;e$jscomp$14++)null!==this._cols.iconList[e$jscomp$14][0]&&
t$jscomp$12.push({groupIndex:this._cols.iconList[e$jscomp$14][0],position:this.getColPositionInViewport(e$jscomp$14)});for(e$jscomp$14=0;e$jscomp$14<this._colView.length;e$jscomp$14++){var i$jscomp$14=this._viewportPosition.x+e$jscomp$14;null!==this._cols.iconList[i$jscomp$14][0]&&t$jscomp$12.push({groupIndex:this._cols.iconList[i$jscomp$14][0],position:this.getColPositionInViewport(i$jscomp$14)})}yr.call(this,"prev",t$jscomp$12);var t$jscomp$13=this._domNodes.fillHandle;if(this._selection.length&&
!this._domNodes.cellEditor._isOpen){var e$jscomp$15=this._selection[this._selection.length-1].range[1],i$jscomp$15=this.getColPositionInViewport(e$jscomp$15.x),o$jscomp$11=this.getRowPositionInViewport(e$jscomp$15.y),s$jscomp$4=i$jscomp$15+this.getColWidthById(this.getColIdByCoord(e$jscomp$15.x))-7,n$jscomp$5=o$jscomp$11+this.getRowHeightById(this.getRowIdByCoord(e$jscomp$15.y))-7;t$jscomp$13.style.transform="translate("+s$jscomp$4+"px, "+n$jscomp$5+"px)";!Jn.call(this,e$jscomp$15)||String(this._currentDragAction).startsWith("select")?
t$jscomp$13.style.opacity=0:t$jscomp$13.style.opacity=this._domNodes.fillHandle._opacity}else t$jscomp$13.style.opacity=0;Wi.call(this,this._domNodes.fillRange,this._fillRange);if(this._lastColView.startIndex>this._viewportPosition.x)this._domNodes.blankSheetRight.style.opacity=0;else{var t$jscomp$14=this._viewportPosition.x+(this._colView.length-1),e$jscomp$16=this.getColPositionInViewport(t$jscomp$14);e$jscomp$16+=this.getColWidthById(this._cols.coordList[t$jscomp$14]);e$jscomp$16+=1;this._domNodes.blankSheetRight.style.transform=
"scaleX("+(this._cd.viewportWidth-e$jscomp$16)/100+")";this._domNodes.blankSheetRight.style.opacity=this._domNodes.blankSheetRight._opacity}if(this._lastRowView.startIndex>this._viewportPosition.y)this._domNodes.blankSheetBottom.style.opacity=0;else{var s$jscomp$5=this.getRowPositionInViewport(this._viewportPosition.y+(this._rowView.length-1));s$jscomp$5+=this._actualRowHeight;s$jscomp$5+=1;var n$jscomp$6=(this._cd.viewportHeight-s$jscomp$5)/100;this._domNodes.blankSheetBottom.style.transform="scaleY("+
n$jscomp$6+")";this._domNodes.blankSheetBottom.style.opacity=0<n$jscomp$6?1:0}Wi.call(this,this._domNodes.copyRange,this._copyRange);Wi.call(this,this._domNodes.cutRange,this._cutRange);Wi.call(this,this._domNodes.fillRange,this._fillRange);for(var t$jscomp$15=[],e$jscomp$17=0;e$jscomp$17<this._colLines.length;e$jscomp$17++)t$jscomp$15.push(e$jscomp$17);var i$jscomp$16=this._cd.rowHeaderSpace,o$jscomp$12=[];for(e$jscomp$17=0;e$jscomp$17<this._panesXids.left.length;e$jscomp$17++)i$jscomp$16+=this.getColWidthById(this._panesXids.left[e$jscomp$17]),
-1<(s$jscomp$6=ar(this._colLines,"position",i$jscomp$16))?(t$jscomp$15.splice(t$jscomp$15.indexOf(s$jscomp$6),1),this._colLines[s$jscomp$6].node.style.opacity=1):o$jscomp$12.push(i$jscomp$16);i$jscomp$16=this._cd.panesX.center.offset;for(e$jscomp$17=0;e$jscomp$17<this._colView.length&&!((i$jscomp$16+=this.getColWidthById(this._colView[e$jscomp$17]))>this._cd.viewportWidth);e$jscomp$17++){var s$jscomp$6;-1<(s$jscomp$6=ar(this._colLines,"position",i$jscomp$16))?(t$jscomp$15.splice(t$jscomp$15.indexOf(s$jscomp$6),
1),this._colLines[s$jscomp$6].node.style.opacity=1):o$jscomp$12.push(i$jscomp$16)}var n$jscomp$7=document.createDocumentFragment();for(e$jscomp$17=0;e$jscomp$17<o$jscomp$12.length;e$jscomp$17++)if(t$jscomp$15.length){var r$jscomp$2=t$jscomp$15.shift();this._colLines[r$jscomp$2].node.style.transform="translateX("+o$jscomp$12[e$jscomp$17]+"px)";this._colLines[r$jscomp$2].node.style.opacity=1;this._colLines[r$jscomp$2].offset=o$jscomp$12[e$jscomp$17]}else{var l$jscomp$0=te(this._templates.colLine);l$jscomp$0.style.transform=
"translateX("+o$jscomp$12[e$jscomp$17]+"px)";n$jscomp$7.appendChild(l$jscomp$0);this._colLines.push({node:l$jscomp$0,offset:o$jscomp$12[e$jscomp$17]})}this._domNodes.colLines.appendChild(n$jscomp$7);for(e$jscomp$17=0;e$jscomp$17<t$jscomp$15.length;e$jscomp$17++)this._colLines[t$jscomp$15[e$jscomp$17]].node.style.opacity=0;if(this._freezeLineRowAfterId&&!this._sectionsPerPaneY.top.length){var t$jscomp$16=this.getRowPositionInViewport(this.getRowCoordById(this._freezeLineRowAfterId)+1);this._domNodes.freezeLinePlaceholder_row.style.transform=
"translateY("+t$jscomp$16+"px)";this._domNodes.freezeLinePlaceholder_row.style.opacity=t$jscomp$16?1:0}else this._domNodes.freezeLinePlaceholder_row.style.opacity=0;if(this._freezeLineColAfterId&&!this._sectionsPerPaneX.left.length){var e$jscomp$18=this.getColPositionInViewport(this.getColCoordById(this._freezeLineColAfterId)+1);P$jscomp$0(this._domNodes.freezeLinePlaceholder_col,{transform:"translateX("+e$jscomp$18+"px)",opacity:e$jscomp$18?1:0})}else this._domNodes.freezeLinePlaceholder_col.style.opacity=
0;if(null!=this._prevSelection)for(var t$jscomp$17,e$jscomp$19=0;e$jscomp$19<this._prevSelection.selection.length;e$jscomp$19++)for(var i$jscomp$17=0;i$jscomp$17<this._prevSelection.selection[e$jscomp$19].colIds.length;i$jscomp$17++)t$jscomp$17=this._prevSelection.selection[e$jscomp$19].colIds[i$jscomp$17],this._columnNodes[t$jscomp$17-1].columnHeaderLabel.style.color=this.getThemeSetting("header|text");for(var t$jscomp$18,e$jscomp$20=We(this._selection,{type:"col"}),i$jscomp$18=0;i$jscomp$18<e$jscomp$20.length;i$jscomp$18++)for(var o$jscomp$13=
e$jscomp$20[i$jscomp$18].range[0].x;o$jscomp$13<=e$jscomp$20[i$jscomp$18].range[1].x;o$jscomp$13++)t$jscomp$18=this.getColIdByCoord(o$jscomp$13),this._columnNodes[t$jscomp$18-1].columnHeaderLabel.style.color=this.getThemeSetting("header:selected|text");for(var t$jscomp$19=[],e$jscomp$21=0;e$jscomp$21<this._rowLines.length;e$jscomp$21++)t$jscomp$19.push(e$jscomp$21);var i$jscomp$19=this._cd.colHeaderSpace,o$jscomp$14=[];for(e$jscomp$21=0;e$jscomp$21<this._panesYids.top.length;e$jscomp$21++)i$jscomp$19+=
this.getRowHeightById(this._panesYids.top[e$jscomp$21]),-1<(s$jscomp$7=ar(this._rowLines,"position",i$jscomp$19))?(t$jscomp$19.splice(t$jscomp$19.indexOf(s$jscomp$7),1),this._rowLines[s$jscomp$7].node.style.opacity=1):o$jscomp$14.push(i$jscomp$19);i$jscomp$19=this._cd.panesY.center.offset;for(e$jscomp$21=0;e$jscomp$21<this._rowView.length&&!((i$jscomp$19+=this.getRowHeightById(this._rowView[e$jscomp$21]))>this._cd.viewportHeight);e$jscomp$21++){var s$jscomp$7;-1<(s$jscomp$7=ar(this._rowLines,"position",
i$jscomp$19))?(t$jscomp$19.splice(t$jscomp$19.indexOf(s$jscomp$7),1),this._rowLines[s$jscomp$7].node.style.opacity=1):o$jscomp$14.push(i$jscomp$19)}var n$jscomp$8=document.createDocumentFragment();for(e$jscomp$21=0;e$jscomp$21<o$jscomp$14.length;e$jscomp$21++)if(t$jscomp$19.length){var r$jscomp$3=t$jscomp$19.shift();this._rowLines[r$jscomp$3].node.style.transform="translateY("+o$jscomp$14[e$jscomp$21]+"px)";this._rowLines[r$jscomp$3].node.style.opacity=1;this._rowLines[r$jscomp$3].offset=o$jscomp$14[e$jscomp$21]}else{var l$jscomp$1=
te(this._templates.rowLine);l$jscomp$1.style.transform="translateY("+o$jscomp$14[e$jscomp$21]+"px)";n$jscomp$8.appendChild(l$jscomp$1);this._rowLines.push({node:l$jscomp$1,offset:o$jscomp$14[e$jscomp$21]})}this._domNodes.rowLines.appendChild(n$jscomp$8);for(e$jscomp$21=0;e$jscomp$21<t$jscomp$19.length;e$jscomp$21++)this._rowLines[t$jscomp$19[e$jscomp$21]].node.style.opacity=0;this.constructor.contextMenu.redrawLabels()}function Pr(){var t=this;this._domNodes.container._resizeSensor=new Kt(this._domNodes.container,
this);this._domNodes.lineHeightMeter._resizeSensor=new Kt(this._domNodes.lineHeightMeter,this);T$jscomp$0.call(this,{name:"rowHeaderColumn",style:{position:"absolute",width:this._cd.rowHeaderSpace+"px",height:this._cd.viewportHeight+"px","line-height":this.rowHeight+"px",overflow:"hidden",contain:"strict","white-space":"pre","font-size":this.fontSize+"px","font-family":this.fontFamily,color:this.getThemeSetting("sheet|text")},children:[{name:"innerColumn",style:{position:"relative","margin-top":this._cd.colHeaderSpace+
"px","padding-left":"6px","padding-right":"6px",width:this._cd.rowHeaderSpace+"px","box-sizing":"border-box",color:this.getThemeSetting("header|text"),"white-space":"pre","line-height":this.rowHeight+"px","text-align":this.rowHeaderLabelAlign},children:[{name:"column-top",style:{position:"absolute",top:this._cd.panesY.top.offset+"px",height:this._cd.panesY.top.space+"px",width:this._cd.rowHeaderSpace-12+"px"},html:qe.call(this,this._panesYids.top)},{name:"column-center",style:{position:"absolute",
top:this._cd.panesY.center.offset-this._cd.colHeaderSpace+"px",height:this._cd.panesY.center.space+"px",width:this._cd.rowHeaderSpace-12+"px",overflow:"hidden"},html:qe.call(this,this._rowView)}]}]});ni.call(this);this._templates={};this._templates.colHeaderRangeHighlight=T$jscomp$0.call(this,{name:"colHeaderRangeHighlight",style:{position:"absolute",top:0,left:0,"background-color":this.getThemeSetting("header:highlight"),"transform-origin":"0 0",width:"100px",height:"100px",opacity:0},_opacity:1});
this._templates.colHeaderRangeSelected=T$jscomp$0.call(this,{name:"colHeaderRangeSelected",style:{position:"absolute",top:0,left:0,"background-color":this.getThemeSetting("header:selected"),"transform-origin":"0 0",width:"100px",height:"100px",opacity:0},_opacity:1});this._templates.rowHeaderRangeHighlight=T$jscomp$0.call(this,{name:"rowHeaderRangeHighlight",style:{position:"absolute",top:0,left:0,"background-color":this.getThemeSetting("header:highlight"),"transform-origin":"0 0",width:"100px",height:"100px",
opacity:0},_opacity:1});this._templates.rowHeaderRangeSelected=T$jscomp$0.call(this,{name:"rowHeaderRangeSelected",style:{position:"absolute",top:0,left:0,"background-color":this.getThemeSetting("header:selected"),"transform-origin":"0 0",width:"100px",height:"100px",opacity:0},_opacity:1});this._templates.cellRange=T$jscomp$0.call(this,{style:{position:"absolute",top:0,left:0,"background-color":this.getThemeSetting("cellrange:selected"),"transform-origin":"0 0",width:"100px",height:"100px",opacity:0},
_opacity:this.getThemeSetting("cellrange:selected|opacity")});this._templates.cellRangeForeground=T$jscomp$0.call(this,{name:"cellRangeForeground",style:{position:"absolute",top:0,left:0,"border-width":"thin","border-top-style":"solid","border-bottom-style":"solid","border-left-style":"solid","border-right-style":"solid","border-color":this.getThemeSetting("cellrange:selected|border"),"transform-origin":"0 0","box-sizing":"border-box",width:this.colWidth+1+"px",height:this.rowHeight+1+"px",opacity:0},
_opacity:1,_borderStyle:"solid"});this._templates.hiddenRowGroupIconPrev=T$jscomp$0.call(this,{name:"hiddenRowGroupIconPrev",style:{position:"absolute",top:0,left:"2px",height:"16px",width:"16px","border-radius":"0 0 2px 2px","border-width":"1px","border-style":"solid","border-top-style":"none","border-color":"transparent","box-sizing":"border-box","font-size":10,"text-align":"center"},html:'\n  \x3csvg height\x3d"8" width\x3d"8" style\x3d"position:absolute;top:4px;left:3px;fill:'+this.getThemeSetting("header-icon")+
';"\x3e\n    \x3cpolygon points\x3d"4,6 0,0 8,0" class\x3d"triangle"\x3e\n  \x3c/svg\x3e'});this._templates.hiddenRowGroupIconNext=T$jscomp$0.call(this,{name:"hiddenRowGroupIconNext",style:{position:"absolute",top:0,left:"2px",height:"16px",width:"16px","border-radius":"2px 2px 0 0","border-width":"1px","border-style":"solid","border-bottom-style":"none","border-color":"transparent","box-sizing":"border-box","font-size":10,"text-align":"center"},html:'\n  \x3csvg height\x3d"8" width\x3d"8" style\x3d"position:absolute;bottom:4px;left:3px;fill:'+
this.getThemeSetting("header-icon")+';"\x3e\n    \x3cpolygon points\x3d"4,2 0,8 8,8" class\x3d"triangle"\x3e\n  \x3c/svg\x3e\n  '});this._templates.hiddenColGroupIconPrev=T$jscomp$0.call(this,ui.call(this));this._templates.hiddenColGroupIconNext=T$jscomp$0.call(this,pi.call(this));this._templates.colLine=T$jscomp$0.call(this,{name:"colLine",style:{position:"absolute",top:0,bottom:0,left:0,width:0,transform:"translateX(0)","border-right":"thin solid "+this.getThemeSetting("gridline"),opacity:1},children:[{style:{position:"absolute",
top:0,left:0,height:this._cd.colHeaderSpace+1+"px","border-right":"thin solid "+this.getThemeSetting("gridline-tip")}}]});this._templates.rowLine=T$jscomp$0.call(this,{name:"rowLine",style:{position:"absolute",top:0,left:0,right:0,height:0,"border-bottom":"thin solid "+this.getThemeSetting("gridline"),transform:"translateY(0)",opacity:1},children:[{style:{position:"absolute",left:0,top:0,width:this._cd.rowHeaderSpace+1+"px","border-bottom":"thin solid "+this.getThemeSetting("gridline-tip")}}]});T$jscomp$0.call(this,
{name:"component theme-"+this.cssTheme,style:{position:"relative","user-select":"none",width:this._cd.componentWidth+"px",height:this._cd.componentHeight+"px",overflow:"hidden","z-index":0,"font-size":this.fontSize,"font-family":this.fontFamily},noCSS:Y[".dgxl-component"].call(this),id:"datagridxl_"+this._componentIndex,children:[{name:"topbar bar",style:{position:"absolute",height:this._cd.topBarSpace+"px","line-height":this._cd.topBarSpace+"px",left:0,top:0,right:0,"box-sizing":"border-box",display:this._cd.topBarSpace?
"flex":"none","justify-content":"space-between"},noCSS:Y[".dgxl-bar"].call(this),domNodes:Gt.call(this),_reset:!1},{name:"display",style:{position:"absolute",top:this._cd.topBarSpace+"px",left:0,right:0,bottom:this._cd.bottomBarSpace+"px","background-color":this.getThemeSetting("sheet")},children:[{name:"viewport",style:{overflow:"hidden",position:"absolute",top:0,left:0,width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px"},children:[Zt.call(this),{name:"colHeaderBackground",style:{position:"absolute",
left:0,top:0,background:this.getThemeSetting("header"),height:this._cd.colHeaderSpace+"px",width:this._cd.viewportWidth+"px"}},{name:"rowHeaderBackground",style:{position:"absolute",left:0,top:0,background:this.getThemeSetting("header"),height:this._cd.viewportHeight+"px",width:this._cd.rowHeaderSpace+"px"}},{name:"colHeaderRangeHighlightContainer",domNodes:[te(this._templates.colHeaderRangeHighlight)]},{name:"colHeaderRangeSelectedContainer",domNodes:[te(this._templates.colHeaderRangeSelected)]},
{name:"rowHeaderRangeHighlightContainer",domNodes:[te(this._templates.rowHeaderRangeHighlight)]},{name:"rowHeaderRangeSelectedContainer",domNodes:[te(this._templates.rowHeaderRangeSelected)]},{name:"gridLines",style:{position:"absolute",top:0,left:0,opacity:this.getThemeSetting("gridline|opacity"),overflow:"hidden",width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px"},children:re.call(this)},{name:"cellRangeContainer",domNodes:[te(this._templates.cellRange)]},{name:"panes",style:{"font-family":"sans-serif",
"font-size":"14px",width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px",position:"absolute",top:0,left:0,overflow:"hidden",contain:"layout style"},children:[{name:"pane-left",style:{position:"absolute",left:this._cd.panesX.left.offset+"px",width:this._cd.panesX.left.space+"px",height:this._cd.viewportHeight+"px",top:0,overflow:"hidden"},domNodes:ve.call(this,"left")},{name:"pane-center",style:{position:"absolute",left:this._cd.panesX.center.offset+"px",width:this._cd.panesX.center.space+
"px",height:this._cd.viewportHeight+"px",top:0,overflow:"hidden"},domNodes:ve.call(this,"center")}]},{name:"freezeLines",style:{overflow:"hidden",position:"absolute",top:0,left:0,width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px"},children:[we.call(this),Ce.call(this)]},{name:"placeholderFreezeLines",style:{position:"absolute",top:0,left:0,opacity:1,overflow:"hidden",width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px"},children:ue.call(this)},{name:"cellRangeForegroundContainer",
domNodes:[te(this._templates.cellRangeForeground)]},{name:"blankSheetContainer",children:[fe.call(this),ge.call(this)]},{name:"actionRangesContainer",style:{overflow:"hidden",position:"absolute",top:0,left:0,width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px"},children:[{name:"fillRange",style:{overflow:"hidden","pointer-events":"none",position:"absolute","box-sizing":"border-box","border-width":"1px","border-style":"dashed","border-color":this.getThemeSetting("cellrange:fill"),
top:0,left:0,opacity:0},_extra:0,_opacity:1,_borderStyle:"dashed"},{name:"copyRange",style:{overflow:"hidden","pointer-events":"none",position:"absolute","box-sizing":"border-box","border-width":"2px","border-style":"dashed","border-color":this.getThemeSetting("cellrange:copy"),"background-color":"transparent",top:0,left:0,opacity:0},_extra:1,_opacity:1,_borderStyle:"dashed"},{name:"cutRange",style:{overflow:"hidden","pointer-events":"none",position:"absolute","box-sizing":"border-box","border-width":"2px",
"border-style":"dashed","border-color":this.getThemeSetting("cellrange:cut"),"background-color":"transparent",top:0,left:0,opacity:0},_extra:1,_opacity:1,_borderStyle:"dashed"}]},{name:"cellCursor",style:{position:"absolute",top:0,left:0,"box-sizing":"border-box","border-width":"2px","border-style":"solid","border-color":this.getThemeSetting("cellcursor"),"transform-origin":"0 0",width:this.colWidth+1+"px",height:this.actualRowHeight+1+"px",opacity:0},_opacity:1},{name:"searchCursor",style:{position:"absolute",
top:0,left:0,"box-sizing":"border-box","border-width":"2px","border-style":"solid","border-color":this.getThemeSetting("searchcursor"),"border-radius":"4px","transform-origin":"center center",width:this.colWidth+1+"px",height:this._actualRowHeight+1+"px",opacity:0,transition:"transform 0.05s"},_opacity:1},{name:"ghostsContainer",style:{overflow:"hidden",position:"absolute",top:0,left:0,width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px"},children:Re.call(this)},{name:"guidesContainer",
style:{overflow:"hidden",position:"absolute",top:0,left:0,width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px"},children:[{name:"guideForResizeCols",style:{position:"absolute",top:0,left:0,bottom:0,width:"1px","background-color":this.getThemeSetting("resize?guide"),"box-sizing":"border-box",opacity:0},_opacity:this.getThemeSetting("resize?guide|opacity")},{name:"guideForMoveCols",style:{position:"absolute",top:this._cd.colHeaderSpace+"px",left:0,bottom:0,width:"3px","background-color":this.getThemeSetting("move?guide"),
opacity:0},_opacity:this.getThemeSetting("move?guide|opacity")},{name:"guideForMoveRows",style:{position:"absolute",left:this._cd.rowHeaderSpace+"px",top:0,right:0,height:"3px","background-color":this.getThemeSetting("move?guide"),opacity:0},_opacity:this.getThemeSetting("move?guide|opacity")},{name:"guideForFreezeRows",style:{position:"absolute",top:0,left:0,height:"6px",right:0,"background-color":this.getThemeSetting("freeze?guide"),opacity:0},_opacity:this.getThemeSetting("freeze?guide|opacity")},
{name:"guideForFreezeCols",style:{position:"absolute",top:0,left:0,width:"6px",bottom:0,"background-color":this.getThemeSetting("freeze?guide"),opacity:0},_opacity:this.getThemeSetting("freeze?guide|opacity")}]},{name:"hiddenColGroupIconContainer",children:[{name:"hiddenColGroupIconPrevContainer"},{name:"hiddenColGroupIconNextContainer"}]},{name:"hiddenRowGroupIconContainer",children:[{name:"hiddenRowGroupIconPrevContainer"},{name:"hiddenRowGroupIconNextContainer"}]},{name:"hintsContainer",style:{overflow:"hidden",
position:"absolute",top:0,left:0,width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px"},children:ke.call(this)},{name:"fillHandle",style:{position:"absolute","background-color":this.getThemeSetting("sheet"),width:"9px",height:"9px",left:0,top:0,opacity:0,display:this.constructor._isTouchDevice?"none":"block"},children:[{name:"fillHandleInner",style:{position:"absolute","background-color":this.getThemeSetting("fillhandle"),width:"8px",height:"8px",left:"1px",top:"1px"}}],_opacity:this.allowFillCells?
1:0}]},{name:"scrollbars",children:[{name:"scrollbarY",style:{position:"absolute",right:0,top:0,bottom:0,width:this._cd.scrollbarSpace+"px",background:this.getThemeSetting("scrollbar"),"border-left":"1px solid "+this.getThemeSetting("scrollbar|border")}},{name:"scrollbarX",style:{position:"absolute",bottom:0,left:0,right:0,height:this._cd.scrollbarSpace+"px",background:this.getThemeSetting("scrollbar"),"border-top":"1px solid "+this.getThemeSetting("scrollbar|border")}},{name:"jointScrollbar",style:{position:"absolute",
bottom:0,right:0,width:this._cd.scrollbarSpace+"px",height:this._cd.scrollbarSpace+"px",background:this.getThemeSetting("header"),"border-top":"1px solid "+this.getThemeSetting("scrollbar|border"),"border-left":"1px solid "+this.getThemeSetting("scrollbar|border")}}]},{name:"eventArea",style:{position:"absolute",left:0,top:0,width:this._cd.scrollAreaWidth+"px",height:this._cd.scrollAreaHeight+"px",overflow:"hidden","touch-action":"manipulation","background-color":"transparent",cursor:this.mouseCursorStatesIdle.default},
children:[{name:"scrollArea",style:{position:"absolute",overflow:"scroll","overflow-scrolling":"touch",left:0,top:0,width:this._cd.scrollAreaWidth+"px",height:this._cd.scrollAreaHeight+"px","box-sizing":"border-box",display:"block"},children:[{name:"scrollSurface",style:{width:this._cd.scrollWidth+"px",height:this._cd.scrollHeight+"px"}}]}]},Oe.call(this)],_touchStartFired:!1,_hasScrolled:!1,_hasZoomed:!1,_setViewportPositionOnScroll:!0},{name:"bottombar bar",style:{position:"absolute",height:this._cd.bottomBarSpace+
"px","line-height":this._cd.bottomBarSpace+"px",left:0,bottom:0,right:0,"box-sizing":"border-box",display:this._cd.bottomBarSpace?"flex":"none","justify-content":"space-between"},noCSS:Y[".dgxl-bar"].call(this),domNodes:Xe.call(this),_reset:!1}]});Mn.call(this);this._domNodes.container.appendChild(this._domNodes.component);An.call(this);Tn.call(this);En.call(this,"topBar");En.call(this,"bottomBar");requestAnimationFrame(function(){Lr.call(t)});wi.call(this);to.call(this,"traverseSingleCell");this.instantActivate?
this.activate():this.deactivate();setTimeout(function(){t._isReady=!0;t.events.dispatch("ready",{})},0)}function Hr(t,e){var i=this;void 0===t&&(t=null);void 0===e&&(e={});this._container=t;this._componentIndex=this.constructor.instances.length;b$jscomp$0.call(this,e);"loading"==document.readyState?document.addEventListener("DOMContentLoaded",function(){J.call(i)}):J.call(this);"complete"==document.readyState?(Xt.call(this),Pr.call(this)):window.addEventListener("load",function(){Xt.call(i);Pr.call(i)});
this.constructor.instances.push(this)}function Ur(){var t=null==this._cellCursorPosition?null:[this.getRowIdByCoord(this._cellCursorPosition.y),this.getColIdByCoord(this._cellCursorPosition.x)];t={selection:[],cellCursorPosition:this._cellCursorPosition,cellCursorPositionId:t,activeRangeIndex:this._activeRangeIndex};for(var i=0;i<this._selection.length;i++){for(var o=[{x:this._selection[i].range[0].x,y:this._selection[i].range[0].y},{x:this._selection[i].range[1].x,y:this._selection[i].range[1].y}],
JSCompiler_temp_const=t.selection,JSCompiler_temp_const$jscomp$0=JSCompiler_temp_const.push,JSCompiler_temp_const$jscomp$1=o,JSCompiler_temp_const$jscomp$2=this._selection[i].type,t$jscomp$0=o,e=[],i$jscomp$0=t$jscomp$0[0].x;i$jscomp$0<=t$jscomp$0[1].x;i$jscomp$0++)e.push(this.getColIdByCoord(i$jscomp$0));t$jscomp$0=e;e=[];for(i$jscomp$0=o[0].y;i$jscomp$0<=o[1].y;i$jscomp$0++)e.push(this.getRowIdByCoord(i$jscomp$0));JSCompiler_temp_const$jscomp$0.call(JSCompiler_temp_const,{range:JSCompiler_temp_const$jscomp$1,
type:JSCompiler_temp_const$jscomp$2,colIds:t$jscomp$0,rowIds:e})}return t}function tl(t,e,i,o){return i.title?i.title||"":this.colHeaderLabelType in o?(this.colHeaderLabelPrefix||"")+o[this.colHeaderLabelType]+(this.colHeaderLabelSuffix||""):(this.colHeaderLabelPrefix||"")+(this.colHeaderLabelSuffix||"")}function el(t,e,i,o){return i.title?i.title||"":this.rowHeaderLabelType in o?(this.rowHeaderLabelPrefix||"")+o[this.rowHeaderLabelType]+(this.rowHeaderLabelSuffix||""):(this.rowHeaderLabelPrefix||
"")+(this.rowHeaderLabelSuffix||"")}function al(t){for(var e=[],i=0;i<t.length;i++){var JSCompiler_temp_const=e,JSCompiler_temp_const$jscomp$0=JSCompiler_temp_const.push;var JSCompiler_inline_result=Ps(t[i].range);JSCompiler_inline_result=null==JSCompiler_inline_result?null:[Is.call(this,{x:JSCompiler_inline_result[0].x,y:JSCompiler_inline_result[0].y}),Is.call(this,{x:JSCompiler_inline_result[1].x,y:JSCompiler_inline_result[1].y})];JSCompiler_temp_const$jscomp$0.call(JSCompiler_temp_const,{range:JSCompiler_inline_result,
type:t[i].type})}return e}function cl(t){if(n$jscomp$9(t)&&"range"in t[0])return t;var o;i$jscomp$20(t)?o=t:e$jscomp$22(t)?o=[t]:s$jscomp$8(t)&&(o=[[{x:t.x,y:t.y},{x:t.x,y:t.y}]]);t=[];for(var l=0;l<o.length;l++)t.push({range:o[l],type:"cell"});return t}function ul(t$jscomp$0,e$jscomp$0,i,o){void 0===e$jscomp$0&&(e$jscomp$0=null);void 0===i&&(i=!1);void 0===o&&(o=null);var s=[],n=[],r=[],l=[];null!=o&&((l=gl.call(this,[{range:o}],null))[0].action="cut");t$jscomp$0=gl.call(this,t$jscomp$0,e$jscomp$0,
i);l.length&&t$jscomp$0.unshift(l[0]);t$jscomp$0.sort(function(t,e){return t.range[0].y-e.range[0].y});for(l=0;l<t$jscomp$0.length;l++){i=n.length;for(e$jscomp$0=0;e$jscomp$0<t$jscomp$0[l].rowIds.length;e$jscomp$0++)-1<n.indexOf(t$jscomp$0[l].rowIds[e$jscomp$0])?"rowStartIndex"in t$jscomp$0[l]||(t$jscomp$0[l].rowStartIndex=n.indexOf(t$jscomp$0[l].rowIds[e$jscomp$0])):n.push(t$jscomp$0[l].rowIds[e$jscomp$0]);"rowStartIndex"in t$jscomp$0[l]||(t$jscomp$0[l].rowStartIndex=i)}t$jscomp$0.sort(function(t,
e){return t.range[0].x-e.range[0].x});for(l=0;l<t$jscomp$0.length;l++){i=s.length;for(e$jscomp$0=0;e$jscomp$0<t$jscomp$0[l].colIds.length;e$jscomp$0++)-1<s.indexOf(t$jscomp$0[l].colIds[e$jscomp$0])?"colStartIndex"in t$jscomp$0[l]||(t$jscomp$0[l].colStartIndex=s.indexOf(t$jscomp$0[l].colIds[e$jscomp$0])):s.push(t$jscomp$0[l].colIds[e$jscomp$0]);"colStartIndex"in t$jscomp$0[l]||(t$jscomp$0[l].colStartIndex=i)}for(l=0;l<n.length;l++)for(r.push([]),e$jscomp$0=0;e$jscomp$0<s.length;e$jscomp$0++)r[l].push(void 0);
t$jscomp$0.sort(function(t,e){return"action"in t&&"cut"==t.action?-1:0});for(l=0;l<t$jscomp$0.length;l++){e$jscomp$0=t$jscomp$0[l].rowStartIndex;i=t$jscomp$0[l].colStartIndex;for(var y=o=0,v=t$jscomp$0[l].range[0].y;v<=t$jscomp$0[l].range[1].y;v++){y=0;for(var m=t$jscomp$0[l].range[0].x;m<=t$jscomp$0[l].range[1].x;m++)r[e$jscomp$0+o][i+y]=t$jscomp$0[l].values[o][y],y++;o++}}e$jscomp$0=[];for(l=0;l<t$jscomp$0.length;l++)"action"in t$jscomp$0[l]&&"cut"==t$jscomp$0[l].action||e$jscomp$0.push({range:t$jscomp$0[l].range,
type:"cell"});return{rowIds:n,colIds:s,values:r,selection:e$jscomp$0}}function vl(t,e){for(var i=[],o=this._cols.store._lastId,s=0;s<t;s++)o++,this._cols.store.push({id:o,field:void 0,title:void 0,width:this.colWidth,align:this.colAlign,_hide:!1,level:0,parent_id:void 0,_role:"data"}),i.push(o);this._cols.store._lastId=o;for(t=0;t<this._rows.store.length;t++)for(s=0;s<i.length;s++)this._cellStore[this._rows.store[t].id-1][i[s]-1]={value:null};e=e?this._cols.indexList.indexOf(e)+1:0;this._cols.indexList.splice.apply(this._cols.indexList,
[e,0].concat(i));for(s=0;s<i.length;s++)ii.call(this,100,i[s]);return i}function ml(t,e){for(var i=[],o=this._rows.store._lastId,s=0;s<t;s++)o++,this._rows.store.push({id:o,title:void 0,_pass:!0}),i.push(o);this._rows.store._lastId=o;for(t=0;t<this._cols.store.length;t++)for(s=0;s<i.length;s++)null==this._cellStore[i[s]-1]&&(this._cellStore[i[s]-1]=[]),this._cellStore[i[s]-1][this._cols.store[t].id-1]={value:null};e=e?this._rows.indexList.indexOf(e)+1:0;return this._rows.indexList.splice.apply(this._rows.indexList,
[e,0].concat(i)),i}function xl(t){for(var e=[],i=0;i<t.length;i++){this._cols.store[t[i]-1]._deleted=!0;var o=this._cols.indexList.indexOf(t[i]);this._cols.indexList.splice(o,1);e.push({id:t[i],index:o})}return e.reverse()}function wl(t){for(var e=[],i=0;i<t.length;i++){this._rows.store[t[i]-1]._deleted=!0;var o=this._rows.indexList.indexOf(t[i]);this._rows.indexList.splice(o,1);e.push({id:t[i],index:o})}return e.reverse()}function Cl(t){for(var e=0;e<t.length;e++)delete this._cols.store[t[e].id-
1]._deleted,this._cols.indexList.splice(t[e].index,0,t[e].id)}function bl(t){for(var e=0;e<t.length;e++)delete this._rows.store[t[e].id-1]._deleted,this._rows.indexList.splice(t[e].index,0,t[e].id)}function Il(t,e,i,o){if(void 0===i&&(i=0),null!=t)this._domNodes.cellEditor._isOpen&&this.closeCellEditorAndSave(),t=al.call(this,t),this._activeRangeIndex=Math.min(i,t.length-1),this._cellCursorPosition=null==e?t[this._activeRangeIndex].range[0]:Is.call(this,e),this._selection=t,this.constructor.contextMenu.isOpen()&&
this.constructor.contextMenu._context==this||kn.call(this),this.constructor._isTouchDevice||wi.call(this),this.activate(),this.events.dispatch("setselection",{selection:this._selection,cellCursorPosition:this._cellCursorPosition,_activeRangeIndex:this._activeRangeIndex})}function Rl(t,e){if(void 0===t&&(t=null),void 0===e&&(e="xy"),null==t)return{x:0,y:0};var i=this._viewportPosition.x+(this._colView.length-1);0<this._colViewOverflow&&--i;var o=this._viewportPosition.y+(this._rowView.length-1);if(0<
this._rowViewOverflow&&--o,t.x<this._viewportPosition.x)var s=t.x-this._viewportPosition.x;else t.x>i&&(s=t.x-i);if(t.y<this._viewportPosition.y)var n=t.y-this._viewportPosition.y;else t.y>o&&(n=t.y-o);return{x:("xy"==e||"x"==e)&&s||0,y:("xy"==e||"y"==e)&&n||0}}function Ll(t){var e={x:this._viewportPosition.x,y:this._viewportPosition.y},i=Rl.call(this,t);t.x>=this._panesXids.left.length&&(e.x+=i.x);t.y>=this._panesYids.top.length&&(e.y+=i.y);tn.call(this,e)}function Pl(t){if(null!=t&&t.selection.length){for(var e=
[],i=0;i<t.selection.length;i++)e.push({type:t.selection[i].type,range:t.selection[i].range});Il.call(this,e,t.cellCursorPosition,t.activeRangeIndex);Ll.call(this,this._cellCursorPosition)}}function Nl(){null!=this.constructor._clipboardObject&&Ki.call(this.constructor._clipboardObject.instance,this.constructor._clipboardObject.type,null)}function kl(){this._domNodes.component.style.width=this._cd.componentWidth+"px";this._domNodes.component.style.height=this._cd.componentHeight+"px";this._domNodes.display.style.width=
this._cd.displayWidth+"px";this._domNodes.display.style.height=this._cd.displayHeight+"px";this._domNodes.viewport.style.width=this._cd.viewportWidth+"px";this._domNodes.viewport.style.height=this._cd.viewportHeight+"px";this._domNodes.eventArea.style.width=this._cd.scrollAreaWidth+"px";this._domNodes.eventArea.style.height=this._cd.scrollAreaHeight+"px";this._domNodes.scrollArea.style.width=this._cd.scrollAreaWidth+"px";this._domNodes.scrollArea.style.height=this._cd.scrollAreaHeight+"px";this._domNodes.scrollSurface.style.width=
this._cd.scrollWidth+"px";this._domNodes.scrollSurface.style.height=this._cd.scrollHeight+"px";this._domNodes.actionRangesContainer.style.width=this._cd.viewportWidth+"px";this._domNodes.actionRangesContainer.style.height=this._cd.viewportHeight+"px";this._domNodes.panes.style.height=this._cd.viewportHeight+"px";this._domNodes.panes.style.width=this._cd.viewportWidth+"px";this._domNodes["pane-left"].style.height=this._cd.viewportHeight+"px";this._domNodes["pane-left"].style.width=this._cd.panesX.left.space+
"px";this._domNodes["pane-center"].style.left=this._cd.panesX.center.offset+"px";this._domNodes["pane-center"].style.height=this._cd.viewportHeight+"px";this._domNodes["pane-center"].style.width=this._cd.panesX.center.space+"px";this._domNodes.hintsContainer.style.width=this._cd.viewportWidth+"px";this._domNodes.hintsContainer.style.height=this._cd.viewportHeight+"px";this._domNodes.rowHeaderColumn.style.height=this._cd.viewportHeight+"px";this._domNodes["column-center"].style.top=this._cd.panesY.center.offset-
this._cd.colHeaderSpace+"px";this._domNodes["column-center"].style.height=this._cd.panesY.center.space+"px";for(var t=0;t<this._columnNodes.length;t++)this._columnNodes[t].column.style.height=this._cd.viewportHeight+"px",this._columnNodes[t]["column-top"].style.height=this._cd.panesY.top.outer-this._cd.colHeaderSpace+"px",this._columnNodes[t]["column-center"].style.height=this._cd.panesY.center.space+"px";this._domNodes.freezeLines.style.height=this._cd.viewportHeight+"px";this._domNodes.freezeLines.style.width=
this._cd.viewportWidth+"px";this._domNodes.placeholderFreezeLines.style.height=this._cd.viewportHeight+"px";this._domNodes.placeholderFreezeLines.style.width=this._cd.viewportWidth+"px";null==this._freezeLineRowAfterId?P$jscomp$0(this._domNodes["freezeLine-row"],{top:this._cd.panesY.center.offset-6+"px","background-color":"transparent",opacity:1}):P$jscomp$0(this._domNodes["freezeLine-row"],{top:this._cd.panesY.top.space+"px","background-color":this.getThemeSetting("freezeline"),opacity:this._sectionsPerPaneY.top.length?
1:0});null==this._freezeLineColAfterId?P$jscomp$0(this._domNodes["freezeLine-col"],{left:this._cd.panesX.center.offset-6+"px","background-color":"transparent",opacity:1}):P$jscomp$0(this._domNodes["freezeLine-col"],{left:this._cd.panesX.left.space+"px","background-color":this.getThemeSetting("freezeline"),opacity:this._sectionsPerPaneX.left.length?1:0});P$jscomp$0(this._domNodes.ghostsContainer,{width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px"});P$jscomp$0(this._domNodes.guidesContainer,
{width:this._cd.viewportWidth+"px",height:this._cd.viewportHeight+"px"});this._domNodes.colHeaderBackground.style.width=this._cd.viewportWidth+"px";this._domNodes.rowHeaderBackground.style.height=this._cd.viewportHeight+"px";this._domNodes.gridLines.style.width=this._cd.viewportWidth+"px";this._domNodes.gridLines.style.height=this._cd.viewportHeight+"px";this._domNodes.rowLines.style.width=this._cd.viewportWidth+"px";this._domNodes.colLines.style.height=this._cd.viewportHeight+"px";this._domNodes.backgrounds.style.height=
this._cd.viewportHeight+"px";this._domNodes.backgrounds.style.width=this._cd.viewportWidth+"px";P$jscomp$0(this._domNodes.background["top-left"],{width:this._cd.panesX.left.space-this._cd.rowHeaderSpace+"px",height:this._cd.panesY.top.space-this._cd.colHeaderSpace+"px"});P$jscomp$0(this._domNodes.background["top-center"],{width:this._cd.panesX.center.space+"px",height:this._cd.panesY.top.space-this._cd.colHeaderSpace+"px",left:this._cd.panesX.center.offset+"px"});P$jscomp$0(this._domNodes.background["center-left"],
{width:this._cd.panesX.left.space-this._cd.rowHeaderSpace+"px",height:this._cd.panesY.center.space+"px",top:this._cd.panesY.center.offset+"px"});P$jscomp$0(this._domNodes.background["center-center"],{width:this._cd.panesX.center.space+"px",height:this._cd.panesY.center.space+"px",top:this._cd.panesY.center.offset+"px",left:this._cd.panesX.center.offset+"px"});for(var t$jscomp$0 in this._domNodes.canvas){var e=t$jscomp$0.split("-");t=1*Math.ceil(this._cd.panesX[e[1]].space/1);e=Math.ceil(this._cd.panesY[e[0]].space/
this.rowHeight)*this.rowHeight;var h=this._domNodes.canvas[t$jscomp$0];h.style.width=t+"px";h.style.height=e+"px";h._displayWidth=t;h._displayHeight=e;h._drawWidth=h._displayWidth/1;h._drawHeight=h._displayHeight/this.rowHeight;h.width=h._drawWidth;h.height=h._drawHeight}}function Ol(t){var e=[],i=-1;if(t=t.toLowerCase()){for(var o=0;o<this._rows.coordList.length;o++)for(var s=0;s<this._cols.coordList.length;s++){var n=this._cellStore[this._rows.coordList[o]-1][this._cols.coordList[s]-1];null!=n.value&&
-1<String(n.value).toLowerCase().indexOf(t)&&(n._found=t,e.push([this._rows.coordList[o],this._cols.coordList[s]]))}e.length&&(i=0)}this._searchStr=t;this._searchCellsFound=e;this._searchCellIndex=i}function Dl(t){var e=this;if(void 0===t&&(t=""),w$jscomp$0.call(this),x$jscomp$1.call(this),t.endsWith("Cols"))for(var i=0;i<this._cols.indexList.length;i++){var o=this._cols.indexList[i];this._columnNodes[o-1].columnHeaderLabel.innerHTML=Je.call(this,o)}o=i=!1;("hideCols"==t&&this._viewportPosition.x==
this._panesXids.left.length||"freezeCols"==t)&&(i=!0);("hideRows"==t&&this._viewportPosition.y==this._panesYids.top.length||"freezeRows"==t)&&(o=!0);Bt.call(this);Vt.call(this,i,o);Nl.call(this);kl.call(this);"search"!=t&&this._searchStr&&Ol.call(this,this._searchStr);for(i=0;i<this._validatedTopBar.length;i++)"update"in this._validatedTopBar[i]&&this._validatedTopBar[i].update.call(this,this._topBarNodes[i].nodes);for(i=0;i<this._validatedBottomBar.length;i++)"update"in this._validatedBottomBar[i]&&
this._validatedBottomBar[i].update.call(this,this._bottomBarNodes[i].nodes);setTimeout(function(){$s.call(e)},0)}function Vl(t$jscomp$1,e$jscomp$0,i$jscomp$1){void 0===e$jscomp$0&&(e$jscomp$0=!0);void 0===i$jscomp$1&&(i$jscomp$1=function(){});var o$jscomp$0,s$jscomp$0=Ur.call(this),n=[],r$jscomp$0=[],l$jscomp$0=[],h$jscomp$0=[],a=[],c$jscomp$0=function(t$jscomp$0,e,i$jscomp$0,s){if(void 0===t$jscomp$0&&(t$jscomp$0="do"),void 0===i$jscomp$0&&(i$jscomp$0=function(){}),void 0===s&&(s=null),this.events.dispatch("beforesetcellvalues",
e)){Nl.call(this);"do"==t$jscomp$0?(r$jscomp$0=Xl.call(this,e),l$jscomp$0=Yl.call(this,e),(r$jscomp$0.length||l$jscomp$0.length)&&Dl.call(this,"insertEmptyItems")):"undo"==t$jscomp$0?(r$jscomp$0.length&&(h$jscomp$0=xl.call(this,r$jscomp$0)),l$jscomp$0.length&&(a=wl.call(this,l$jscomp$0))):"redo"==t$jscomp$0&&(h$jscomp$0.length&&Cl.call(this,h$jscomp$0),a.length&&bl.call(this,a),(r$jscomp$0.length||l$jscomp$0.length)&&Dl.call(this,"insertEmptyItems"));i$jscomp$0.call(this);null!=s&&(o$jscomp$0=Ur.call(this));
var c=0,d=function(){var t=performance.now(),i=[],o=e.colIds,r=[];if(null!=s){do{i.push(e.rowIds[c]);r.push(e.values[c]);for(var l=[],h=0;h<o.length;h++)l.push(this._cellStore[e.rowIds[c]-1][o[h]-1].value||null);n.push(l);c++}while(c<=e.rowIds.length-1&&25>performance.now()-t)}else{do i.push(e.rowIds[c]),r.push(e.values[c]),c++;while(c<=e.rowIds.length-1&&25>performance.now()-t)}for(t=0;t<i.length;t++)for(l=0;l<o.length;l++)void 0!==r[t][l]&&(h=this._cellStore[i[t]-1][o[l]-1],h.value=r[t][l],h._found=
!1);Dl.call(this,"setCellValues");this.redraw();c<e.rowIds.length-1?setTimeout(d,75):(this.events.dispatch("setcellvalues",e),null!=s&&s.call(this))}.bind(this);d()}};c$jscomp$0.call(this,"do",t$jscomp$1,i$jscomp$1,e$jscomp$0?function(){var e=go(t$jscomp$1);e.values=n;this.undoManager.add({desc:"setCellValues",undo:function(){c$jscomp$0.call(this,"undo",e,function(){Pl.call(this,s$jscomp$0)})},redo:function(){c$jscomp$0.call(this,"redo",t$jscomp$1,function(){Pl.call(this,o$jscomp$0)})}})}:null)}function Wl(t,
e,i,o){if(void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=!1),void 0===o&&(o=!1),null!=t){t=al.call(this,cl(t));var r=o?ul.call(this,t,e,i,this.constructor._clipboardObject.cellRange):ul.call(this,t,e,i);Vl.call(this,r,!0,i?function(){Il.call(this,r.selection)}:function(){})}}function Kl(t,e$jscomp$0,i){Ki.call(this,"fill",null);var o$jscomp$0=this.getCellRangeData(t),n=[];if("right"==e$jscomp$0)for(var r=0;r<o$jscomp$0.length;r++)n.push({series:o$jscomp$0[r]});else if("left"==e$jscomp$0)for(r=
0;r<o$jscomp$0.length;r++)n.push({series:o$jscomp$0[r].reverse()});else if("down"==e$jscomp$0)for(r=0;r<o$jscomp$0[0].length;r++){for(var h=[],a=0;a<o$jscomp$0.length;a++)h.push(o$jscomp$0[a][r]);n.push({series:h})}else if("up"==e$jscomp$0)for(r=0;r<o$jscomp$0[0].length;r++){h=[];for(a=0;a<o$jscomp$0.length;a++)h.push(o$jscomp$0[a][r]);n.push({series:h.reverse()})}if(jl(n),"right"==e$jscomp$0)var c=[{x:t[1].x+1,y:t[0].y},{x:Math.min(this._cols.coordList.length-1,t[1].x+i),y:t[1].y}];else"left"==e$jscomp$0?
c=[{x:Math.max(0,t[0].x-i),y:t[0].y},{x:t[0].x-1,y:t[1].y}]:"down"==e$jscomp$0?c=[{x:t[0].x,y:t[1].y+1},{x:t[1].x,y:Math.min(this._rows.coordList.length-1,t[1].y+i)}]:"up"==e$jscomp$0&&(c=[{x:t[0].x,y:Math.max(0,t[0].y-i)},{x:t[1].x,y:t[0].y-1}]);i=c[1].y-c[0].y+1;o$jscomp$0=c[1].x-c[0].x+1;h=[];if("right"==e$jscomp$0)for(a=0;a<i;a++)for(h.push([]),r=0;r<o$jscomp$0;r++){var f=1+Math.floor(r/n[a].groups.length);e$jscomp$0=r%n[a].groups.length;s$jscomp$8(n[a].groups[e$jscomp$0])?(f=e$jscomp$0-n[a].groups[e$jscomp$0].startIndex+
n[a].groups[e$jscomp$0].size*f,e$jscomp$0=n[a].groups[e$jscomp$0].base+f*n[a].groups[e$jscomp$0].increment,e$jscomp$0=Math.round(100*e$jscomp$0)/100,h[a].push(e$jscomp$0)):h[a].push(n[a].groups[e$jscomp$0])}else if("left"==e$jscomp$0)for(a=0;a<i;a++)for(h.push([]),r=0;r<o$jscomp$0;r++)f=1+Math.floor(r/n[a].groups.length),e$jscomp$0=r%n[a].groups.length,s$jscomp$8(n[a].groups[e$jscomp$0])?(f=e$jscomp$0-n[a].groups[e$jscomp$0].startIndex+n[a].groups[e$jscomp$0].size*f,e$jscomp$0=n[a].groups[e$jscomp$0].base+
f*n[a].groups[e$jscomp$0].increment,e$jscomp$0=Math.round(100*e$jscomp$0)/100,h[a].unshift(e$jscomp$0)):h[a].unshift(n[a].groups[e$jscomp$0]);else if("down"==e$jscomp$0)for(a=0;a<i;a++)for(h.push([]),r=0;r<o$jscomp$0;r++)f=1+Math.floor(a/n[r].groups.length),e$jscomp$0=a%n[r].groups.length,s$jscomp$8(n[r].groups[e$jscomp$0])?(f=e$jscomp$0-n[r].groups[e$jscomp$0].startIndex+n[r].groups[e$jscomp$0].size*f,e$jscomp$0=n[r].groups[e$jscomp$0].base+f*n[r].groups[e$jscomp$0].increment,e$jscomp$0=Math.round(100*
e$jscomp$0)/100,h[a].push(e$jscomp$0)):h[a].push(n[r].groups[e$jscomp$0]);else if("up"==e$jscomp$0)for(a=0;a<i;a++)for(h.unshift([]),r=0;r<o$jscomp$0;r++)f=1+Math.floor(a/n[r].groups.length),e$jscomp$0=a%n[r].groups.length,s$jscomp$8(n[r].groups[e$jscomp$0])?(f=e$jscomp$0-n[r].groups[e$jscomp$0].startIndex+n[r].groups[e$jscomp$0].size*f,e$jscomp$0=n[r].groups[e$jscomp$0].base+f*n[r].groups[e$jscomp$0].increment,e$jscomp$0=Math.round(100*e$jscomp$0/100),h[0].push(e$jscomp$0)):h[0].push(n[r].groups[e$jscomp$0]);
var m=ul.call(this,[{type:"cell",range:c}],h,!1);Vl.call(this,m,!0,function(){var e=Io(this._cellCursorPosition,t)?this._cellCursorPosition:null,o;Il.call(this,[{type:"cell",range:(o=m.selection[0].range,[{x:Math.min(t[0].x,t[1].x,o[0].x,o[1].x),y:Math.min(t[0].y,t[1].y,o[0].y,o[1].y)},{x:Math.max(t[0].x,t[1].x,o[0].x,o[1].x),y:Math.max(t[0].y,t[1].y,o[0].y,o[1].y)}])}],e)})}function Ul(t){var o;i$jscomp$20(t)?o=t:e$jscomp$22(t)?o=[t]:d$jscomp$2(t)&&(o=[[t,t]]);t=[];for(var n=0;n<o.length;n++)t.push({range:ir.call(this,
o[n]),type:"col"});return t}function ql(t$jscomp$0){var e=this;if(void 0===t$jscomp$0&&(t$jscomp$0=null),null==t$jscomp$0)return[];t$jscomp$0=al.call(this,Ul.call(this,t$jscomp$0));for(var o=new Set,s=0;s<t$jscomp$0.length;s++)for(var n=this.getColIndexByCoord(t$jscomp$0[s].range[0].x),r=this.getColIndexByCoord(t$jscomp$0[s].range[1].x);n<=r;n++)o.add(this._cols.indexList[n]);return Array.from(o).sort(function(t,i){return e._cols.indexList.indexOf(t)-e._cols.indexList.indexOf(i)})}function Ql(t){for(var e=
[],i=0;i<t.length;i++)e.push(t[i]);return e}function Jl(t,e,i,o){void 0===i&&(i=!0);void 0===o&&(o=function(){});t={amount:t,targetId:e};if(this.events.dispatch("beforeinsertcols",t)){var n=Ur.call(this),r=vl.call(this,t.amount,t.targetId);Dl.call(this,"insertEmptyCols");o.call(this,r);this.redraw();var l,h=Ur.call(this);i&&this.undoManager.add({desc:"insertCols",undo:function(){l=xl.call(this,r);Dl.call(this,"deleteCols");Pl.call(this,n);this.redraw()},redo:function(){Cl.call(this,l);Dl.call(this,
"restoreDeletedCols");Pl.call(this,h);this.redraw()}});t.insertedIds=Ql(r);this.events.dispatch("insertcols",t)}}function eh(t$jscomp$0,e){var i=(void 0===t$jscomp$0&&(t$jscomp$0=1),void 0===e&&(e=this._cols.coordList.length),0==(e=$o(e,0,this._cols.coordList.length)))?0:this._cols.coordList[Math.min(this._cols.coordList.length,e)-1];Jl.call(this,t$jscomp$0,i,!0,function(t){var JSCompiler_temp_const=this.setColSelection;e$jscomp$22(t)||(t=[t,t]);var o=t[t.length-1];t=[this._cols.coordList.indexOf(t[0]),
this._cols.coordList.indexOf(o)];JSCompiler_temp_const.call(this,t)})}function ih(t,e){void 0===t&&(t="rows");for(var i,o=[],s=0;s<e.length;s++)o.push(this["_"+t].coordList.indexOf(e[s]));o.sort();t=[];e=[];for(s=0;s<o.length;s++)o[s]==i+1||0==s?e.push(o[s]):(t.push(e),e=[o[s]]),i=o[s];return t.push(e),t}function oh(t){for(var e=[],i=0;i<t.length;i++)e.push([t[i][0],t[i][t[i].length-1]]);return e}function sh(t){for(var e=[],i=0;i<t.length;i++){var o=this._cols.indexList.indexOf(t[i].id);o=(e.push({id:t[i].id,
afterId:this._cols.indexList[o-1]||null}),this._cols.indexList.splice(o,1),t[i].afterId)?this._cols.indexList.indexOf(t[i].afterId)+1:0;this._cols.indexList.splice(o,0,t[i].id)}return e.reverse()}function nh(t,e,i,o){void 0===i&&(i=!0);void 0===o&&(o=function(){});t={colIds:t,targetId:e};if(this.events.dispatch("beforemovecols",t)){var r=rh(t.colIds,t.targetId),l=Ur.call(this);var n=sh.call(this,r);Dl.call(this,"moveCols");o.call(this);this.redraw();var h=Ur.call(this);i&&this.undoManager.add({desc:"moveCols",
undo:function(){sh.call(this,n);Dl.call(this,"moveCols");Pl.call(this,l);this.redraw()},redo:function(){sh.call(this,r);Dl.call(this,"moveCols");Pl.call(this,h);this.redraw()}});this.events.dispatch("movecols",t)}}function lh(t,e){if(void 0===t&&(t=null),void 0===e&&(e=null),null!=t&&null!=e){var i=ql.call(this,t);(e=$o(e,0,this._cols.coordList.length),hh.call(this,i,e))?(t=0==e?0:this._cols.coordList[e-1],-1<i.indexOf(t)||nh.call(this,i,t,!0,function(){this.setColSelection(oh(ih.call(this,"cols",
i)))})):this.alertUser("Cannot move columns in or out of the frozen section. Try turning off frozen columns first.")}}function ch(t,e){for(var i=0;i<t.length;i++)void 0!==e[i]&&(this._cols.store[t[i]-1].width=1*Math.round(Math.max(e[i],32)/1));for(i=0;i<t.length;i++)this._columnNodes[t[i]-1].column.style.width=e[i]+"px"}function dh(t,e,i,o){void 0===i&&(i=!0);void 0===o&&(o=function(){});var s={colIds:t,widths:e};if(this.events.dispatch("beforeresizecols",s)){var n=Ur.call(this),r=[];for(t=0;t<s.colIds.length;t++)r.push(this._cols.store[s.colIds[t]-
1].width);ch.call(this,s.colIds,s.widths);Dl.call(this,"resizeCols");o.call(this);this.redraw();var h=Ur.call(this);i&&this.undoManager.add({desc:"resizeCols",undo:function(){ch.call(this,s.colIds,r);Dl.call(this,"resizeCols");Pl.call(this,n);this.redraw()},redo:function(){ch.call(this,s.colIds,s.widths);Dl.call(this,"resizeCols");Pl.call(this,h);this.redraw()}});this.events.dispatch("resizecols",s)}}function fh(t,e,i){void 0===e&&(e=!0);void 0===i&&(i=function(){});var o={colIds:t};if(this.events.dispatch("beforedeletecols",
o)){var s=this._freezeLineColAfterId,n=Ur.call(this),r=xl.call(this,o.colIds);gh.call(this);Dl.call(this,"deleteCols");i.call(this);this.redraw();var l=Ur.call(this);e&&this.undoManager.add({desc:"deleteCols",undo:function(){Cl.call(this,r);this._freezeLineColAfterId=s;Dl.call(this,"restoreDeletedCols");Pl.call(this,n);this.redraw()},redo:function(){xl.call(this,o.colIds);gh.call(this);Dl.call(this,"deleteCols");Pl.call(this,l);this.redraw()}});this.events.dispatch("deletecols",o)}}function yh(t,
e){void 0===t&&(t="rows");e=ih.call(this,t,e);for(var o=new Set,s=0;s<e.length;s++){var n=e[s][e[s].length-1];n+1>this["_"+t].coordList.length-1?o.add(this["_"+t].coordList[n-1]):o.add(this["_"+t].coordList[n+1])}return Array.from(o)}function vh(t$jscomp$0){if(t$jscomp$0.length!=this._cols.coordList.length)if(JSON.stringify(t$jscomp$0)!=JSON.stringify(this._cols.indexSections[1])){var e=yh.call(this,"cols",t$jscomp$0);fh.call(this,t$jscomp$0,!0,function(){for(var t=[],i=0;i<e.length;i++)t.push({range:[{x:this.getColCoordById(e[i]),
y:0},{x:this.getColCoordById(e[i]),y:this._rows.coordList.length-1}],type:"col"});Il.call(this,t)})}else this.alertUser("Cannot delete all non-frozen columns.");else this.alertUser("Cannot delete all columns.")}function xh(t,e,i){void 0===e&&(e=!0);void 0===i&&(i=function(){});var o={colId:t};if(this.events.dispatch("beforefreezecols",o)){var s=this._freezeLineColAfterId,n=Ur.call(this);this._preventFrozenCols||(this._freezeLineColAfterId=o.colId);Dl.call(this,"freezeCols");i.call(this);this.redraw();
var r=Ur.call(this);e&&this.undoManager.add({desc:"freezeCols",undo:function(){this._preventFrozenCols||(this._freezeLineColAfterId=s);Dl.call(this,"freezeCols");Pl.call(this,n);this.redraw()},redo:function(){this._preventFrozenCols||(this._freezeLineColAfterId=o.colId);Dl.call(this,"freezeCols");Pl.call(this,r);this.redraw()}});this.events.dispatch("freezecols",o)}}function Ch(t){for(var e=0;e<t.length;e++)this._cols.store[t[e]-1]._hide=!0}function bh(t){for(var e=0;e<t.length;e++)this._cols.store[t[e]-
1]._hide=!1}function Sh(t,e,i){void 0===e&&(e=!0);void 0===i&&(i=function(){});var o={colIds:t};if(this.events.dispatch("beforehidecols",o)){var s=Ur.call(this);Ch.call(this,o.colIds);Dl.call(this,"hideCols");i.call(this);this.redraw();var n=Ur.call(this);e&&this.undoManager.add({desc:"hideCols",undo:function(){bh.call(this,o.colIds);Dl.call(this,"showCols");Pl.call(this,s);this.redraw()},redo:function(){Ch.call(this,o.colIds);Dl.call(this,"hideCols");Pl.call(this,n);this.redraw()}});this.events.dispatch("hidecols",
o)}}function Ih(t$jscomp$0){if(t$jscomp$0.length!=this._cols.coordList.length){var e=yh.call(this,"cols",t$jscomp$0);Sh.call(this,t$jscomp$0,!0,function(){for(var t=[],i=0;i<e.length;i++)t.push({range:[{x:this.getColCoordById(e[i]),y:0},{x:this.getColCoordById(e[i]),y:this._rows.coordList.length-1}],type:"col"});Il.call(this,t)})}else this.alertUser("Cannot hide all columns.")}function Rh(t,e,i){void 0===e&&(e=!0);void 0===i&&(i=function(){});var o={colIds:t};if(this.events.dispatch("beforeshowcols",
o)){var s=Ur.call(this);bh.call(this,o.colIds);Dl.call(this,"showCols");i.call(this);this.redraw();var n=Ur.call(this);e&&this.undoManager.add({desc:"showCols",undo:function(){Ch.call(this,o.colIds);Dl.call(this,"hideCols");Pl.call(this,s);this.redraw()},redo:function(){bh.call(this,o.colIds);Dl.call(this,"showCols");Pl.call(this,n);this.redraw()}});this.events.dispatch("showcols",o)}}function Lh(t){Rh.call(this,t,!0,function(){this.setColSelection(oh(ih.call(this,"cols",t)))})}function Ph(t){var o;
i$jscomp$20(t)?o=t:e$jscomp$22(t)?o=[t]:d$jscomp$2(t)&&(o=[[t,t]]);t=[];for(var n=0;n<o.length;n++)t.push({range:or.call(this,o[n]),type:"row"});return t}function Nh(t$jscomp$0){var e=this;if(void 0===t$jscomp$0&&(t$jscomp$0=null),null==t$jscomp$0)return[];t$jscomp$0=al.call(this,Ph.call(this,t$jscomp$0));for(var o=new Set,s=0;s<t$jscomp$0.length;s++)for(var n=this.getRowIndexByCoord(t$jscomp$0[s].range[0].y),r=this.getRowIndexByCoord(t$jscomp$0[s].range[1].y);n<=r;n++)o.add(this._rows.indexList[n]);
return Array.from(o).sort(function(t,i){return e._rows.indexList.indexOf(t)-e._rows.indexList.indexOf(i)})}function Ah(t,e,i,o){void 0===i&&(i=!0);void 0===o&&(o=function(){});t={amount:t,targetId:e};if(this.events.dispatch("beforeinsertrows",t)){var n=Ur.call(this),r=ml.call(this,t.amount,t.targetId);Dl.call(this,"insertEmptyRows");o.call(this,r);this.redraw();var l,h=Ur.call(this);i&&this.undoManager.add({desc:"insertRows",undo:function(){l=wl.call(this,r);Dl.call(this,"deleteRows");Pl.call(this,
n);this.redraw()},redo:function(){bl.call(this,l);Dl.call(this,"restoreDeletedRows");Pl.call(this,h);this.redraw()}});t.insertedIds=Ql(r);this.events.dispatch("insertrows",t)}}function Fh(t$jscomp$0,e){var i=(void 0===t$jscomp$0&&(t$jscomp$0=1),void 0===e&&(e=this._rows.coordList.length),0==(e=$o(e,0,this._rows.coordList.length)))?0:this._rows.coordList[e-1];Ah.call(this,t$jscomp$0,i,!0,function(t){var JSCompiler_temp_const=this.setRowSelection;e$jscomp$22(t)||(t=[t,t]);var o=t[t.length-1];t=[this._rows.coordList.indexOf(t[0]),
this._rows.coordList.indexOf(o)];JSCompiler_temp_const.call(this,t)})}function Eh(t){for(var e=[],i=0;i<t.length;i++){var o=this._rows.indexList.indexOf(t[i].id);o=(e.push({id:t[i].id,afterId:this._rows.indexList[o-1]||null}),this._rows.indexList.splice(o,1),t[i].afterId)?this._rows.indexList.indexOf(t[i].afterId)+1:0;this._rows.indexList.splice(o,0,t[i].id)}return e.reverse()}function Mh(t,e,i,o){void 0===i&&(i=!0);void 0===o&&(o=function(){});t={rowIds:t,targetId:e};if(this.events.dispatch("beforemoverows",
t)){var r=Bh(t.rowIds,t.targetId),l=Ur.call(this);var n=Eh.call(this,r);Dl.call(this,"moveRows");o.call(this);this.redraw();var h=Ur.call(this);i&&this.undoManager.add({desc:"moveRows",undo:function(){Eh.call(this,n);Dl.call(this,"moveRows");Pl.call(this,l);this.redraw()},redo:function(){Eh.call(this,r);Dl.call(this,"moveRows");Pl.call(this,h);this.redraw()}});this.events.dispatch("moverows",t)}}function Oh(t,e){if(void 0===t&&(t=null),void 0===e&&(e=null),null!=t&&null!=e){var i=Nh.call(this,t);
(e=$o(e,0,this._rows.coordList.length),Dh.call(this,i,e))?(t=0==e?0:this._rows.coordList[e-1],-1<i.indexOf(t)||Mh.call(this,i,t,!0,function(){this.setRowSelection(oh(ih.call(this,"rows",i)))})):this.alertUser("Cannot move rows in or out of the frozen section. Try turning off frozen rows first.")}}function Vh(t,e,i){void 0===e&&(e=!0);void 0===i&&(i=function(){});var o={rowIds:t};if(this.events.dispatch("beforedeleterows",o)){var s=this._freezeLineRowAfterId,n=Ur.call(this),r=wl.call(this,o.rowIds);
Xh.call(this);Dl.call(this,"deleteRows");i.call(this);this.redraw();var l=Ur.call(this);e&&this.undoManager.add({desc:"deleteRows",undo:function(){bl.call(this,r);this._freezeLineRowAfterId=s;Dl.call(this,"restoreDeletedRows");Pl.call(this,n);this.redraw()},redo:function(){wl.call(this,o.rowIds);Xh.call(this);Dl.call(this,"deleteRows");Pl.call(this,l);this.redraw()}});this.events.dispatch("deleterows",o)}}function Wh(t$jscomp$0){if(t$jscomp$0.length!=this._rows.indexList.length)if(JSON.stringify(t$jscomp$0)!=
JSON.stringify(this._rows.indexSections[1])){var e=yh.call(this,"rows",t$jscomp$0);Vh.call(this,t$jscomp$0,!0,function(){for(var t=[],i=0;i<e.length;i++)t.push({range:[{x:0,y:this.getRowCoordById(e[i])},{x:this._cols.coordList.length-1,y:this.getRowCoordById(e[i])}],type:"row"});Il.call(this,t)})}else this.alertUser("Cannot delete all non-frozen rows.");else this.alertUser("Cannot delete all rows.")}function jh(t,e,i){void 0===e&&(e=!0);void 0===i&&(i=function(){});var o={rowId:t};if(this.events.dispatch("beforefreezerows",
o)){var s=this._freezeLineRowAfterId,n=Ur.call(this);this._preventFrozenRows||(this._freezeLineRowAfterId=o.rowId);Dl.call(this,"freezeRows");i.call(this);this.redraw();var r=Ur.call(this);e&&this.undoManager.add({desc:"freezeRows",undo:function(){this._preventFrozenRows||(this._freezeLineRowAfterId=s);Dl.call(this,"freezeRows");Pl.call(this,n);this.redraw()},redo:function(){this._preventFrozenRows||(this._freezeLineRowAfterId=o.rowId);Dl.call(this,"freezeRows");Pl.call(this,r);this.redraw()}});this.events.dispatch("freezerows",
o)}}function qh(t){for(var e=0;e<t.length;e++)this._rows.store[t[e]-1]._hide=!0}function Gh(t){for(var e=0;e<t.length;e++)this._rows.store[t[e]-1]._hide=!1}function Zh(t,e,i){void 0===e&&(e=!0);void 0===i&&(i=function(){});var o={rowIds:t};if(this.events.dispatch("beforehiderows",o)){var s=Ur.call(this);qh.call(this,o.rowIds);Dl.call(this,"hideRows");i.call(this);this.redraw();var n=Ur.call(this);e&&this.undoManager.add({desc:"hideRows",undo:function(){Gh.call(this,o.rowIds);Dl.call(this,"showRows");
Pl.call(this,s);this.redraw()},redo:function(){qh.call(this,o.rowIds);Dl.call(this,"hideRows");Pl.call(this,n);this.redraw()}});this.events.dispatch("hiderows",o)}}function $h(t$jscomp$0){if(t$jscomp$0.length!=this._rows.coordList.length){var e=yh.call(this,"rows",t$jscomp$0);Zh.call(this,t$jscomp$0,!0,function(){for(var t=[],i=0;i<e.length;i++)t.push({range:[{x:0,y:this.getRowCoordById(e[i])},{x:this._cols.coordList.length-1,y:this.getRowCoordById(e[i])}],type:"row"});Il.call(this,t)})}else this.alertUser("Cannot hide all rows.")}
function Qh(t,e,i){void 0===e&&(e=!0);void 0===i&&(i=function(){});var o={rowIds:t};if(this.events.dispatch("beforeshowrows",o)){var s=Ur.call(this);Gh.call(this,o.rowIds);Dl.call(this,"showRows");i.call(this);this.redraw();var n=Ur.call(this);e&&this.undoManager.add({desc:"showRows",undo:function(){qh.call(this,o.rowIds);Dl.call(this,"hideRows");Pl.call(this,s);this.redraw()},redo:function(){Gh.call(this,o.rowIds);Dl.call(this,"showRows");Pl.call(this,n);this.redraw()}});this.events.dispatch("showrows",
o)}}function Jh(t){Qh.call(this,t,!0,function(){this.setRowSelection(oh(ih.call(this,"rows",t)))})}function na(t){if(!this._sortState.length){this._rowOrderStore=[];for(var e=0;e<this._rows.indexList.length;e++)this._rowOrderStore[this._rows.indexList[e]-1]=this._rows.indexList.length-e}var i,o=[],s={};for(e=this._rows.coordSections[0].length;e<this._rows.indexList.length;e++)if(this._rows.store[this._rows.indexList[e]-1]._hide)s[e]=this._rows.indexList[e];else{for(var n=[],r=0;r<t.length;r++)null===
(i=this._cellStore[this._rows.indexList[e]-1][t[r][0]-1].value)&&(i=""),n.push(String(i));o.push([this._rows.indexList[e],n]);i="";for(r=0;r<t.length;r++)i+=t[r].join("-"),r<t.length-1&&(i+="_");if(!(i in this._sortFunctions)){r="return ";for(n=0;n<t.length;n++)0<n&&(r+="||"),r+="(\n      a[1]["+n+"] \x3d\x3d\x3d b[1]["+n+"] ? 0 : (\n        a[1]["+n+"] \x3d\x3d '' ? 1 : (\n          b[1]["+n+"] \x3d\x3d '' ? -1 : (","asc"==t[n][1]?r+="a[1]["+n+"].localeCompare(b[1]["+n+"], undefined, { numeric: true, sensitivity: 'base' })":
"desc"==t[n][1]&&(r+="b[1]["+n+"].localeCompare(a[1]["+n+"], undefined, { numeric: true, sensitivity: 'base' })"),r+="))))";this._sortFunctions[i]=new Function("a,b",r+";")}}o.sort(this._sortFunctions[i]);e=[];for(r=0;r<this._rows.coordSections[0].length;r++)e.push(this._rows.coordSections[0][r]);for(r=0;r<o.length;r++)e.push(o[r][0]);for(var c in s)e.splice(c,0,s[c]);this._rows.indexList=e;this._sortState=t}function ha(t$jscomp$0,e$jscomp$0,i$jscomp$0){void 0===e$jscomp$0&&(e$jscomp$0=!0);void 0===
i$jscomp$0&&(i$jscomp$0=function(){});var o={sortState:t$jscomp$0};if(this.events.dispatch("beforesort",o)){var s=this._sortState.slice(0),n=Ur.call(this);na.call(this,o.sortState);Dl.call(this,"sort");i$jscomp$0.call(this);this.redraw();var r=Ur.call(this);e$jscomp$0&&this.undoManager.add({desc:"sort",undo:function(){if(s.length)na.call(this,s);else{for(var t,e=[],i=0;i<this._rows.indexList.length;i++)t=this._rowOrderStore[this._rows.indexList[i]-1]||0,e.push([this._rows.indexList[i],t]);e.sort(this._sortFunctions.reset);
t=[];for(i=0;i<e.length;i++)t.push(e[i][0]);this._rows.indexList=t}Dl.call(this,"sort");Pl.call(this,n);this.redraw()},redo:function(){na.call(this,o.sortState);Dl.call(this,"sort");Pl.call(this,r);this.redraw()}});this.events.dispatch("sort",o)}}function aa(t,e,i){if(void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=!1),null!=t){t=this._cols.coordList[t];var s="asc",n=(null==e?this._sortState.length&&this._sortState[0][0]==t&&(s="asc"==this._sortState[0][1]?"desc":"asc"):s=e,i&&!ca.call(this,
t))?this._sortState:[];n.push([t,s]);ha.call(this,n,!0,function(){})}}function Fa(){var t=document.createElement("textArea");t.value=" all";t.setAttribute("readonly",!0);t.addEventListener("copy",this._domNodes.component._listeners.clipboardNode.events.copy);document.body.appendChild(t);var e=document.createRange();e.selectNodeContents(t);var i=window.getSelection();i.removeAllRanges();i.addRange(e);t.setSelectionRange(0,999999);document.execCommand("copy");document.body.removeChild(t)}function Ba(){var t$jscomp$0=
this;"clipboard"in navigator&&"function"==typeof navigator.clipboard.readText?navigator.clipboard.readText().then(function(e){""!=e&&Zi.call(t$jscomp$0,{text:e},null)}).catch(function(t){}):this.isIE?document.execCommand("paste"):this.alertUser("Paste not available.")}function ec(){var t=this;requestAnimationFrame(function(){Lr.call(t);t._prevSelection=Ur.call(t)})}function ic(){var t=this,e=this._cd.componentHeight,i=this._cd.componentWidth,o=!1,s=!1;Xt.call(this);kl.call(this);this._isFullscreen&&
i==this._cd.componentWidth&&e>this._cd.componentHeight+200?o=!0:this._isFullscreen&&i==this._cd.componentWidth&&this._cd.componentHeight>e+200&&(s=!0);s||o||tn.call(this,{x:this._panesXids.left.length,y:this._panesYids.top.length});requestAnimationFrame(function(){Lr.call(t)});this.events.dispatch("resize",{width:this._cd.componentWidth,height:this._cd.componentHeight})}function zc(t){var JSCompiler_object_inline_right_3380=this._cols.coordList.length-1,o=t>JSCompiler_object_inline_right_3380;return 0>
t&&(t=0),o&&(t=JSCompiler_object_inline_right_3380),t}function Bc(t){var JSCompiler_object_inline_bottom_3382=this._rows.coordList.length-1,o=t>JSCompiler_object_inline_bottom_3382;return 0>t&&(t=0),o&&(t=JSCompiler_object_inline_bottom_3382),t}var t$jscomp$20=["optimizeSpeed","-moz-crisp-edges","-webkit-optimize-contrast","optimize-contrast","pixelated"],F$jscomp$0=function(t,e){if(void 0===e&&(e=null),null==t)return null;var i="",o=[];if("name"in t){o=t.name.split(" ");for(var s=0;s<o.length;s++)i+=
"dgxl-"+o[s].replace(".","-"),s<o.length-1&&(i+=" ");t.class=i}i=H(t.tag||"div",t);if("domNodes"in t&&t.domNodes.length&&A$jscomp$0(i,t.domNodes),"children"in t&&t.children.length){var r=[];for(s=0;s<t.children.length;s++)"_reset"in t&&(t.children[s]._reset=t._reset),r.push(F$jscomp$0.call(this,t.children[s],e));A$jscomp$0(i,r)}null!=e&&o.length&&(t=o[0].split("."),1<t.length?(t[0]in e||(e[t[0]]={}),e[t[0]][t[1]]=i):e[o[0]]=i);return i},Y={".dgxl-component":function(){return{"background-color":this.getThemeSetting("component")}},
".dgxl-bar":function(){return{"column-gap":"6px",padding:"6px"}},".dgxl-inputWrapper":function(){return{display:"flex","flex-grow":1,position:"relative","border-width":"1px","border-style":"solid","border-color":this.getThemeSetting("input|border"),"border-radius":"4px",background:this.getThemeSetting("input")}},".dgxl-inputWrapper.dgxl-hasFocus":function(){return{"box-shadow":"inset 0 0 0 1px "+this.getThemeSetting("input:focus|border"),"border-color":this.getThemeSetting("input:focus|border")}},
"reset|.dgxl-inputWrapper.dgxl-hasFocus":function(){return{"box-shadow":"","border-color":this.getThemeSetting("input|border")}},".dgxl-inputField":function(){return{border:"none",outline:"none",width:"100%",position:"relative","background-color":"transparent",height:"100%","box-sizing":"border-box",padding:"0 6px",color:this.getThemeSetting("input|text")}},".dgxl-part button":function(){var t={"box-sizing":"border-box","background-color":this.getThemeSetting("button"),"border-color":"transparent",
"border-style":"solid","border-width":"1px","border-radius":"4px",color:"#0f1111",cursor:"pointer",display:"flex","align-items":"center","justify-content":"center","font-family":"sans-serif",overflow:"hidden",padding:"0 6px","text-align":"center","text-decoration":"none","touch-action":"manipulation","white-space":"nowrap","min-width":"32px","flex-grow":0,height:"100%"};return"button"in this.theme||(t["background-image"]="linear-gradient(#f7f8fa ,#e7e9ec)",t["border-color"]="#adb1b8 #a2a6ac #8d9096"),
t},".dgxl-part button svg":function(){return{fill:this.getThemeSetting("button-icon")}},".dgxl-inputInfo":function(){return{position:"absolute",top:"50%",right:"6px",color:this.getThemeSetting("input-info"),transform:"translateY(-50%)","font-size":this.fontSize+2+"px"}},".dgxl-contextMenuItemList":function(){return{"border-radius":"4px","list-style":"none",margin:0,padding:"var(--dgxl-contextmenu-verticalpadding) 1px","background-color":this.getThemeSetting("contextmenu"),color:this.getThemeSetting("contextmenu|text"),
"font-size":"14px","box-shadow":"0 0 4px var(--dgxl-contextmenu-shadowcolor)"}},".dgxl-contextMenuItem":function(){return{height:"var(--dgxl-contextmenu-itemheight)","line-height":"var(--dgxl-contextmenu-itemheight)",padding:"0 10px",position:"relative"}},".dgxl-contextMenuItem-highlight":function(){return{"background-color":this.getThemeSetting("contextmenu-item:highlight")}},"reset|.dgxl-contextMenuItem-highlight":function(){return{"background-color":""}},".dgxl-contextMenuItemShortcutLabel":function(){return{position:"absolute",
right:"10px",top:0,color:this.getThemeSetting("contextmenu-item-shortcut"),"font-size":"smaller"}}},U=function(t,e){void 0===t&&(t=null);this._domNodes={};this._offsetY=this._offsetX=4;this._context=this._cursorIndex=this._prevCursorIndex=null;this._isOpen=!1;this.dimensions={width:240,verticalPadding:6,itemHeight:30};this._selectItemCallback=function(){};this._closeCallback=function(){};this.items=[];this._domNodes.containerNode=t};U.prototype.isOpen=function(){return this._isOpen};U.prototype.open=
function(t$jscomp$0,e,i,o,s,n){this._isOpen=!0;this.items=e;this._context=t$jscomp$0;this._selectItemCallback=s;this._closeCallback=n;s="--dgxl-contextmenu-shadowcolor: "+j(this._context.getThemeSetting("sheet"),"rgba(255,255,255,.35)","rgba(0,0,0,.35)")+";--dgxl-contextmenu-verticalpadding: "+this.dimensions.verticalPadding+"px;";s+=k$jscomp$0(Y[".dgxl-contextMenuItemList"].call(this._context));t$jscomp$0="--dgxl-contextmenu-itemheight: "+this.dimensions.itemHeight+"px;";t$jscomp$0+=k$jscomp$0(Y[".dgxl-contextMenuItem"].call(this._context));
e=k$jscomp$0(Y[".dgxl-contextMenuItemShortcutLabel"].call(this._context));s='\x3cul class\x3d"dgxl-contextMenuItemList" style\x3d"'+s+'"\x3e';for(n=0;n<this.items.length;n++){var d="dgxl-contextMenuItem",u="",p=!1;"disabled"in this.items[n]&&this.items[n].disabled.call(this._context)?(d+=" "+d+"-disabled",u+="opacity:0.25;",p=!0):u+="cursor:pointer;";s+='\x3cli class\x3d"'+d+'" style\x3d"'+(t$jscomp$0+u)+'"';s+=p?' data-disabled\x3d"true"':' data-disabled\x3d"false"';s+="\x3e";d="function"==typeof this.items[n].label?
this.items[n].label.call(this._context):this.items[n].label;s+='\x3cdiv class\x3d"dgxl-contextMenuItemLabel"\x3e'+this._context.getLocaleSetting(d)+"\x3c/div\x3e";"shortcut"in this.items[n]&&(s+='\x3cdiv class\x3d"dgxl-contextMenuItemShortcutLabel" style\x3d"'+e+'"\x3e'+this.items[n].shortcut+"\x3c/div\x3e");s+="\x3c/li\x3e"}s+="\x3c/ul\x3e";Q.call(this,window,i,o);this._domNodes.containerNode.innerHTML=s;this._domNodes.containerNode.style.display="block";this.setCursor(-1);"_mouseDownListener"in
this._domNodes.containerNode||(this._domNodes.containerNode._mouseDownListener=function(t){this._domNodes.containerNode.contains(t.target)?0==t.button&&(t=K(t.target,"dgxl-contextMenuItem"),t=null==t?-1:W(t),this.hit(t)):this.close()}.bind(this));"_contextMenuListener"in this._domNodes.containerNode||(this._domNodes.containerNode._contextMenuListener=function(t){t.preventDefault()});document.addEventListener("mousedown",this._domNodes.containerNode._mouseDownListener);document.addEventListener("contextmenu",
this._domNodes.containerNode._contextMenuListener);"_mouseMoveListener"in this._domNodes.containerNode||(this._domNodes.containerNode._mouseMoveListener=function(t){t=K(t.target,"dgxl-contextMenuItem");t=null==t||1==t.dataset.disabled?-1:W(t);this.setCursor(t)}.bind(this));"_mouseLeaveListener"in this._domNodes.containerNode||(this._domNodes.containerNode._mouseLeaveListener=function(t){this.setCursor(-1)}.bind(this));this._domNodes.containerNode.addEventListener("mousemove",this._domNodes.containerNode._mouseMoveListener);
this._domNodes.containerNode.addEventListener("mouseleave",this._domNodes.containerNode._mouseLeaveListener)};U.prototype.close=function(){this._closeCallback.call(this._context,{contextMenu:this})};U.prototype.execClose=function(){this._isOpen=!1;document.removeEventListener("mousedown",this._domNodes.containerNode._mouseDownListener);document.removeEventListener("contextmenu",this._domNodes.containerNode._contextMenuListener);this._domNodes.containerNode.removeEventListener("mousemove",this._domNodes.containerNode._mouseMoveListener);
this._domNodes.containerNode.removeEventListener("mouseleave",this._domNodes.containerNode._mouseLeaveListener);this.setCursor(-1);this._domNodes.containerNode.innerHTML="";this._domNodes.containerNode.style.display="none"};U.prototype.setCursor=function(t){if(t!==this._prevCursorIndex){var e=this._domNodes.containerNode;e.children.length&&(null!==this._prevCursorIndex&&-1<this._prevCursorIndex&&(P$jscomp$0(e.children[0].children[this._prevCursorIndex],Y["reset|.dgxl-contextMenuItem-highlight"].call(this._context)),
e.children[0].children[this._prevCursorIndex].classList.remove("dgxl-contextMenuItem-highlight")),this._cursorIndex=t,null!==this._cursorIndex&&-1<this._cursorIndex&&(P$jscomp$0(e.children[0].children[this._cursorIndex],Y[".dgxl-contextMenuItem-highlight"].call(this._context)),e.children[0].children[this._cursorIndex].classList.add("dgxl-contextMenuItem-highlight")),this._prevCursorIndex=this._cursorIndex)}};U.prototype.moveCursorDown=function(){-1==this._cursorIndex||null===this._cursorIndex||this._cursorIndex==
$.call(this,this.items.length)?this.setCursor(G.call(this,-1)):this.setCursor(G.call(this,this._cursorIndex))};U.prototype.moveCursorUp=function(){-1==this._cursorIndex||null===this._cursorIndex||0==this._cursorIndex?this.setCursor($.call(this,this.items.length)):this.setCursor($.call(this,this._cursorIndex))};U.prototype.moveCursorRight=function(){};U.prototype.moveCursorLeft=function(){};U.prototype.redrawLabels=function(){if(this.isOpen())for(var t=this._domNodes.containerNode.getElementsByClassName("dgxl-contextMenuItemList")[0],
e=0;e<this.items.length;e++)"function"==typeof this.items[e].label&&(t.children[e].firstChild.innerHTML=this._context.getLocaleSetting(this.items[e].label.call(this._context)))};U.prototype.triggerHit=function(){this.hit(this._cursorIndex)};U.prototype.hit=function(t){-1!=t&&this.items[t]&&("disabled"in this.items[t]&&this.items[t].disabled.call(this._context)||"method"in this.items[t]&&this._selectItemCallback.call(this._context,{contextMenu:this,index:t,item:this.items[t]}))};var G=function(t){t=
t==this.items.length-1?0:t+1;return"disabled"in this.items[t]&&this.items[t].disabled.call(this._context)?G.call(this,t):t},$=function(t){t=0==t?this.items.length-1:t-1;return"disabled"in this.items[t]&&this.items[t].disabled.call(this._context)?$.call(this,t):t},Q=function(t,e,i){void 0===t&&(t=window);var o=this._domNodes.containerNode,s=2*this.dimensions.verticalPadding+this.items.length*this.dimensions.itemHeight,n=this.dimensions.width;if(o.style.width=n+"px",t==window)var r=window.scrollY+window.innerHeight,
l=window.scrollX+window.innerWidth;else t instanceof Element&&(t=t.getBoundingClientRect(),r=Math.floor(window.scrollY+t.y+t.height),l=Math.floor(window.scrollX+t.x+t.width));i+this._offsetY+s>r?o._top=i-(s+this._offsetY):o._top=i+this._offsetY;e+this._offsetX+n>l?o._left=e-(n+this._offsetX):o._left=e+this._offsetX;o.style.top=o._top+"px";o.style.left=o._left+"px"},Lt=function(t){t=this._sectionsPerPaneY[t];for(var i=[],o=0;o<t.length;o++)i.push(this._rows.coordSections[t[o]]);return[].concat.apply([],
i)},Nt=function(t){t=this._sectionsPerPaneX[t];for(var i=[],o=0;o<t.length;o++)i.push(this._cols.coordSections[t[o]]);return[].concat.apply([],i)},Yt=function(t){this.events={};this._anyEvent="any";this._context=t};Yt.prototype.on=function(t,e){return"function"==typeof e&&"string"==typeof t&&(void 0===this.events[t]&&(this.events[t]={listeners:[]}),!(-1<this.events[t].listeners.indexOf(e))&&void this.events[t].listeners.push(e))};Yt.prototype.off=function(t$jscomp$0,e){if(void 0===this.events[t$jscomp$0])return!1;
this.events[t$jscomp$0].listeners=this.events[t$jscomp$0].listeners.filter(function(t){return t!==e})};Yt.prototype.dispatch=function(t$jscomp$0,e,i){var o=this;if(void 0===e&&(e={}),void 0===i&&(i=t$jscomp$0),t$jscomp$0!=this._anyEvent&&this.dispatch(this._anyEvent,e,t$jscomp$0),void 0===this.events[t$jscomp$0])return!0;var s=[];this.events[t$jscomp$0].listeners.forEach(function(t){s.push(t.call(o._context,e,i))});for(t$jscomp$0=0;t$jscomp$0<s.length;t$jscomp$0++)if(!1===s[t$jscomp$0])return!1;return!0};
var Kt=function(t,e){this._sharedSensorStyles={display:"block",position:"absolute",left:0,top:0,right:0,bottom:0,overflow:"auto","z-index":-1,visibility:"hidden"};this._resizeSensorStyles={overflow:"hidden"};this._expandTriggerStyles={width:"100000px",height:"100000px"};this._shrinkTriggerStyles={width:"200%",height:"200%"};this._context=e;this._domNodes={};this._domNodes.container=t;this._resizeListener;this.events=new Yt(this);this._domNodes.component=H("div",{class:"dgxl-resizeSensor",style:L$jscomp$0(this._sharedSensorStyles,
this._resizeSensorStyles)});t=document.createDocumentFragment();e=H("div",{class:"dgxl-expandSensor",style:this._sharedSensorStyles});e.appendChild(H("div",{class:"dgxl-expandTrigger",style:this._expandTriggerStyles}));var i=H("div",{class:"dgxl-shrinkSensor",style:this._sharedSensorStyles});i.appendChild(H("div",{class:"dgxl-shrinkTrigger",style:this._shrinkTriggerStyles}));t.appendChild(e);t.appendChild(i);this._domNodes.component.appendChild(t);this._domNodes.container.appendChild(this._domNodes.component);
Ut.call(this)},Ut=function(){var t$jscomp$0=this;this._resizeListener=Wt(function(e){t$jscomp$0.events.dispatch("resize",{})},100).bind(this);var i=!0,o=!0,s=this._domNodes.component.children[0],n=this._domNodes.component.children[1],r=function(t){s.scrollLeft=1E5;s.scrollTop=1E5;n.scrollLeft=1E5;n.scrollTop=1E5},l=function(e){e.target==s&&i?i=!1:e.target==n&&o?o=!1:(t$jscomp$0._resizeListener(),r())};r();s.addEventListener("scroll",l);n.addEventListener("scroll",l)},Gt=function(){for(var t,e=[],
i=0;i<this._validatedTopBar.length;i++)(t={type:this._validatedTopBar[i].name,wrapper:void 0,nodes:{}}).wrapper=T$jscomp$0.call(this,{name:"part part-"+this._validatedTopBar[i].name,style:{display:"flex","flex-grow":this._validatedTopBar[i].grow||0,height:"100%"},children:[this._validatedTopBar[i].node.call(this)],_reset:!1},t.nodes),e.push(t.wrapper),this._topBarNodes.push(t);return e},$t=function(e,i){var o=this._cd.panesX[i].space,s=this._cd.panesY[e].space;"left"==i&&(o-=this._cd.rowHeaderSpace);
"top"==e&&(s-=this._cd.colHeaderSpace);o=1*Math.ceil(o/1);s=Math.ceil(s/this.rowHeight)*this.rowHeight;return{tag:"canvas",name:"canvas."+e+"-"+i,styleText:{position:"absolute",top:0,left:0,width:o+"px",height:s+"px","image-rendering":t$jscomp$20},_panePositionY:e,_panePositionX:i,_displayWidth:o,_displayHeight:s}},re=function(){var JSCompiler_temp_const={position:"absolute",top:0,left:0,width:this._cd.viewportWidth+"px"},t=[];for(e$jscomp$0 in this._cd.panesY){var JSCompiler_temp_const$jscomp$0=
t.push,JSCompiler_temp_const$jscomp$1=JSCompiler_temp_const$jscomp$0.apply,t$jscomp$0=e$jscomp$0,e=[],i=this._cd.panesY[t$jscomp$0].offset;if("top"==t$jscomp$0){i+=this._cd.colHeaderSpace;var o=T$jscomp$0.call(this,{name:"rowLine",style:{position:"absolute",top:0,left:0,right:0,height:0,"border-bottom":"thin solid "+this.getThemeSetting("gridline-tip"),transform:"translateY("+i+"px)",opacity:1}});e.push(o)}for(var s=0;s<this._panesYids[t$jscomp$0].length;s++)i+=this.getRowHeightById(this._panesYids[t$jscomp$0][s]),
o=T$jscomp$0.call(this,{name:"rowLine",style:{position:"absolute",top:0,left:0,right:0,height:0,"border-bottom":"thin solid "+this.getThemeSetting("gridline"),transform:"translateY("+i+"px)",opacity:1},children:[{style:{position:"absolute",left:0,top:0,width:this._cd.rowHeaderSpace+1+"px","border-bottom":"thin solid "+this.getThemeSetting("gridline-tip")}}]}),e.push(o),this._rowLines.push({node:o,offset:i});JSCompiler_temp_const$jscomp$1.call(JSCompiler_temp_const$jscomp$0,t,e)}JSCompiler_temp_const=
{name:"rowLines",style:JSCompiler_temp_const,domNodes:t};t={position:"absolute",top:0,left:0,height:this._cd.viewportHeight+"px"};var e$jscomp$0=[];for(var e$jscomp$1 in this._cd.panesX){JSCompiler_temp_const$jscomp$0=e$jscomp$0.push;JSCompiler_temp_const$jscomp$1=JSCompiler_temp_const$jscomp$0.apply;t$jscomp$0=e$jscomp$1;e=[];i=this._cd.panesX[t$jscomp$0].offset;"left"==t$jscomp$0&&(i+=this._cd.rowHeaderSpace,o=T$jscomp$0.call(this,{name:"colLine",style:{position:"absolute",top:0,bottom:0,left:0,
width:0,transform:"translateX("+i+"px)","border-right":"thin solid "+this.getThemeSetting("gridline-tip"),opacity:1}}),e.push(o));for(s=0;s<this._panesXids[t$jscomp$0].length;s++)i+=this.getColWidthById(this._panesXids[t$jscomp$0][s]),o=T$jscomp$0.call(this,{name:"colLine",style:{position:"absolute",top:0,bottom:0,left:0,width:0,transform:"translateX("+i+"px)","border-right":"thin solid "+this.getThemeSetting("gridline"),opacity:1},children:[{style:{position:"absolute",top:0,left:0,height:this._cd.colHeaderSpace+
1+"px","border-right":"thin solid "+this.getThemeSetting("gridline-tip")}}]}),e.push(o),this._colLines.push({node:o,offset:i});JSCompiler_temp_const$jscomp$1.call(JSCompiler_temp_const$jscomp$0,e$jscomp$0,e)}return[JSCompiler_temp_const,{name:"colLines",style:t,domNodes:e$jscomp$0}]},ue=function(){var t=[];return t.push({name:"freezeLinePlaceholder_row",style:{position:"absolute",left:0,width:this._cd.rowHeaderSpace+"px",height:"6px","background-color":this.getThemeSetting("freezelineplaceholder"),
top:0,opacity:0},_opacity:this._sectionsPerPaneY.top.length?0:1}),t.push({name:"freezeLinePlaceholder_col",style:{position:"absolute",top:0,height:this._cd.colHeaderSpace+"px",left:0,width:"6px","background-color":this.getThemeSetting("freezelineplaceholder"),opacity:0},_opacity:this._sectionsPerPaneX.left.length?0:1}),t},fe=function(){var t=1;this._rowView.length&&(t=this.getRowPositionInViewport(this._viewportPosition.y+(this._rowView.length-1)),t+=this._actualRowHeight+1,t=(this._cd.viewportHeight-
t)/100);return{name:"blankSheetBottom blankSheet",style:{position:"absolute",bottom:0,left:0,right:0,"background-color":this.getThemeSetting("blanksheet"),height:"100px","transform-origin":"center bottom",transform:"scaleY("+t+")",opacity:0<t?1:0},_opacity:1}},ge=function(){var t=1;if(this._colView.length){t=this._viewportPosition.x+(this._colView.length-1);var i=this.getColPositionInViewport(t);i+=this.getColWidthById(this._cols.coordList[t])+1;t=(this._cd.viewportWidth-i)/100}return{name:"blankSheetRight blankSheet",
style:{position:"absolute",top:0,right:0,bottom:0,"background-color":this.getThemeSetting("blanksheet"),width:"100px","transform-origin":"top right",transform:"scaleX("+t+")",opacity:0<t?1:0},_opacity:1}},ve=function(t){var e=[],i=0,o=("left"==t&&(e.push(this._domNodes.rowHeaderColumn),i+=this._cd.rowHeaderSpace),"center"==t)?this._colView:this._panesXids[t];for(t=0;t<o.length;t++){var n=o[t]-1,r=this._cols.store[n];n=this._columnNodes[n];n.column.style.transform="translateX("+i+"px)";i+=r.width;
e.push(n.column)}return e},we=function(){var t=this._sectionsPerPaneX.left.length||null==this._freezeLineColAfterId?1:0,e=this.getThemeSetting("freezeline-tip");return this.allowFreezeCols||null!=this._freezeLineColAfterId||(e="transparent"),{name:"freezeLine-col",style:{position:"absolute",top:0,left:(this._freezeLineColAfterId?this._cd.panesX.left.space:this._cd.panesX.center.offset-6)+"px",bottom:0,width:"6px","background-color":this._freezeLineColAfterId?this.getThemeSetting("freezeline"):"transparent",
opacity:this._cd.panesX.left.space?t:.25},children:[{style:{position:"absolute",top:0,left:0,height:this._cd.colHeaderSpace+"px",width:"6px","background-color":e}}]}},Ce=function(){var t=this._sectionsPerPaneY.top.length||null==this._freezeLineRowAfterId?1:0,e=this.getThemeSetting("freezeline-tip");return this.allowFreezeRows||null!=this._freezeLineRowAfterId||(e="transparent"),{name:"freezeLine-row",style:{position:"absolute",top:(this._freezeLineRowAfterId?this._cd.panesY.top.space:this._cd.panesY.center.offset-
6)+"px",left:0,right:0,height:"6px","background-color":this._freezeLineRowAfterId?this.getThemeSetting("freezeline"):"transparent",opacity:this._cd.panesY.top.space?t:.25},children:[{style:{position:"absolute",top:0,left:0,width:this._cd.rowHeaderSpace+"px",height:"6px","background-color":e}}]}},Re=function(){var t={name:"ghostForFreezeRows",style:{position:"absolute",top:0,left:0,right:0,height:"6px","background-color":this.getThemeSetting("freeze?ghost"),opacity:0},children:[{style:{position:"absolute",
top:0,left:0,width:this._cd.rowHeaderSpace+"px",height:"6px","background-color":"transparent"}}],_opacity:this.getThemeSetting("freeze?ghost|opacity")},e={name:"ghostForFreezeCols",style:{position:"absolute",top:0,left:0,bottom:0,width:"6px","background-color":this.getThemeSetting("freeze?ghost"),opacity:0},children:[{style:{position:"absolute",top:0,left:0,height:this._cd.colHeaderSpace+"px",width:"6px","background-color":"transparent"}}],_opacity:this.getThemeSetting("freeze?ghost|opacity")},i=
{name:"ghostForMoveCols",style:{position:"absolute",left:0,width:"100px","box-sizing":"border-box","background-color":this.getThemeSetting("move?ghost"),bottom:0,top:this._cd.colHeaderSpace+"px",opacity:0},_opacity:this.getThemeSetting("move?ghost|opacity")};return[{name:"ghostForMoveRows",style:{position:"absolute",left:this._cd.rowHeaderSpace+"px",height:"100px","box-sizing":"border-box","background-color":this.getThemeSetting("move?ghost"),right:0,top:0,opacity:0},_opacity:this.getThemeSetting("move?ghost|opacity")},
i,t,e]},ke=function(){var t='\n  \x3csvg height\x3d"8" width\x3d"8" style\x3d"position:absolute;top:3px;right:4px;fill:'+this.getThemeSetting("header-icon")+';"\x3e\n    \x3cpolygon points\x3d"2,4 8,0 8,8" class\x3d"triangle"\x3e\n  \x3c/svg\x3e\n  ',e='\n  \x3csvg height\x3d"8" width\x3d"8" style\x3d"position:absolute;top:3px;left:4px;fill:'+this.getThemeSetting("header-icon")+';"\x3e\n    \x3cpolygon points\x3d"6,4 0,0 0,8" class\x3d"triangle"\x3e\n  \x3c/svg\x3e\n  ',i='\n  \x3csvg height\x3d"8" width\x3d"8" style\x3d"position:absolute;bottom:4px;left:3px;fill:'+
this.getThemeSetting("header-icon")+';"\x3e\n    \x3cpolygon points\x3d"4,2 0,8 8,8" class\x3d"triangle"\x3e\n  \x3c/svg\x3e\n  ',o='\n  \x3csvg height\x3d"8" width\x3d"8" style\x3d"position:absolute;top:4px;left:3px;fill:'+this.getThemeSetting("header-icon")+';"\x3e\n    \x3cpolygon points\x3d"4,6 0,0 8,0" class\x3d"triangle"\x3e\n  \x3c/svg\x3e';return[{name:"hintForResizeCols",style:{overflow:"hidden",position:"absolute",top:0,left:0,width:"4px",height:this._cd.colHeaderSpace+"px","background-color":this.getThemeSetting("resize?hint"),
opacity:0},_opacity:1},{name:"hintForFreezeCols",style:{overflow:"hidden",position:"absolute",top:0,left:0,width:"6px",height:this._cd.colHeaderSpace+"px","background-color":this.getThemeSetting("freeze?hint"),opacity:0},_opacity:1},{name:"hintForFreezeRows",style:{overflow:"hidden",position:"absolute",top:0,left:0,height:"6px",width:this._cd.rowHeaderSpace+"px","background-color":this.getThemeSetting("freeze?hint"),opacity:0},_opacity:1},{name:"hintForShowColsNext",style:{position:"absolute",top:this.colHeaderHeight/
2-8+"px",left:0,height:"16px",width:"14px",background:this.getThemeSetting("show?hint"),"border-radius":"2px 0 0 2px","border-width":"1px","border-style":"solid","border-right-style":"none","border-color":this.getThemeSetting("show?hint"),"box-shadow":"0px 0px 0px 1px "+this.getThemeSetting("show?hint|border"),"clip-path":"polygon(-100% -100%, 100% -100%, 100% 200%, -100% 200%)","box-sizing":"border-box","font-size":10,"text-align":"center",opacity:0},html:t,_opacity:1},{name:"hintForShowColsPrev",
style:{position:"absolute",top:this.colHeaderHeight/2-8+"px",left:0,height:"16px",width:"14px",background:this.getThemeSetting("show?hint"),"border-radius":"0 2px 2px 0","border-width":"1px","border-style":"solid","border-left-style":"none","border-color":this.getThemeSetting("show?hint"),"box-shadow":"0px 0px 0px 1px "+this.getThemeSetting("show?hint|border"),"clip-path":"polygon(0% -100%, 200% -100%, 200% 200%, 0% 200%)","box-sizing":"border-box","font-size":10,"text-align":"center",opacity:0},
html:e,_opacity:1},{name:"hintForShowRowsNext",style:{position:"absolute",top:0,left:"2px",height:"16px",width:"16px",background:this.getThemeSetting("show?hint"),"border-radius":"2px 2px 0 0","border-width":"1px","border-style":"solid","border-bottom-style":"none","border-color":this.getThemeSetting("show?hint"),"box-shadow":"0px 0px 0px 1px "+this.getThemeSetting("show?hint|border"),"clip-path":"polygon(100% -100%, 200% -100%, 200% 100%, -100% 100%)","box-sizing":"border-box","font-size":10,"text-align":"center",
opacity:0},html:i,_opacity:1},{name:"hintForShowRowsPrev",style:{position:"absolute",top:0,left:"2px",height:"16px",width:"16px",background:this.getThemeSetting("show?hint"),"border-radius":"0 0 2px 2px","border-width":"1px","border-style":"solid","border-top-style":"none","border-color":this.getThemeSetting("show?hint"),"box-shadow":"0px 0px 0px 1px "+this.getThemeSetting("show?hint|border"),"clip-path":"polygon(-100% 0%, 200% 0%, 200% 200%, 0% 200%)","box-sizing":"border-box","font-size":10,"text-align":"center",
opacity:0},html:o,_opacity:1}]},Xe=function(){for(var t,e=[],i=0;i<this._validatedBottomBar.length;i++)(t={type:this._validatedBottomBar[i].name,wrapper:void 0,nodes:{}}).wrapper=T$jscomp$0.call(this,{name:"part part-"+this._validatedBottomBar[i].name,style:{display:"flex","flex-grow":this._validatedBottomBar[i].grow||0,height:"100%"},children:[this._validatedBottomBar[i].node.call(this)],_reset:!1},t.nodes),e.push(t.wrapper),this._bottomBarNodes.push(t);return e},Ci=function(t){t.value=" ";t.select();
t.setSelectionRange(0,1)},Ii=function(){var t=this;this.activate();this._isFullscreen=!0;this.resize();setTimeout(function(){mi.call(t,"window","resize");t._domNodes.container._resizeSensor.events.off("resize",t._listeners.container.resize)},100);this.constructor.contextMenu.isOpen()&&this.constructor.contextMenu.close();A$jscomp$0(this._domNodes.component,[this.constructor._domNodes.contextMenu]);this.events.dispatch("fullscreenenter")},Ri=function(){var t=this;(this.constructor._isMacOS||this.constructor._isIOS)&&
(this._domNodes.component.style.height=this._cd.containerHeight+"px",this._domNodes.component.style.width=this._cd.containerWidth+"px");this._isFullscreen=!1;this.resize();setTimeout(function(){xi.call(t,"window","resize");t._domNodes.container._resizeSensor.events.on("resize",t._listeners.container.resize)},100);this._isActive&&(this.constructor.contextMenu.isOpen()&&this.constructor.contextMenu.close(),A$jscomp$0(document.body,[this.constructor._domNodes.contextMenu,this.constructor._domNodes.contextMenuTouch]),
this.events.dispatch("fullscreenleave"))},ss,ns=(ss=function(t){t.ghostPositionPx=t.pointerPositionPx.y-t.pointerOffset-1;t.endCoord=$o(xo.call(this,t.pointerPositionPx.y,!0),0,this._rows.coordList.length-1)},{start:function(t){this._domNodes.scrollArea.scrollTop=0},move:function(t){var e=this;ss.call(this,t);requestAnimationFrame(function(){Qo.call(e,t.ghostPositionPx);es.call(e,t.endCoord)})},end:function(t){this.freezeRows(this.getRowIndexByCoord(t.endCoord))},prepare:function(t){var e=this,i=
t.pointerPositionPx.y;i-=this.getRowPositionInViewport(t.coords.y);(this._panesYids.top.length||null==this._freezeLineRowAfterId)&&(i+=6);t.pointerOffset=i;ss.call(this,t);requestAnimationFrame(function(){Jo.call(e,t.ghostPositionPx);is.call(e,t.coords.y)})},release:function(t){var e=this;requestAnimationFrame(function(){ts.call(e);os.call(e)})}}),us=function(){var t$jscomp$0=function(t){t.ghostPositionPx=t.pointerPositionPx.x-t.pointerOffset-1;t.endCoord=$o(mo.call(this,t.pointerPositionPx.x,!0),
0,this._cols.coordList.length-1)};return{start:function(t){this._domNodes.scrollArea.scrollLeft=0},move:function(e){var i=this;t$jscomp$0.call(this,e);requestAnimationFrame(function(){rs.call(i,e.pointerPositionPx.x);as.call(i,e.endCoord)})},end:function(t){this.freezeCols(this.getColIndexByCoord(t.endCoord))},prepare:function(e){var i=this,o=e.pointerPositionPx.x;o-=this.getColPositionInViewport(e.coords.x);(this._panesXids.left.length||null==this._freezeLineColAfterId)&&(o+=6);e.pointerOffset=o;
t$jscomp$0.call(this,e);requestAnimationFrame(function(){ls.call(i,e.ghostPositionPx);cs.call(i,e.coords.x)})},release:function(t){var e=this;requestAnimationFrame(function(){hs.call(e);ds.call(e)})}}}(),Rs=function(){return{top:0,right:this._cols.coordList.length-1,bottom:this._rows.coordList.length-1,left:0}},ks=function(t){var e=this._selection[this._selection.length-1].range,i=0,o=0,s="",n="";if(t.y<e[0].y){var r=e[0].y-1;i=e[0].y-t.y;n="up"}else t.y>e[1].y&&(r=e[1].y+1,i=t.y-e[1].y,n="down");
if(t.x<e[0].x){var l=e[0].x-1;o=e[0].x-t.x;s="left"}else t.x>e[1].x&&(l=e[1].x+1,o=t.x-e[1].x,s="right");if("xy"==this.fillCellsDirection){if(0==o&&0==i)return{dragDirection:void 0,dragAmount:void 0,targetCellRange:null};if(i>=o){var h={x:e[0].x,y:r},a={x:e[1].x,y:t.y};c=n;d=i}else h={x:l,y:e[0].y},a={x:t.x,y:e[1].y},c=s,d=o}else if("y"==this.fillCellsDirection){if(0==i)return{dragDirection:void 0,dragAmount:void 0};h={x:e[0].x,y:r};a={x:e[1].x,y:t.y};var c=n,d=i}else if("x"==this.fillCellsDirection){if(0==
o)return{dragDirection:void 0,dragAmount:void 0};h={x:l,y:e[0].y};a={x:t.x,y:e[1].y};c=s;d=o}return{dragDirection:c,dragAmount:d,targetCellRange:Ps([h,Is.call(this,a)])}},Hs={resizeCols:{handler:function(){var t$jscomp$0=function(t){var e=t.pointerPositionPx.x-(t.pointerOffset-1),i=this._cd.viewportWidth,o=this.getColPositionInViewport(t.coords.x)+32-4;e<o?e=o:e+4>i&&(e=i-3);e<this._cd.rowHeaderSpace&&(e=this._cd.rowHeaderSpace);t.guidePositionPx=e;t.size=e-this.getColPositionInViewport(t.coords.x)};
return{start:function(t){},move:function(e){var i=this;t$jscomp$0.call(this,e);requestAnimationFrame(function(){fs.call(i,e.guidePositionPx)})},end:function(t){ys(t.coords.x,this.getColSelection())?this.resizeCols(this.getColSelection(),t.size):this.resizeCols(t.coords.x,t.size)},prepare:function(e){var i=this,o=e.pointerPositionPx.x;o-=this.getColPositionInViewport(e.coords.x);o-=this.getColWidthById(this._cols.coordList[e.coords.x])-4;e.pointerOffset=o;t$jscomp$0.call(this,e);requestAnimationFrame(function(){gs.call(i,
e.guidePositionPx)})},release:function(t){var e=this;requestAnimationFrame(function(){_s.call(e)})}}}(),edgeDetection:!1},freezeCols:{handler:us,edgeDetection:!1},moveCols:{handler:{start:function(t){t.pointerOffset=t.pointerPositionPx.x-this.getColPositionInViewport(t.ranges[t.ranges.length-1].range[0].x)},move:function(t){var e,i=this,o=t.pointerPositionPx.x-t.pointerOffset,s=vt.call(this,t.range);o<this._cd.rowHeaderSpace&&(o=this._cd.rowHeaderSpace);o>this._cd.viewportWidth-s&&(o=this._cd.viewportWidth-
s);0>(e=Io(t.pointerPosition.x,t.range)?t.range[0]:t.pointerPosition.x<t.range[0]?t.pointerPosition.x:t.pointerPosition.x+1)&&(e=0);t.endCoord=e||0;requestAnimationFrame(function(){ms.call(i,o);Cs.call(i,e)})},end:function(t){this.moveCols(t.range,t.endCoord)},prepare:function(t){var e=this;t.range=ps.call(this,t.ranges[t.ranges.length-1].range);requestAnimationFrame(function(){xs.call(e,t.range);bs.call(e,t.range)})},release:function(t){var e=this;requestAnimationFrame(function(){ws.call(e);Ss.call(e)})}},
edgeDetection:"x"},moveRows:{handler:{start:function(t){t.pointerOffset=t.pointerPositionPx.y-this.getRowPositionInViewport(t.ranges[t.ranges.length-1].range[0].y)},move:function(t){var e,i=this,o=t.pointerPositionPx.y-t.pointerOffset,s=xt.call(this,t.range);o<this._cd.colHeaderSpace&&(o=this._cd.colHeaderSpace);o>this._cd.viewportHeight-s&&(o=this._cd.viewportHeight);0>(e=Io(t.pointerPosition.y,t.range)?t.range[0]:t.pointerPosition.y<t.range[0]?t.pointerPosition.y:t.pointerPosition.y+1)&&(e=0);t.endCoord=
e||0;requestAnimationFrame(function(){Wo.call(i,o);Uo.call(i,e)})},end:function(t){this.moveRows(t.range,t.endCoord)},prepare:function(t){var e=this;t.range=Yo.call(this,t.ranges[t.ranges.length-1].range);requestAnimationFrame(function(){Ko.call(e,t.range);qo.call(e,t.range)})},release:function(t){var e=this;requestAnimationFrame(function(){jo.call(e);Go.call(e)})}},edgeDetection:"y"},freezeRows:{handler:ns,edgeDetection:!1},fillCells:{handler:{start:function(t){},move:function(t){var e=ks.call(this,
t.pointerPosition);t.dragDirection=e.dragDirection;t.dragAmount=e.dragAmount;Ki.call(this,"fill",e.targetCellRange,t)},end:function(t){null!=t.dragDirection&&null!=t.dragAmount&&this.fillCells(this._selection[this._selection.length-1].range,t.dragDirection,t.dragAmount)},prepare:function(t){},release:function(t){}},edgeDetection:"xy"},selectCells:{handler:{start:function(t){},move:function(t){this.setCellRangeExtreme(t.pointerPosition,!t.e[this._commandKey])},end:function(t){},prepare:function(t){},
release:function(t){}},edgeDetection:"xy"},selectRows:{handler:{start:function(t){},move:function(t){this.setRowRangeExtreme(t.pointerPosition.y,!t.e[this._commandKey])},end:function(t){},prepare:function(t){},release:function(t){}},edgeDetection:"y"},selectCols:{handler:{start:function(t){},move:function(t){this.setColRangeExtreme(t.pointerPosition.x,!t.e[this._commandKey])},end:function(t){},prepare:function(t){},release:function(t){}},edgeDetection:"x"}},rn=function(t$jscomp$0,e$jscomp$0,i$jscomp$0){this._domNodes.display[t$jscomp$0+
"MoveFunc"]=function(e){void 0===e&&(e=null);var i=this._domNodes.display[t$jscomp$0+"Properties"],o=this._domNodes.display[t$jscomp$0+"Flags"];null!=e&&(i.e=e);if(!o.hasMoved){var t=Hs[t$jscomp$0].edgeDetection;void 0===t&&(t="xy");this._edgeOffsetY=this._edgeOffsetX=0;t&&(this._domNodes.display._edgeDetectFunction=Ys.bind(this,t),this._domNodes.display._edgeDetectTimeout=setTimeout(this._domNodes.display._edgeDetectFunction,50));Hs[t$jscomp$0].handler.start.call(this,i);o.hasMoved=!0}this._pointerPositionPx=
e=null==e?i.pointerPositionPx:_o.call(this,e.clientX,e.clientY);o=wo.call(this,this._pointerPositionPx);t=this.getPanePositionXfromCellCoords(o);var a=this.getPanePositionYfromCellCoords(o),c=this.getColSectionFromCellCoords(o),d=this.getRowSectionFromCellCoords(o),u=null,p=null;"top"==i.paneY&&"center"==a&&!this._isViewportConnectedTo.top&&Hs[t$jscomp$0].edgeDetection.includes("y")&&1==i.panesY.length&&(u=this._panesYids.top.length);"left"==i.paneX&&"center"==t&&!this._isViewportConnectedTo.left&&
Hs[t$jscomp$0].edgeDetection.includes("x")&&1==i.panesX.length&&(p=this._panesXids.left.length);-1<i.panesY.indexOf("center")&&"top"==a&&!this._isViewportConnectedTo.top&&(o.y=this._viewportPosition.y);-1<i.panesX.indexOf("center")&&"left"==t&&!this._isViewportConnectedTo.left&&(o.x=this._viewportPosition.x);null===p&&null===u||tn.call(this,{x:null!==p?p:this._viewportPosition.x,y:null!==u?u:this._viewportPosition.y});null!==u&&(i.pointerPosition.y=xo.call(this,e.y));null!==p&&(i.pointerPosition.x=
mo.call(this,e.x));i.pointerPositionPx=e;i.pointerPosition=o;i.newPaneX=t;i.newPaneY=a;this._isViewportConnectedTo.top&&"top"==a?i.panesY=["top"]:a!=i.panesY[i.panesY.length-1]&&i.panesY.push(a);this._isViewportConnectedTo.left&&"left"==t?i.panesX=["left"]:t!=i.panesX[i.panesX.length-1]&&i.panesX.push(t);i.newColSection=c;i.newRowSection=d;Hs[t$jscomp$0].handler.move.call(this,i);o=e.x;-1==i.panesX.indexOf("center")?c=0:(t=0,a=this._cd.panesX.left.space,c=a+this._cd.panesX.center.space,c=(o>c?t=o-
c:o<a&&(t=o-a),t));this._edgeOffsetX=c;e=e.y;-1==i.panesY.indexOf("center")?t=0:(i=0,o=this._cd.panesY.center.offset,t=o+this._cd.panesY.center.space,t=(e>t?i=e-t:e<o&&(i=e-o),i));this._edgeOffsetY=t}.bind(this)},ln=function(t,e$jscomp$0,i){this._domNodes.display[t+"EndFunc"]=function(e){null!=this._domNodes.display._edgeDetectTimeout&&(clearTimeout(this._domNodes.display._edgeDetectTimeout),this._domNodes.display._edgeDetectTimeout=null);this._edgeOffsetY=this._edgeOffsetX=0;document.removeEventListener("mousemove",
this._domNodes.display[t+"MoveFunc"]);document.removeEventListener("mouseup",this._domNodes.display[t+"EndFunc"]);this._currentDragAction=null;$s.call(this,this._domNodes.display[t+"Properties"].pointerPositionPx);mi.call(this,"eventArea","mousemove");mi.call(this,"eventArea","mouseleave");this.redraw();Hs[t].handler.release.call(this,this._domNodes.display[t+"Properties"]);this._domNodes.display[t+"Flags"].hasMoved&&Hs[t].handler.end.call(this,this._domNodes.display[t+"Properties"]);delete this._domNodes.display[t+
"Properties"]}.bind(this)},En=function(t$jscomp$0){if("topBar"==t$jscomp$0)var e=this._validatedTopBar,i=this._topBarNodes;else"bottomBar"==t$jscomp$0&&(e=this._validatedBottomBar,i=this._bottomBarNodes);t$jscomp$0=function(t){var o=e[t].listeners,s;for(s in o){var n=s.split("."),r=n[0];n=n[1];var h=o[s].bind(this,i[t].nodes);i[t].nodes[r].addEventListener(n,h)}};var n$jscomp$0=function(t){var o=e[t].events,s;for(s in o){var n=o[s].bind(this,i[t].nodes);this.events.on(s,n)}},r$jscomp$0=function(t){if("keys"in
e[t])for(var o in e[t].keys)for(var n=0;n<e[t].keys[o].length;n++){var r=e[t].keys[o][n];if(s$jscomp$8(r)){var l=r.action.bind(this,i[t].nodes);this.keys.on(r.keys,l,r.repeat,i[t].nodes[o])}else r=this._presetKeyActions[r],this.keys.on(r.keys,r.action,r.repeat,i[t].nodes[o])}},l$jscomp$0=0;for(;l$jscomp$0<e.length;l$jscomp$0++)t$jscomp$0.call(this,l$jscomp$0),n$jscomp$0.call(this,l$jscomp$0),r$jscomp$0.call(this,l$jscomp$0)},Yn=function(t,e,i,o){this.getRowCoordById(i);for(var s={left:this._panesXids.left,
center:this._colView},n=0,r=0;r<s[o].length;r++){this.getColCoordById(s[o][r]);var l=this.getColWidthById(s[o][r]);l=Math.ceil(l/1);r==s[o].length-1&&(l+=1);var a=this._cellStore[i-1][s[o][r]-1].color||this.getThemeSetting("sheet");if(this._searchCellsFound.length&&this._cellStore[i-1][s[o][r]-1]._found===this._searchStr){a=Vn(a);var d=Vn(this.getThemeSetting("cell+found"));d[3]=this.getThemeSetting("cell+found|opacity");a=Dn(a,d);a="rgb("+a[0]+","+a[1]+","+a[2]+")"}t._context.fillStyle=a;t._context.fillRect(n,
e,l,1);n+=l}},pr=function(t,e){void 0===t&&(t="next");void 0===e&&(e=[]);var i=this._rows[t+"Nodes"],o=this._domNodes["hiddenRowGroupIcon"+No(t)+"Container"];t=this._templates["hiddenRowGroupIcon"+No(t)];for(var n=document.createDocumentFragment(),r=[],l=0;l<i.length;l++)r.push(l);var h=[];for(l=0;l<e.length;l++){var a=ar(i,"position",e[l].position);-1<a?(r.splice(r.indexOf(a),1),i[a].node.style.opacity=1):h.push(e[l].position)}for(l=0;l<h.length;l++)r.length?(i[e=r.shift()].node.style.transform=
"translateY("+h[l]+"px)",i[e].node.style.opacity=1,i[e].position=h[l]):(e=t.cloneNode(!0),e.style.transform="translateY("+h[l]+"px)",i.push({node:e,position:h[l]}),n.appendChild(e));o.appendChild(n);for(l=0;l<r.length;l++)i[r[l]].node.style.opacity=0},yr=function(t,e){void 0===t&&(t="next");void 0===e&&(e=[]);var i=this._cols[t+"Nodes"],o=this._domNodes["hiddenColGroupIcon"+No(t)+"Container"];t=this._templates["hiddenColGroupIcon"+No(t)];for(var n=document.createDocumentFragment(),r=[],l=0;l<i.length;l++)r.push(l);
var h=[];for(l=0;l<e.length;l++){var a=ar(i,"position",e[l].position);-1<a?(r.splice(r.indexOf(a),1),i[a].node.style.opacity=1):h.push(e[l].position)}for(l=0;l<h.length;l++)r.length?(i[e=r.shift()].node.style.transform="translateX("+h[l]+"px)",i[e].node.style.opacity=1,i[e].position=h[l]):(e=t.cloneNode(!0),e.style.transform="translateX("+h[l]+"px)",i.push({node:e,position:h[l]}),n.appendChild(e));o.appendChild(n);for(l=0;l<r.length;l++)i[r[l]].node.style.opacity=0},zr=function(t$jscomp$0,e$jscomp$0){void 0===
e$jscomp$0&&(e$jscomp$0=document);this._actionKeys={backspace:8,tab:9,enter:13,break:19,pause:19,esc:27,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,ins:45,insert:45,del:46,delete:46,plus:61};for(var t={},e=[{startIndex:65,series:"abcdefghijklmnopqrstuvwxyz"},{startIndex:48,series:"0123456789"}],i=0;i<e.length;i++)for(var o=0;o<e[i].series.length;o++)t[e[i].series[o]]=e[i].startIndex+o;t=this._characterKeys=(t["\\"]=220,t);e={};for(var i$jscomp$0 in t)e[String(t[i$jscomp$0])]=
i$jscomp$0;this._lookupCharacterKeys=e;this._modifierKeys={shift:"shiftKey",ctrl:t$jscomp$0.constructor._isMacOS?"metaKey":"ctrlKey",alt:"altKey"};this._nonInputKeyCodes=[8,9,13,16,17,18,19,20,27,33,34,35,36,37,38,39,40,44,45,46,91,92,93,112,113,114,115,116,117,118,119,120,121,122,123,144,145,182,183];this._modifierKeyCodes=[16,17,18,91,93];this._metaKeyCodes=[91,93];this._context=t$jscomp$0;this.trackedActionKeys=[];this.trackedCharacterKeys=[];this.trackedModifierKeys=[];this.pressedActionKeys=
{};this.pressedCharacterKeys={};this.pressedModifierKeys={};this.identifyKeyActionTimeout=null;this.keysToPrevent={};this.prevKeyAction=null;this.keyActions=[];this.keys={};this.keyHoldDelay=350;this.keyHoldInterval=60;this._isSuspended=!1;this._keyDownListener=Tr.bind(this);this._keyUpListener=Fr.bind(this);this._identifyKeyAction=Mr.bind(this);this._scope=e$jscomp$0;this._scope.addEventListener("keydown",this._keyDownListener);this._scope.addEventListener("keyup",this._keyUpListener)};zr.prototype.on=
function(t,e,i,o){void 0===i&&(i=!0);void 0===o&&(o=null);for(var s=!1,n="",r=[],l=[],h=[],a=(t=t.split("+"),[]),c=0;c<t.length;c++){var d=t[c].trim();d in this._modifierKeys?r.push(d):d in this._actionKeys?l.push(d):d in this._characterKeys&&h.push(d);a.push(d)}if(Br({modifierKeys:r,actionKeys:l,characterKeys:h})&&(s=!0,n=a.join("+")),s){if(void 0===this.keys[n]){this.keys[n]={actions:[]};this.keyActions.push({actionKeys:l,characterKeys:h,modifierKeys:r,keyString:n});for(c=0;c<l.length;c++)this._actionKeys[l[c]]in
this.keysToPrevent||(this.keysToPrevent[this._actionKeys[l[c]]]=[]),this.keysToPrevent[this._actionKeys[l[c]]].push(n);for(c=0;c<h.length;c++)this._characterKeys[h[c]]in this.keysToPrevent||(this.keysToPrevent[this._characterKeys[h[c]]]=[]),this.keysToPrevent[this._characterKeys[h[c]]].push(n)}for(c=0;c<this.keys[n].actions.length;c++)if(this.keys[n].actions[c].callback==e&&this.keys[n].actions[c].repeatable==i&&this.keys[n].actions[c].target==o)return;this.keys[n].actions.push({callback:e,repeatable:i,
target:o});t=null;for(c=0;c<a.length;c++)a[c]in this._modifierKeys?-1==this.trackedModifierKeys.indexOf(this._modifierKeys[a[c]])&&this.trackedModifierKeys.push(this._modifierKeys[a[c]]):a[c]in this._actionKeys?(t=this._actionKeys[a[c]],-1==this.trackedActionKeys.indexOf(t)&&this.trackedActionKeys.push(t)):a[c]in this._characterKeys&&(t=this._characterKeys[a[c]],-1==this.trackedCharacterKeys.indexOf(t)&&this.trackedCharacterKeys.push(t))}};zr.prototype.off=function(t,e,i,o){for(var s=[],n=[],r=[],
l=(t=t.split("+"),[]),h=0;h<t.length;h++){var a=t[h].trim();a in this._modifierKeys?r.push(a):a in this._actionKeys?s.push(a):a in this._characterKeys&&n.push(a);l.push(a)}if(Br({modifierKeys:r,actionKeys:s,characterKeys:n})&&(t=l.join("+"),void 0!==this.keys[t])){s=[];for(h=0;h<this.keys[t].actions.length;h++)this.keys[t].actions[h].callback==e&&this.keys[t].actions[h].repeatable==i&&this.keys[t].actions[h].target==o||s.push(this.keys[t].actions[h]);if(this.keys[t].actions=s,!this.keys[t].actions.length)for(delete this.keys[t],
h=0;h<this.keyActions.length;h++)if(this.keyActions[h].keyString==t){for(e=0;e<this.keyActions[h].actionKeys.length;e++)this._actionKeys[this.keyActions[h].actionKeys[e]]in this.keysToPrevent&&(-1<(p=this.keysToPrevent[this._actionKeys[this.keyActions[h].actionKeys[e]]].indexOf(t))&&this.keysToPrevent[this._actionKeys[this.keyActions[h].actionKeys[e]]].splice(p,1),this.keysToPrevent[this._actionKeys[this.keyActions[h].actionKeys[e]]].length||delete this.keysToPrevent[this._actionKeys[this.keyActions[h].actionKeys[e]]]);
for(e=0;e<this.keyActions[h].characterKeys.length;e++){var p;this._characterKeys[this.keyActions[h].characterKeys[e]]in this.keysToPrevent&&(-1<(p=this.keysToPrevent[this._characterKeys[this.keyActions[h].characterKeys[e]]].indexOf(t))&&this.keysToPrevent[this._characterKeys[this.keyActions[h].characterKeys[e]]].splice(p,1),this.keysToPrevent[this._characterKeys[this.keyActions[h].characterKeys[e]]].length||delete this.keysToPrevent[this._characterKeys[this.keyActions[h].characterKeys[e]]])}this.keyActions.splice(h,
1);break}}};zr.prototype.suspend=function(){this._scope.removeEventListener("keydown",this._keyDownListener);this._scope.removeEventListener("keyup",this._keyUpListener)};zr.prototype.resume=function(){this._scope.addEventListener("keydown",this._keyDownListener);this._scope.addEventListener("keyup",this._keyUpListener)};var Tr=function(t){var e=t.which||t.keyCode;if(!(-1<this._modifierKeyCodes.indexOf(e)&&null===this.identifyKeyActionTimeout)){this._scope!=document||Dr.call(this)||!(e in this.keysToPrevent)||
e in this._lookupCharacterKeys||t.preventDefault();for(var i=0;i<this.trackedModifierKeys.length;i++){var o=this.trackedModifierKeys[i];o in t&&1==t[o]?this.pressedModifierKeys[o]=!0:o in this.pressedModifierKeys&&delete this.pressedModifierKeys[o]}-1<this.trackedActionKeys.indexOf(e)&&!this.pressedActionKeys[e]&&(this.pressedActionKeys[e]=!0);-1<this.trackedCharacterKeys.indexOf(e)&&!this.pressedCharacterKeys[e]&&(this.pressedCharacterKeys[e]=!0);null===this.identifyKeyActionTimeout&&Mr.call(this,
t)}},Fr=function(t){t=t.which||t.keyCode;this.pressedActionKeys[t]&&delete this.pressedActionKeys[t];this.pressedCharacterKeys[t]&&delete this.pressedCharacterKeys[t];-1<this._metaKeyCodes.indexOf(t)&&(this.pressedCharacterKeys={},this.pressedActionKeys={});0==Object.keys(this.pressedActionKeys).length&&0==Object.keys(this.pressedCharacterKeys).length&&(clearTimeout(this.identifyKeyActionTimeout),this.identifyKeyActionTimeout=null,this.pressedActionKeys={},this.pressedCharacterKeys={},this.pressedModifierKeys=
{},this.prevKeyAction=null)},Mr=function(t$jscomp$0){var e$jscomp$0=this;if(void 0===t$jscomp$0&&(t$jscomp$0=null),document.hasFocus()){for(var i$jscomp$0=[],o=0;o<this.keyActions.length;o++){for(var s=0,n=0;n<this.keyActions[o].modifierKeys.length;n++)this.pressedModifierKeys[this._modifierKeys[this.keyActions[o].modifierKeys[n]]]&&s++;for(n=0;n<this.keyActions[o].actionKeys.length;n++)this.pressedActionKeys[this._actionKeys[this.keyActions[o].actionKeys[n]]]&&s++;for(n=0;n<this.keyActions[o].characterKeys.length;n++)this.pressedCharacterKeys[this._characterKeys[this.keyActions[o].characterKeys[n]]]&&
s++;0<s&&s==this.keyActions[o].actionKeys.length+this.keyActions[o].characterKeys.length+this.keyActions[o].modifierKeys.length&&i$jscomp$0.push(this.keyActions[o])}i$jscomp$0=(1<i$jscomp$0.length&&i$jscomp$0.sort(function(t,e){return e.actionKeys.length+e.modifierKeys.length-(t.actionKeys.length+t.modifierKeys.length)}),i$jscomp$0.length?(i$jscomp$0[0]==this.prevKeyAction?this.keyActionRepeatCounter++:this.keyActionRepeatCounter=0,this.keys[i$jscomp$0[0].keyString].actions.forEach(function(i){null!=
i.target||Dr.call(e$jscomp$0)?i.target==t$jscomp$0.target&&document.activeElement==i.target&&(0==i.repeatable&&(e$jscomp$0.keyActionRepeatCounter=0),1!=i.repeatable&&0!=e$jscomp$0.keyActionRepeatCounter||(i.callback.call(e$jscomp$0._context,t$jscomp$0),t$jscomp$0.preventDefault())):(0==i.repeatable&&(e$jscomp$0.keyActionRepeatCounter=0),1!=i.repeatable&&0!=e$jscomp$0.keyActionRepeatCounter||i.callback.call(e$jscomp$0._context,t$jscomp$0))}),this._context.constructor._isMacOS&&-1<i$jscomp$0[0].modifierKeys.indexOf("ctrl")&&
(this.pressedCharacterKeys={},this.pressedActionKeys={}),this.prevKeyAction=i$jscomp$0[0]):(this.keyActionRepeatCounter=0,this.prevKeyAction=null),0==this.keyActionRepeatCounter)?this.keyHoldDelay:this.keyHoldInterval;this.identifyKeyActionTimeout=setTimeout(function(){e$jscomp$0._identifyKeyAction.call(e$jscomp$0,t$jscomp$0)},i$jscomp$0)}},Br=function(t){var e=!0;return(t.modifierKeys.length&&!t.actionKeys.length&&!t.characterKeys.length||!t.modifierKeys.length&&!t.actionKeys.length&&t.characterKeys.length||
t.actionKeys.length&&t.characterKeys.length)&&(e=!1),e},Dr=function(){for(var t=["input","button","img","a"],e=!1,i=0;i<t.length;i++)if(document.activeElement.tagName.toLowerCase()==t[i]){e=!0;break}return e};zr._lastAction=null;var Vr=function(t){this.commands=[];this.index=-1;this.limit=0;this.isExecuting=!1;this.callback;this._context=t};Vr.prototype.add=function(t){if(!this.isExecuting){this.commands.splice(this.index+1,this.commands.length-this.index);this.commands.push(t);if(this.limit&&this.commands.length>
this.limit){t=this.commands;var i=-(this.limit+1);t.splice(0,!i||1+i-0+(!(0>i^1)&&(0>i||-1)*t.length))}this.index=this.commands.length-1;this.callback&&this.callback()}return this};Vr.prototype.setCallback=function(t){this.callback=t};Vr.prototype.undo=function(){var t=this.commands[this.index];return t&&this._context.events.dispatch("beforeundo",{command:t})?(Xr.call(this,t,"undo"),--this.index,this._context.events.dispatch("undo",{command:t}),this.callback&&this.callback(),this):this};Vr.prototype.redo=
function(){var t=this.commands[this.index+1];return t&&this._context.events.dispatch("beforeredo",{command:t})?(Xr.call(this,t,"redo"),this.index+=1,this._context.events.dispatch("redo",{command:t}),this.callback&&this.callback(),this):this};Vr.prototype.clear=function(){var t=this.commands.length;this.commands=[];this.index=-1;this.callback&&0<t&&this.callback()};Vr.prototype.hasUndo=function(){return-1!==this.index};Vr.prototype.hasRedo=function(){return this.index<this.commands.length-1};Vr.prototype.getCommands=
function(){return this.commands};Vr.prototype.getIndex=function(){return this.index};Vr.prototype.setLimit=function(t){this.limit=t};var Xr=function(t,e){return t&&"function"==typeof t[e]?(this.isExecuting=!0,t[e].call(this._context),this.isExecuting=!1,this):this},Wr=function(){function l$jscomp$2(e$jscomp$0){this._handle=null;this._halted=this._completed=this._finished=!1;this._input=null;this._baseIndex=0;this._partialLine="";this._start=this._rowCount=0;this._nextChunk=null;this.isFirstChunk=
!0;this._completeResults={data:[],errors:[],meta:{}};(function(t){var e=m$jscomp$0(t);e.chunkSize=parseInt(e.chunkSize);t.step||t.chunk||(e.chunkSize=null);this._handle=new p$jscomp$1(e);this._handle.streamer=this;this._config=e}).call(this,e$jscomp$0);this.parseChunk=function(e,o){if(this.isFirstChunk&&w(this._config.beforeFirstChunk)){var s=this._config.beforeFirstChunk(e);void 0!==s&&(e=s)}this._halted=this.isFirstChunk=!1;s=this._partialLine+e;this._partialLine="";e=this._handle.parse(s,this._baseIndex,
!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var h=e.meta.cursor;this._finished||(this._partialLine=s.substring(h-this._baseIndex),this._baseIndex=h);e&&e.data&&(this._rowCount+=e.data.length);s=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(i$jscomp$2)t$jscomp$2.postMessage({results:e,workerId:n$jscomp$0.WORKER_ID,finished:s});else if(w(this._config.chunk)&&!o){if(this._config.chunk(e,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=
!0);this._completeResults=e=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(e.data),this._completeResults.errors=this._completeResults.errors.concat(e.errors),this._completeResults.meta=e.meta),this._completed||!s||!w(this._config.complete)||e&&e.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),s||e&&e.meta.paused||this._nextChunk(),e}this._halted=!0};this._sendError=function(e){w(this._config.error)?
this._config.error(e):i$jscomp$2&&this._config.error&&t$jscomp$2.postMessage({workerId:n$jscomp$0.WORKER_ID,error:e,finished:!1})}}function h$jscomp$2(t$jscomp$1){var i;(t$jscomp$1=t$jscomp$1||{}).chunkSize||(t$jscomp$1.chunkSize=n$jscomp$0.RemoteChunkSize);l$jscomp$2.call(this,t$jscomp$1);this._nextChunk=e$jscomp$3?function(){this._readChunk();this._chunkLoaded()}:function(){this._readChunk()};this.stream=function(t){this._input=t;this._nextChunk()};this._readChunk=function(){if(this._finished)this._chunkLoaded();
else{if(i=new XMLHttpRequest,this._config.withCredentials&&(i.withCredentials=this._config.withCredentials),e$jscomp$3||(i.onload=x$jscomp$0(this._chunkLoaded,this),i.onerror=x$jscomp$0(this._chunkError,this)),i.open(this._config.downloadRequestBody?"POST":"GET",this._input,!e$jscomp$3),this._config.downloadRequestHeaders){var t$jscomp$0=this._config.downloadRequestHeaders,o;for(o in t$jscomp$0)i.setRequestHeader(o,t$jscomp$0[o])}this._config.chunkSize&&i.setRequestHeader("Range","bytes\x3d"+this._start+
"-"+(this._start+this._config.chunkSize-1));try{i.send(this._config.downloadRequestBody)}catch(t){this._chunkError(t.message)}e$jscomp$3&&0===i.status&&this._chunkError()}};this._chunkLoaded=function(){if(4===i.readyState)if(200>i.status||400<=i.status)this._chunkError();else{this._start+=this._config.chunkSize?this._config.chunkSize:i.responseText.length;var JSCompiler_temp;if(!(JSCompiler_temp=!this._config.chunkSize)){JSCompiler_temp=this._start;var JSCompiler_inline_result=i.getResponseHeader("Content-Range");
JSCompiler_inline_result=null===JSCompiler_inline_result?-1:parseInt(JSCompiler_inline_result.substring(JSCompiler_inline_result.lastIndexOf("/")+1));JSCompiler_temp=JSCompiler_temp>=JSCompiler_inline_result}this._finished=JSCompiler_temp;this.parseChunk(i.responseText)}};this._chunkError=function(t){this._sendError(Error(i.statusText||t))}}function a$jscomp$1(t$jscomp$0){var e,i;(t$jscomp$0=t$jscomp$0||{}).chunkSize||(t$jscomp$0.chunkSize=n$jscomp$0.LocalChunkSize);l$jscomp$2.call(this,t$jscomp$0);
var o="undefined"!=typeof FileReader;this.stream=function(t){this._input=t;i=t.slice||t.webkitSlice||t.mozSlice;o?((e=new FileReader).onload=x$jscomp$0(this._chunkLoaded,this),e.onerror=x$jscomp$0(this._chunkError,this)):e=new FileReaderSync;this._nextChunk()};this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()};this._readChunk=function(){var t=this._input;this._config.chunkSize&&(t=i.call(t,this._start,Math.min(this._start+this._config.chunkSize,
this._input.size)));t=e.readAsText(t,this._config.encoding);o||this._chunkLoaded({target:{result:t}})};this._chunkLoaded=function(t){this._start+=this._config.chunkSize;this._finished=!this._config.chunkSize||this._start>=this._input.size;this.parseChunk(t.target.result)};this._chunkError=function(){this._sendError(e.error)}}function c$jscomp$1(t$jscomp$0){var e;t$jscomp$0=t$jscomp$0||{};l$jscomp$2.call(this,t$jscomp$0);this.stream=function(t){return e=t,this._nextChunk()};this._nextChunk=function(){if(!this._finished){var t,
i=this._config.chunkSize;return i?(t=e.substring(0,i),e=e.substring(i)):(t=e,e=""),this._finished=!e,this.parseChunk(t)}}}function d$jscomp$1(t$jscomp$1){t$jscomp$1=t$jscomp$1||{};l$jscomp$2.call(this,t$jscomp$1);var e=[],i=!0,o=!1;this.pause=function(){l$jscomp$2.prototype.pause.apply(this,arguments);this._input.pause()};this.resume=function(){l$jscomp$2.prototype.resume.apply(this,arguments);this._input.resume()};this.stream=function(t){this._input=t;this._input.on("data",this._streamData);this._input.on("end",
this._streamEnd);this._input.on("error",this._streamError)};this._checkIsFinished=function(){o&&1===e.length&&(this._finished=!0)};this._nextChunk=function(){this._checkIsFinished();e.length?this.parseChunk(e.shift()):i=!0};this._streamData=x$jscomp$0(function(t$jscomp$0){try{e.push("string"==typeof t$jscomp$0?t$jscomp$0:t$jscomp$0.toString(this._config.encoding)),i&&(i=!1,this._checkIsFinished(),this.parseChunk(e.shift()))}catch(t){this._streamError(t)}},this);this._streamError=x$jscomp$0(function(t){this._streamCleanUp();
this._sendError(t)},this);this._streamEnd=x$jscomp$0(function(){this._streamCleanUp();o=!0;this._streamData("")},this);this._streamCleanUp=x$jscomp$0(function(){this._input.removeListener("data",this._streamData);this._input.removeListener("end",this._streamEnd);this._input.removeListener("error",this._streamError)},this)}function u$jscomp$1(t$jscomp$0){var e$jscomp$0=require("module$node_modules$stream_browserify$index").Duplex,i$jscomp$0=m$jscomp$0(t$jscomp$0),o=!0,s=!1,n=[],r=null;this._onCsvData=
function(t){r.push(t.data)||this._handle.paused()||this._handle.pause()};this._onCsvComplete=function(){r.push(null)};i$jscomp$0.step=x$jscomp$0(this._onCsvData,this);i$jscomp$0.complete=x$jscomp$0(this._onCsvComplete,this);l$jscomp$2.call(this,i$jscomp$0);this._nextChunk=function(){s&&1===n.length&&(this._finished=!0);n.length?n.shift()():o=!0};this._addToParseQueue=function(t,e){n.push(x$jscomp$0(function(){if(this.parseChunk("string"==typeof t?t:t.toString(i$jscomp$0.encoding)),w(e))return e()},
this));o&&(o=!1,this._nextChunk())};this._onRead=function(){this._handle.paused()&&this._handle.resume()};this._onWrite=function(t,e,i){this._addToParseQueue(t,i)};this._onWriteComplete=function(){s=!0;this._addToParseQueue("")};this.getStream=function(){return r};(r=new e$jscomp$0({readableObjectMode:!0,decodeStrings:!1,read:x$jscomp$0(this._onRead,this),write:x$jscomp$0(this._onWrite,this)})).once("finish",x$jscomp$0(this._onWriteComplete,this))}function p$jscomp$1(t$jscomp$0){function x(e){return"greedy"===
t$jscomp$0.skipEmptyLines?""===e.join("").trim():1===e.length&&0===e[0].length}function C(){if(y$jscomp$0&&o$jscomp$0&&(I("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+n$jscomp$0.DefaultDelimiter+"'"),o$jscomp$0=!1),t$jscomp$0.skipEmptyLines)for(var e$jscomp$1=0;e$jscomp$1<y$jscomp$0.data.length;e$jscomp$1++)x(y$jscomp$0.data[e$jscomp$1])&&y$jscomp$0.data.splice(e$jscomp$1--,1);return t$jscomp$0.header&&0===_$jscomp$0.length&&function(){function e$jscomp$0(e,
i){w(t$jscomp$0.transformHeader)&&(e=t$jscomp$0.transformHeader(e,i));_$jscomp$0.push(e)}if(y$jscomp$0)if(Array.isArray(y$jscomp$0.data[0])){for(var i$jscomp$0=0;t$jscomp$0.header&&0===_$jscomp$0.length&&i$jscomp$0<y$jscomp$0.data.length;i$jscomp$0++)y$jscomp$0.data[i$jscomp$0].forEach(e$jscomp$0);y$jscomp$0.data.splice(0,1)}else y$jscomp$0.data.forEach(e$jscomp$0)}(),function(){function e$jscomp$0(e,i){var o,s=t$jscomp$0.header?{}:[];for(o=0;o<e.length;o++){var n=o,r=e[o];t$jscomp$0.header&&(n=o>=
_$jscomp$0.length?"__parsed_extra":_$jscomp$0[o]);t$jscomp$0.transform&&(r=t$jscomp$0.transform(r,n));r=S(n,r);"__parsed_extra"===n?(s[n]=s[n]||[],s[n].push(r)):s[n]=r}return t$jscomp$0.header&&(o>_$jscomp$0.length?I("FieldMismatch","TooManyFields","Too many fields: expected "+_$jscomp$0.length+" fields but parsed "+o,d$jscomp$0+i):o<_$jscomp$0.length&&I("FieldMismatch","TooFewFields","Too few fields: expected "+_$jscomp$0.length+" fields but parsed "+o,d$jscomp$0+i)),s}if(!y$jscomp$0||!t$jscomp$0.header&&
!t$jscomp$0.dynamicTyping&&!t$jscomp$0.transform)return y$jscomp$0;var i$jscomp$0=1;!y$jscomp$0.data.length||Array.isArray(y$jscomp$0.data[0])?(y$jscomp$0.data=y$jscomp$0.data.map(e$jscomp$0),i$jscomp$0=y$jscomp$0.data.length):y$jscomp$0.data=e$jscomp$0(y$jscomp$0.data,0);t$jscomp$0.header&&y$jscomp$0.meta&&(y$jscomp$0.meta.fields=_$jscomp$0);return d$jscomp$0+=i$jscomp$0,y$jscomp$0}()}function S(e$jscomp$0,i){return function(e){return t$jscomp$0.dynamicTypingFunction&&void 0===t$jscomp$0.dynamicTyping[e]&&
(t$jscomp$0.dynamicTyping[e]=t$jscomp$0.dynamicTypingFunction(e)),!0===(t$jscomp$0.dynamicTyping[e]||t$jscomp$0.dynamicTyping)}(e$jscomp$0)?"true"===i||"TRUE"===i||"false"!==i&&"FALSE"!==i&&(function(t){return l$jscomp$1.test(t)&&(t=parseFloat(t),t>r$jscomp$1&&t<s$jscomp$1)?!0:!1}(i)?parseFloat(i):h$jscomp$1.test(i)?new Date(i):""===i?null:i):i}function I(t,e,i,o){t={type:t,code:e,message:i};void 0!==o&&(t.row=o);y$jscomp$0.errors.push(t)}var e$jscomp$2,i$jscomp$1,o$jscomp$0,s$jscomp$1=Math.pow(2,
53),r$jscomp$1=-s$jscomp$1,l$jscomp$1=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,h$jscomp$1=/^(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))$/,a$jscomp$0=this,c$jscomp$0=0,d$jscomp$0=0,u$jscomp$0=!1,p$jscomp$0=!1,_$jscomp$0=[],y$jscomp$0={data:[],errors:[],meta:{}};if(w(t$jscomp$0.step)){var v$jscomp$0=t$jscomp$0.step;t$jscomp$0.step=
function(e){if(y$jscomp$0=e,t$jscomp$0.header&&0===_$jscomp$0.length)C();else if(C(),0!==y$jscomp$0.data.length)c$jscomp$0+=e.data.length,t$jscomp$0.preview&&c$jscomp$0>t$jscomp$0.preview?i$jscomp$1.abort():(y$jscomp$0.data=y$jscomp$0.data[0],v$jscomp$0(y$jscomp$0,a$jscomp$0))}}this.parse=function(s$jscomp$0,r$jscomp$0,l$jscomp$0){var h$jscomp$0=t$jscomp$0.quoteChar||'"';(t$jscomp$0.newline||(t$jscomp$0.newline=function(t,e){t=t.substring(0,1048576);e=new RegExp(f$jscomp$0(e)+"([^]*?)"+f$jscomp$0(e),
"gm");e=(t=t.replace(e,"")).split("\r");t=t.split("\n");t=1<t.length&&t[0].length<e[0].length;if(1===e.length||t)return"\n";for(var l=t=0;l<e.length;l++)"\n"===e[l][0]&&t++;return t>=e.length/2?"\r\n":"\r"}(s$jscomp$0,h$jscomp$0)),o$jscomp$0=!1,t$jscomp$0.delimiter)?w(t$jscomp$0.delimiter)&&(t$jscomp$0.delimiter=t$jscomp$0.delimiter(s$jscomp$0),y$jscomp$0.meta.delimiter=t$jscomp$0.delimiter):(h$jscomp$0=function(e,i,o,s,r){var l,h,c;r=r||[",","\t","|",";",n$jscomp$0.RECORD_SEP,n$jscomp$0.UNIT_SEP];
for(var d=0;d<r.length;d++){var u=r[d],p=0,f=0,_=0;var a=void 0;for(var y=(new g$jscomp$0({comments:s,delimiter:u,newline:i,preview:10})).parse(e),v=0;v<y.data.length;v++)if(o&&x(y.data[v]))_++;else{var m=y.data[v].length;f+=m;void 0!==a?0<m&&(p+=Math.abs(m-a),a=m):a=m}0<y.data.length&&(f/=y.data.length-_);(void 0===h||p<=h)&&(void 0===c||f>c)&&1.99<f&&(h=p,l=u,c=f)}return t$jscomp$0.delimiter=l,{successful:!!l,bestDelimiter:l}}(s$jscomp$0,t$jscomp$0.newline,t$jscomp$0.skipEmptyLines,t$jscomp$0.comments,
t$jscomp$0.delimitersToGuess),h$jscomp$0.successful?t$jscomp$0.delimiter=h$jscomp$0.bestDelimiter:(o$jscomp$0=!0,t$jscomp$0.delimiter=n$jscomp$0.DefaultDelimiter),y$jscomp$0.meta.delimiter=t$jscomp$0.delimiter);h$jscomp$0=m$jscomp$0(t$jscomp$0);return t$jscomp$0.preview&&t$jscomp$0.header&&h$jscomp$0.preview++,e$jscomp$2=s$jscomp$0,i$jscomp$1=new g$jscomp$0(h$jscomp$0),y$jscomp$0=i$jscomp$1.parse(e$jscomp$2,r$jscomp$0,l$jscomp$0),C(),u$jscomp$0?{meta:{paused:!0}}:y$jscomp$0||{meta:{paused:!1}}};this.paused=
function(){return u$jscomp$0};this.pause=function(){u$jscomp$0=!0;i$jscomp$1.abort();e$jscomp$2=w(t$jscomp$0.chunk)?"":e$jscomp$2.substring(i$jscomp$1.getCharIndex())};this.resume=function(){a$jscomp$0.streamer._halted?(u$jscomp$0=!1,a$jscomp$0.streamer.parseChunk(e$jscomp$2,!0)):setTimeout(a$jscomp$0.resume,3)};this.aborted=function(){return p$jscomp$0};this.abort=function(){p$jscomp$0=!0;i$jscomp$1.abort();y$jscomp$0.meta.aborted=!0;w(t$jscomp$0.complete)&&t$jscomp$0.complete(y$jscomp$0);e$jscomp$2=
""}}function f$jscomp$0(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$\x26")}function g$jscomp$0(t$jscomp$1){var e$jscomp$0,i$jscomp$0=(t$jscomp$1=t$jscomp$1||{}).delimiter,o=t$jscomp$1.newline,s=t$jscomp$1.comments,r=t$jscomp$1.step,l=t$jscomp$1.preview,h=t$jscomp$1.fastMode,a=e$jscomp$0=void 0===t$jscomp$1.quoteChar?'"':t$jscomp$1.quoteChar;if(void 0!==t$jscomp$1.escapeChar&&(a=t$jscomp$1.escapeChar),("string"!=typeof i$jscomp$0||-1<n$jscomp$0.BAD_DELIMITERS.indexOf(i$jscomp$0))&&(i$jscomp$0=","),
s===i$jscomp$0)throw Error("Comment character same as delimiter");!0===s?s="#":("string"!=typeof s||-1<n$jscomp$0.BAD_DELIMITERS.indexOf(s))&&(s=!1);"\n"!==o&&"\r"!==o&&"\r\n"!==o&&(o="\n");var c=0,d=!1;this.parse=function(t$jscomp$0,n,u){function z(t){m.push(t);b=c}function A(e){var i=0;-1!==e&&(e=t$jscomp$0.substring(N+1,e))&&""===e.trim()&&(i=e.length);return i}function T(e){return u||(void 0===e&&(e=t$jscomp$0.substring(c)),C.push(e),c=p,z(C),v&&M()),E()}function F(e){c=e;z(C);C=[];L=t$jscomp$0.indexOf(o,
c)}function E(t){return{data:m,errors:x,meta:{delimiter:i$jscomp$0,linebreak:o,aborted:d,truncated:!!t,cursor:b+(n||0)}}}function M(){r(E());m=[];x=[]}if("string"!=typeof t$jscomp$0)throw Error("Input must be a string");var p=t$jscomp$0.length,g=i$jscomp$0.length,_=o.length,y=s.length,v=w(r);c=0;var m=[],x=[],C=[],b=0;if(!t$jscomp$0)return E();if(h||!1!==h&&-1===t$jscomp$0.indexOf(e$jscomp$0)){g=t$jscomp$0.split(o);for(_=0;_<g.length;_++){if(C=g[_],c+=C.length,_!==g.length-1)c+=o.length;else if(u)break;
if(!s||C.substring(0,y)!==s){if(v){if(m=[],z(C.split(i$jscomp$0)),M(),d)break}else z(C.split(i$jscomp$0));if(l&&_>=l)return m=m.slice(0,l),E(!0)}}return E()}for(var R=t$jscomp$0.indexOf(i$jscomp$0,c),L=t$jscomp$0.indexOf(o,c),P=new RegExp(f$jscomp$0(a)+f$jscomp$0(e$jscomp$0),"g"),N=t$jscomp$0.indexOf(e$jscomp$0,c);;)if(t$jscomp$0[c]!==e$jscomp$0)if(s&&0===C.length&&t$jscomp$0.substring(c,c+y)===s){if(-1===L)return E();c=L+_;L=t$jscomp$0.indexOf(o,c);R=t$jscomp$0.indexOf(i$jscomp$0,c)}else if(-1!==
R&&(R<L||-1===L))C.push(t$jscomp$0.substring(c,R)),c=R+g,R=t$jscomp$0.indexOf(i$jscomp$0,c);else{if(-1===L)break;if(C.push(t$jscomp$0.substring(c,L)),F(L+_),v&&(M(),d))return E();if(l&&m.length>=l)return E(!0)}else for(N=c,c++;;){if(-1===(N=t$jscomp$0.indexOf(e$jscomp$0,N+1)))return u||x.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:m.length,index:c}),T();if(N===p-1)return T(t$jscomp$0.substring(c,N).replace(P,e$jscomp$0));if(e$jscomp$0!==a||t$jscomp$0[N+1]!==a){if(e$jscomp$0===
a||0===N||t$jscomp$0[N-1]!==a){-1!==R&&R<N+1&&(R=t$jscomp$0.indexOf(i$jscomp$0,N+1));-1!==L&&L<N+1&&(L=t$jscomp$0.indexOf(o,N+1));var k=A(-1===L?R:Math.min(R,L));if(t$jscomp$0.substr(N+1+k,g)===i$jscomp$0){C.push(t$jscomp$0.substring(c,N).replace(P,e$jscomp$0));c=N+1+k+g;t$jscomp$0[N+1+k+g]!==e$jscomp$0&&(N=t$jscomp$0.indexOf(e$jscomp$0,c));R=t$jscomp$0.indexOf(i$jscomp$0,c);L=t$jscomp$0.indexOf(o,c);break}k=A(L);if(t$jscomp$0.substring(N+1+k,N+1+k+_)===o){if(C.push(t$jscomp$0.substring(c,N).replace(P,
e$jscomp$0)),F(N+1+k+_),R=t$jscomp$0.indexOf(i$jscomp$0,c),N=t$jscomp$0.indexOf(e$jscomp$0,c),v&&(M(),d))return E();if(l&&m.length>=l)return E(!0);break}x.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:m.length,index:c});N++}}else N++}return T()};this.abort=function(){d=!0};this.getCharIndex=function(){return c}}function _$jscomp$1(t){var e=t.data;t=o$jscomp$1[e.workerId];var s=!1;if(e.error)t.userError(e.error,e.file);else if(e.results&&e.results.data){var n=
{abort:function(){s=!0;y$jscomp$1(e.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:v$jscomp$1,resume:v$jscomp$1};if(w(t.userStep)){for(var r=0;r<e.results.data.length&&(t.userStep({data:e.results.data[r],errors:e.results.errors,meta:e.results.meta},n),!s);r++);delete e.results}else w(t.userChunk)&&(t.userChunk(e.results,n,e.file),delete e.results)}e.finished&&!s&&y$jscomp$1(e.workerId,e.results)}function y$jscomp$1(t,e){var i=o$jscomp$1[t];w(i.userComplete)&&i.userComplete(e);i.terminate();
delete o$jscomp$1[t]}function v$jscomp$1(){throw Error("Not implemented.");}function m$jscomp$0(t){if("object"!=typeof t||null===t)return t;var e=Array.isArray(t)?[]:{},i;for(i in t)e[i]=m$jscomp$0(t[i]);return e}function x$jscomp$0(t,e){return function(){t.apply(e,arguments)}}function w(t){return"function"==typeof t}var t$jscomp$2=window,e$jscomp$3=!t$jscomp$2.document&&!!t$jscomp$2.postMessage,i$jscomp$2=e$jscomp$3&&/blob:/i.test((t$jscomp$2.location||{}).protocol),o$jscomp$1={},s$jscomp$2=0,n$jscomp$0=
{parse:function(e,i$jscomp$0){var r=(i$jscomp$0=i$jscomp$0||{}).dynamicTyping||!1;w(r)&&(i$jscomp$0.dynamicTypingFunction=r,r={});if(i$jscomp$0.dynamicTyping=r,i$jscomp$0.transform=!!w(i$jscomp$0.transform)&&i$jscomp$0.transform,i$jscomp$0.worker&&n$jscomp$0.WORKERS_SUPPORTED){if(n$jscomp$0.WORKERS_SUPPORTED){r=t$jscomp$2.URL||t$jscomp$2.webkitURL||null;var i=moduleFactory.toString();r=n$jscomp$0.BLOB_URL||(n$jscomp$0.BLOB_URL=r.createObjectURL(new Blob(["(",i,")();"],{type:"text/javascript"})));
r=new t$jscomp$2.Worker(r);r=(r.onmessage=_$jscomp$1,r.id=s$jscomp$2++,o$jscomp$1[r.id]=r,r)}else r=!1;return r.userStep=i$jscomp$0.step,r.userChunk=i$jscomp$0.chunk,r.userComplete=i$jscomp$0.complete,r.userError=i$jscomp$0.error,i$jscomp$0.step=w(i$jscomp$0.step),i$jscomp$0.chunk=w(i$jscomp$0.chunk),i$jscomp$0.complete=w(i$jscomp$0.complete),i$jscomp$0.error=w(i$jscomp$0.error),delete i$jscomp$0.worker,void r.postMessage({input:e,config:i$jscomp$0,workerId:r.id})}r=null;if(e===n$jscomp$0.NODE_STREAM_INPUT&&
"undefined"==typeof PAPA_BROWSER_CONTEXT)return(new u$jscomp$1(i$jscomp$0)).getStream();"string"==typeof e?r=i$jscomp$0.download?new h$jscomp$2(i$jscomp$0):new c$jscomp$1(i$jscomp$0):!0===e.readable&&w(e.read)&&w(e.on)?r=new d$jscomp$1(i$jscomp$0):(t$jscomp$2.File&&e instanceof File||e instanceof Object)&&(r=new a$jscomp$1(i$jscomp$0));return r.stream(e)},unparse:function(t$jscomp$0,e$jscomp$0){function p$jscomp$0(t,e,i){var n="";"string"==typeof t&&(t=JSON.parse(t));"string"==typeof e&&(e=JSON.parse(e));
var l=Array.isArray(t)&&0<t.length,h=!Array.isArray(e[0]);if(l&&o$jscomp$0){for(var a=0;a<t.length;a++)0<a&&(n+=s),n+=g(t[a],a);0<e.length&&(n+=r$jscomp$0)}for(a=0;a<e.length;a++){var d=l?t.length:e[a].length,u=!1,p=l?0===Object.keys(e[a]).length:0===e[a].length;if(i&&!l&&(u="greedy"===i?""===e[a].join("").trim():1===e[a].length&&0===e[a][0].length),"greedy"===i&&l){u=[];for(var _=0;_<d;_++)u.push(e[a][h?t[_]:_]);u=""===u.join("").trim()}if(!u){for(u=0;u<d;u++)0<u&&!p&&(n+=s),n+=g(e[a][l&&h?t[u]:
u],u);a<e.length-1&&(!i||0<d&&!p)&&(n+=r$jscomp$0)}}return n}function g(t,e){if(null==t)return"";if(t.constructor===Date)return JSON.stringify(t).slice(1,25);var o=!1;d$jscomp$0&&"string"==typeof t&&d$jscomp$0.test(t)&&(t="'"+t,o=!0);var r=t.toString().replace(u$jscomp$0,h$jscomp$0);if(!(t=o||!0===i$jscomp$0||"function"==typeof i$jscomp$0&&i$jscomp$0(t,e)||Array.isArray(i$jscomp$0)&&i$jscomp$0[e]))a:{t=n$jscomp$0.BAD_DELIMITERS;for(e=0;e<t.length;e++)if(-1<r.indexOf(t[e])){t=!0;break a}t=!1}return t||
-1<r.indexOf(s)||" "===r.charAt(0)||" "===r.charAt(r.length-1)?l$jscomp$0+r+l$jscomp$0:r}var i$jscomp$0=!1,o$jscomp$0=!0,s=",",r$jscomp$0="\r\n",l$jscomp$0='"',h$jscomp$0=l$jscomp$0+l$jscomp$0,a$jscomp$0=!1,c=null,d$jscomp$0=!1;!function(){if("object"==typeof e$jscomp$0){"string"!=typeof e$jscomp$0.delimiter||n$jscomp$0.BAD_DELIMITERS.filter(function(t){return-1!==e$jscomp$0.delimiter.indexOf(t)}).length||(s=e$jscomp$0.delimiter);("boolean"==typeof e$jscomp$0.quotes||"function"==typeof e$jscomp$0.quotes||
Array.isArray(e$jscomp$0.quotes))&&(i$jscomp$0=e$jscomp$0.quotes);"boolean"!=typeof e$jscomp$0.skipEmptyLines&&"string"!=typeof e$jscomp$0.skipEmptyLines||(a$jscomp$0=e$jscomp$0.skipEmptyLines);"string"==typeof e$jscomp$0.newline&&(r$jscomp$0=e$jscomp$0.newline);"string"==typeof e$jscomp$0.quoteChar&&(l$jscomp$0=e$jscomp$0.quoteChar);"boolean"==typeof e$jscomp$0.header&&(o$jscomp$0=e$jscomp$0.header);if(Array.isArray(e$jscomp$0.columns)){if(0===e$jscomp$0.columns.length)throw Error("Option columns is empty");
c=e$jscomp$0.columns}void 0!==e$jscomp$0.escapeChar&&(h$jscomp$0=e$jscomp$0.escapeChar+l$jscomp$0);("boolean"==typeof e$jscomp$0.escapeFormulae||e$jscomp$0.escapeFormulae instanceof RegExp)&&(d$jscomp$0=e$jscomp$0.escapeFormulae instanceof RegExp?e$jscomp$0.escapeFormulae:/^[=+\-@\t\r].*$/)}}();var u$jscomp$0=new RegExp(f$jscomp$0(l$jscomp$0),"g");"string"==typeof t$jscomp$0&&(t$jscomp$0=JSON.parse(t$jscomp$0));if(Array.isArray(t$jscomp$0)){if(!t$jscomp$0.length||Array.isArray(t$jscomp$0[0]))return p$jscomp$0(null,
t$jscomp$0,a$jscomp$0);if("object"==typeof t$jscomp$0[0])return p$jscomp$0(c||Object.keys(t$jscomp$0[0]),t$jscomp$0,a$jscomp$0)}else if("object"==typeof t$jscomp$0)return"string"==typeof t$jscomp$0.data&&(t$jscomp$0.data=JSON.parse(t$jscomp$0.data)),Array.isArray(t$jscomp$0.data)&&(t$jscomp$0.fields||(t$jscomp$0.fields=t$jscomp$0.meta&&t$jscomp$0.meta.fields),t$jscomp$0.fields||(t$jscomp$0.fields=Array.isArray(t$jscomp$0.data[0])?t$jscomp$0.fields:"object"==typeof t$jscomp$0.data[0]?Object.keys(t$jscomp$0.data[0]):
[]),Array.isArray(t$jscomp$0.data[0])||"object"==typeof t$jscomp$0.data[0]||(t$jscomp$0.data=[t$jscomp$0.data])),p$jscomp$0(t$jscomp$0.fields||[],t$jscomp$0.data||[],a$jscomp$0);throw Error("Unable to serialize unrecognized input");}};if(n$jscomp$0.RECORD_SEP=String.fromCharCode(30),n$jscomp$0.UNIT_SEP=String.fromCharCode(31),n$jscomp$0.BYTE_ORDER_MARK="﻿",n$jscomp$0.BAD_DELIMITERS=["\r","\n",'"',n$jscomp$0.BYTE_ORDER_MARK],n$jscomp$0.WORKERS_SUPPORTED=!e$jscomp$3&&!!t$jscomp$2.Worker,n$jscomp$0.NODE_STREAM_INPUT=
1,n$jscomp$0.LocalChunkSize=10485760,n$jscomp$0.RemoteChunkSize=5242880,n$jscomp$0.DefaultDelimiter=",",n$jscomp$0.Parser=g$jscomp$0,n$jscomp$0.ParserHandle=p$jscomp$1,n$jscomp$0.NetworkStreamer=h$jscomp$2,n$jscomp$0.FileStreamer=a$jscomp$1,n$jscomp$0.StringStreamer=c$jscomp$1,n$jscomp$0.ReadableStreamStreamer=d$jscomp$1,"undefined"==typeof PAPA_BROWSER_CONTEXT&&(n$jscomp$0.DuplexStreamStreamer=u$jscomp$1),t$jscomp$2.jQuery){var r$jscomp$2=t$jscomp$2.jQuery;r$jscomp$2.fn.parse=function(e$jscomp$0){function s$jscomp$0(){if(0!==
o.length){var i,s,h,a=o[0];if(w(e$jscomp$0.before)){var c=e$jscomp$0.before(a.file,a.inputElem);if("object"==typeof c){if("abort"===c.action)return i=a.file,s=a.inputElem,h=c.reason,void(w(e$jscomp$0.error)&&e$jscomp$0.error({name:"AbortError"},i,s,h));if("skip"===c.action)return void l();"object"==typeof c.config&&(a.instanceConfig=r$jscomp$2.extend(a.instanceConfig,c.config))}else if("skip"===c)return void l()}var d=a.instanceConfig.complete;a.instanceConfig.complete=function(t){w(d)&&d(t,a.file,
a.inputElem);l()};n$jscomp$0.parse(a.file,a.instanceConfig)}else w(e$jscomp$0.complete)&&e$jscomp$0.complete()}function l(){o.splice(0,1);s$jscomp$0()}var i$jscomp$0=e$jscomp$0.config||{},o=[];return this.each(function(e){if("INPUT"!==r$jscomp$2(this).prop("tagName").toUpperCase()||"file"!==r$jscomp$2(this).attr("type").toLowerCase()||!t$jscomp$2.FileReader||!this.files||0===this.files.length)return!0;for(e=0;e<this.files.length;e++)o.push({file:this.files[e],inputElem:this,instanceConfig:r$jscomp$2.extend({},
i$jscomp$0)})}),s$jscomp$0(),this}}return i$jscomp$2&&(t$jscomp$2.onmessage=function(e){e=e.data;void 0===n$jscomp$0.WORKER_ID&&e&&(n$jscomp$0.WORKER_ID=e.workerId);"string"==typeof e.input?t$jscomp$2.postMessage({workerId:n$jscomp$0.WORKER_ID,results:n$jscomp$0.parse(e.input,e.config),finished:!0}):(t$jscomp$2.File&&e.input instanceof File||e.input instanceof Object)&&(e=n$jscomp$0.parse(e.input,e.config))&&t$jscomp$2.postMessage({workerId:n$jscomp$0.WORKER_ID,results:e,finished:!0})}),h$jscomp$2.prototype=
Object.create(l$jscomp$2.prototype),h$jscomp$2.prototype.constructor=h$jscomp$2,a$jscomp$1.prototype=Object.create(l$jscomp$2.prototype),a$jscomp$1.prototype.constructor=a$jscomp$1,c$jscomp$1.prototype=Object.create(c$jscomp$1.prototype),c$jscomp$1.prototype.constructor=c$jscomp$1,d$jscomp$1.prototype=Object.create(l$jscomp$2.prototype),d$jscomp$1.prototype.constructor=d$jscomp$1,"undefined"==typeof PAPA_BROWSER_CONTEXT&&(u$jscomp$1.prototype=Object.create(l$jscomp$2.prototype),u$jscomp$1.prototype.constructor=
u$jscomp$1),n$jscomp$0}(),Kr={inputBar:{name:"inputBar",grow:1,node:function(){var t={name:"inputField",tag:"input",style:Y[".dgxl-inputField"].call(this),type:"text"};return this.allowEditCells||(t.disabled="disabled"),{name:"inputWrapper",style:Y[".dgxl-inputWrapper"].call(this),children:[{name:"inputInfo",style:Y[".dgxl-inputInfo"].call(this),text:""},t]}},events:{ready:function(t,e){var i=this;setTimeout(function(){null!=i._cellCursorPosition&&(i.getRowIdByCoord(i._cellCursorPosition.y),i.getColIdByCoord(i._cellCursorPosition.x),
t.inputField.value=i.getCellValue(i._cellCursorPosition),t.inputInfo.textContent=i.getSpreadsheetCoords(i._cellCursorPosition))},0)},setselection:function(t,e){var i=this;setTimeout(function(){i.getRowIdByCoord(e.cellCursorPosition.y);i.getColIdByCoord(e.cellCursorPosition.x);t.inputField.value=i.getCellValue(e.cellCursorPosition);t.inputInfo.textContent=i.getSpreadsheetCoords(e.cellCursorPosition)},0)},closeeditor:function(t,e){t.inputField.value=this.getCellValue(this._cellCursorPosition)},celleditorinput:function(t,
e){t.inputField.value=e.value}},listeners:{"inputField.input":function(t,e){this.setCellEditorValue(e.target.value)},"inputField.focus":function(t,e){t.inputWrapper.classList.add("dgxl-hasFocus");P$jscomp$0(t.inputWrapper,Y[".dgxl-inputWrapper.dgxl-hasFocus"].call(this))},"inputField.blur":function(t,e){t.inputWrapper.classList.remove("dgxl-hasFocus");P$jscomp$0(t.inputWrapper,Y["reset|.dgxl-inputWrapper.dgxl-hasFocus"].call(this))}},keys:{inputField:["tab_navigateNext","shiftTab_navigatePrev","enter_navigateNext",
"shiftEnter_navigatePrev",{keys:"esc",action:function(t,e){this.closeCellEditor();t.inputField.value="";t.inputField.blur()},repeat:!1}]},update:function(t){}},searchBar:{name:"searchBar",grow:1,node:function(){var t='\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" height\x3d"24px" viewBox\x3d"0 0 24 24" width\x3d"24px" style\x3d"'+k$jscomp$0(Y[".dgxl-part button svg"].call(this))+'"\x3e\x3cpath d\x3d"M0 0h24v24H0V0z" fill\x3d"none"/\x3e\x3cpath d\x3d"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14l-6-6z"/\x3e\x3c/svg\x3e',
e='\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" height\x3d"24px" viewBox\x3d"0 0 24 24" width\x3d"24px" style\x3d"'+k$jscomp$0(Y[".dgxl-part button svg"].call(this))+'"\x3e\x3cpath d\x3d"M24 24H0V0h24v24z" fill\x3d"none" opacity\x3d".87"/\x3e\x3cpath d\x3d"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6-1.41-1.41z"/\x3e\x3c/svg\x3e';return{style:{display:"flex","flex-grow":1,"grid-gap":"2px"},children:[{name:"inputWrapper",style:Y[".dgxl-inputWrapper"].call(this),children:[{name:"inputInfo",style:Y[".dgxl-inputInfo"].call(this),
text:""},{name:"inputField",tag:"input",style:Y[".dgxl-inputField"].call(this),placeholder:"Search",value:""}]},{name:"searchCellButtonPrev",tag:"button",style:Y[".dgxl-part button"].call(this),html:t,disabled:!0},{name:"searchCellButtonNext",tag:"button",style:Y[".dgxl-part button"].call(this),html:e,disabled:!0}]}},listeners:{"inputField.input":function(t,e){this.search(e.target.value)},"searchCellButtonPrev.click":function(t,e){this.searchPrev()},"searchCellButtonNext.click":function(t,e){this.searchNext()},
"inputField.focus":function(t,e){t.inputWrapper.classList.add("dgxl-hasFocus");P$jscomp$0(t.inputWrapper,Y[".dgxl-inputWrapper.dgxl-hasFocus"].call(this))},"inputField.blur":function(t,e){t.inputWrapper.classList.remove("dgxl-hasFocus");P$jscomp$0(t.inputWrapper,Y["reset|.dgxl-inputWrapper.dgxl-hasFocus"].call(this))}},keys:{inputField:[{keys:"enter",action:function(t){this.searchNext()},repeat:!0},{keys:"shift+enter",action:function(t){this.searchPrev()},repeat:!0},{keys:"esc",action:function(t,
e){this.clearSearch();t.inputField.value="";t.inputField.blur()}}]},update:function(t){t.inputField.value=this._searchStr;var e="$n\x3d"+(this._searchCellIndex+1)+" from $total\x3d"+this._searchCellsFound.length;this._searchCellsFound.length?(t.inputInfo.textContent=this.getLocaleSetting(e),t.searchCellButtonNext.removeAttribute("disabled"),t.searchCellButtonPrev.removeAttribute("disabled")):(this._searchStr?t.inputInfo.textContent=this.getLocaleSetting(e):t.inputInfo.textContent="",t.searchCellButtonNext.setAttribute("disabled",
!0),t.searchCellButtonPrev.setAttribute("disabled",!0))}},fullscreenButton:{name:"fullscreenButton",node:function(){var t='\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" height\x3d"24px" viewBox\x3d"0 0 24 24" width\x3d"24px" style\x3d"'+k$jscomp$0(Y[".dgxl-part button svg"].call(this))+'"\x3e\x3cpath d\x3d"M0 0h24v24H0V0z" fill\x3d"none"/\x3e\x3cpath d\x3d"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/\x3e\x3c/svg\x3e',e='\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" height\x3d"24px" viewBox\x3d"0 0 24 24" width\x3d"24px" style\x3d"'+
k$jscomp$0(Y[".dgxl-part button svg"].call(this))+'"\x3e\x3cpath d\x3d"M0 0h24v24H0V0z" fill\x3d"none"/\x3e\x3cpath d\x3d"M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/\x3e\x3c/svg\x3e';return{tag:"button",name:"fullscreenButton",style:Y[".dgxl-part button"].call(this),html:t,_iconEnter:t,_iconLeave:e}},listeners:{"fullscreenButton.click":function(t){this.toggleFullscreen()}},events:{fullscreenenter:function(t){this.constructor._isIOS&&t.fullscreenButton.setAttribute("disabled",
!0);t.fullscreenButton.innerHTML=t.fullscreenButton._iconLeave},fullscreenleave:function(t){this.constructor._isIOS&&t.fullscreenButton.removeAttribute("disabled");t.fullscreenButton.innerHTML=t.fullscreenButton._iconEnter}}},credits:{name:"credits",node:function(){return{name:"credits",style:{display:"flex","align-items":"center",height:"100%","aspect-ratio":1},html:'\x3ca style\x3d"display:flex;height:100%;aspect-ratio:1;" title\x3d"Excel-like experience by DataGridXL" href\x3d"https://datagridxl.com"\x3e\x3cimg style\x3d"height:100%;aspect-ratio:1;" src\x3d"'+
(this.cacheCredits?"https://resources.datagridxl.com/dgxl-logo-icon.svg":"data:image/svg+xml,%0A%3Csvg version\x3d'1.2' baseProfile\x3d'tiny-ps' xmlns\x3d'http://www.w3.org/2000/svg' viewBox\x3d'0 0 179 179' width\x3d'16' height\x3d'16'%3E%3Ctitle%3ENew Project-svg%3C/title%3E%3Cstyle%3E tspan %7B white-space:pre %7D .shp0 %7B fill: %23138046 %7D .shp1 %7B fill: %23000000 %7D .shp2 %7B fill: %23ffffff %7D %3C/style%3E%3Cg id\x3d'NEW'%3E%3Cpath id\x3d'Layer 3 copy' class\x3d'shp0' d\x3d'M20 0L159 0C170.06 0 179 8.94 179 20L179 159C179 170.06 170.06 179 159 179L20 179C8.94 179 0 170.06 0 159L0 20C0 8.94 8.94 0 20 0Z' /%3E%3Cpath id\x3d'datagrid ' fill-rule\x3d'evenodd' class\x3d'shp1' d\x3d'M-582.44 64.02C-570.4 64.02 -559.34 70.18 -554.02 79L-554.02 38.4L-541.14 38.4L-541.14 142L-554.02 142L-554.02 127.58C-558.64 136.12 -568.58 143.26 -582.58 143.26C-603.16 143.26 -618.98 127.16 -618.98 103.36C-618.98 79.42 -603.16 64.02 -582.44 64.02ZM-580.06 75.08C-594.06 75.08 -605.96 85.3 -605.96 103.36C-605.96 121.42 -594.06 132.06 -580.06 132.06C-566.06 132.06 -554.02 121.56 -554.02 103.5C-554.02 85.72 -566.06 75.08 -580.06 75.08ZM-487.94 64.02C-473.66 64.02 -463.86 71.3 -459.38 79.28L-459.38 65.28L-446.5 65.28L-446.5 142L-459.38 142L-459.38 127.72C-464 135.98 -473.94 143.26 -488.08 143.26C-508.52 143.26 -524.34 127.16 -524.34 103.36C-524.34 79.42 -508.52 64.02 -487.94 64.02ZM-485.42 75.08C-499.42 75.08 -511.32 85.3 -511.32 103.36C-511.32 121.42 -499.42 132.06 -485.42 132.06C-471.42 132.06 -459.38 121.56 -459.38 103.5C-459.38 85.72 -471.42 75.08 -485.42 75.08ZM-422.14 75.78L-432.08 75.78L-432.08 65.28L-422.14 65.28L-422.14 45.96L-409.4 45.96L-409.4 65.28L-389.38 65.28L-389.38 75.78L-409.4 75.78L-409.4 121C-409.4 128.56 -406.6 131.22 -398.76 131.22L-389.38 131.22L-389.38 142L-400.86 142C-414.44 142 -422.14 136.4 -422.14 121L-422.14 75.78ZM-342.34 64.02C-328.06 64.02 -318.26 71.3 -313.78 79.28L-313.78 65.28L-300.9 65.28L-300.9 142L-313.78 142L-313.78 127.72C-318.4 135.98 -328.34 143.26 -342.48 143.26C-362.92 143.26 -378.74 127.16 -378.74 103.36C-378.74 79.42 -362.92 64.02 -342.34 64.02ZM-339.82 75.08C-353.82 75.08 -365.72 85.3 -365.72 103.36C-365.72 121.42 -353.82 132.06 -339.82 132.06C-325.82 132.06 -313.78 121.56 -313.78 103.5C-313.78 85.72 -325.82 75.08 -339.82 75.08ZM-247.7 64.02C-233.7 64.02 -223.62 71.02 -219.14 79.28L-219.14 65.28L-206.26 65.28L-206.26 143.68C-206.26 164.82 -220.4 179.8 -242.94 179.8C-263.1 179.8 -277.52 169.58 -280.04 153.2L-267.44 153.2C-264.64 162.44 -255.54 168.74 -242.94 168.74C-229.36 168.74 -219.14 160.06 -219.14 143.68L-219.14 127.58C-223.76 135.84 -233.7 143.26 -247.7 143.26C-268.28 143.26 -284.1 127.16 -284.1 103.36C-284.1 79.42 -268.28 64.02 -247.7 64.02ZM-245.18 75.08C-259.18 75.08 -271.08 85.3 -271.08 103.36C-271.08 121.42 -259.18 132.06 -245.18 132.06C-231.18 132.06 -219.14 121.56 -219.14 103.5C-219.14 85.72 -231.18 75.08 -245.18 75.08ZM-171.96 142L-184.7 142L-184.7 65.28L-171.96 65.28L-171.96 77.74C-167.62 69.2 -159.36 63.88 -147.18 63.88L-147.18 77.04L-150.54 77.04C-162.72 77.04 -171.96 82.5 -171.96 100.28L-171.96 142ZM-132.48 65.28L-119.74 65.28L-119.74 142L-132.48 142L-132.48 65.28ZM-134.58 44.14C-134.58 39.24 -130.8 35.46 -125.9 35.46C-121.28 35.46 -117.5 39.24 -117.5 44.14C-117.5 49.04 -121.28 52.82 -125.9 52.82C-130.8 52.82 -134.58 49.04 -134.58 44.14ZM-66.26 64.02C-54.22 64.02 -43.16 70.18 -37.84 79L-37.84 38.4L-24.96 38.4L-24.96 142L-37.84 142L-37.84 127.58C-42.46 136.12 -52.4 143.26 -66.4 143.26C-86.98 143.26 -102.8 127.16 -102.8 103.36C-102.8 79.42 -86.98 64.02 -66.26 64.02ZM-63.88 75.08C-77.88 75.08 -89.78 85.3 -89.78 103.36C-89.78 121.42 -77.88 132.06 -63.88 132.06C-49.88 132.06 -37.84 121.56 -37.84 103.5C-37.84 85.72 -49.88 75.08 -63.88 75.08Z' /%3E%3Cpath id\x3d'XL ' class\x3d'shp2' d\x3d'M62 79L75.5 57L95.5 57L73 92L96 127L76 127L62 105L48 127L28 127L51 92L28.5 57L48.4 57L62 79ZM119 57L119 113L155.5 113L155.5 127L101 127L101 57L119 57Z' /%3E%3C/g%3E%3C/svg%3E")+
'"\x3e\x3c/a\x3e'}}}},jr={tab_navigateNext:{keys:"tab",action:function(){this.moveCellCursorInsideSelection({x:1,y:0})},repeat:!0},shiftTab_navigatePrev:{keys:"shift+tab",action:function(){this.moveCellCursorInsideSelection({x:-1,y:0})},repeat:!0},enter_navigateNext:{keys:"enter",action:function(){this.moveCellCursorInsideSelection({x:0,y:1})},repeat:!0},shiftEnter_navigatePrev:{keys:"shift+enter",action:function(){this.moveCellCursorInsideSelection({x:0,y:-1})},repeat:!0},enter_openCellEditor:{keys:"enter",
action:function(){this.openCellEditor("edit")},repeat:!1,active:function(){return this.allowEditCells}},pageDown_moveCellCursorOneViewportDown:{keys:"pagedown",action:function(){this.moveCellCursorOneViewportDown()},repeat:!0},pageUp_moveCellCursorOneViewportUp:{keys:"pageup",action:function(){this.moveCellCursorOneViewportUp()},repeat:!0},home_moveCellCursorToRowStart:{keys:"home",action:function(){this.moveCellCursorToRowStart()},repeat:!1},end_moveCellCursorToRowEnd:{keys:"end",action:function(){this.moveCellCursorToRowEnd()},
repeat:!1},ctrlLeftArrow_moveCellCursorToRowStart:{keys:"ctrl+left",action:function(){this.moveCellCursorToRowStart()},repeat:!1},ctrlRightArrow_moveCellCursorToRowEnd:{keys:"ctrl+right",action:function(){this.moveCellCursorToRowEnd()},repeat:!1},ctrlUpArrow_moveCellCursorToColStart:{keys:"ctrl+up",action:function(){this.moveCellCursorToColStart()},repeat:!1},ctrlDownArrow_moveCellCursorToColEnd:{keys:"ctrl+down",action:function(){this.moveCellCursorToColEnd()},repeat:!1},ctrlHome_moveCellCursorToSheetStart:{keys:"ctrl+home",
action:function(){this.moveCellCursorToSheetStart()},repeat:!1},ctrlEnd_moveCellCursorToSheetEnd:{keys:"ctrl+end",action:function(){this.moveCellCursorToSheetEnd()},repeat:!1},rightArrow_moveCellCursorRight:{keys:"right",action:function(){this.moveCellCursor({x:1,y:0})},repeat:!0},downArrow_moveCellCursorDown:{keys:"down",action:function(){this.moveCellCursor({x:0,y:1})},repeat:!0},leftArrow_moveCellCursorLeft:{keys:"left",action:function(){this.moveCellCursor({x:-1,y:0})},repeat:!0},upArrow_moveCellCursorUp:{keys:"up",
action:function(){this.moveCellCursor({x:0,y:-1})},repeat:!0},shiftRightArrow_modifyActiveRangeRightwards:{keys:"shift+right",action:function(){this.modifyActiveRange("right")},repeat:!0},shiftDownArrow_modifyActiveRangeDownwards:{keys:"shift+down",action:function(){this.modifyActiveRange("down")},repeat:!0},shiftLeftArrow_modifyActiveRangeLeftwards:{keys:"shift+left",action:function(){this.modifyActiveRange("left")},repeat:!0},shiftUpArrow_modifyActiveRangeUpwards:{keys:"shift+up",action:function(){this.modifyActiveRange("up")},
repeat:!0},ctrlZ_undo:{keys:"ctrl+z",action:function(t){this.undo();t.preventDefault()},repeat:!1},ctrlY_redo:{keys:"ctrl+y",action:function(t){this.redo();t.preventDefault()},repeat:!1},ctrlShiftZ_redo:{keys:"ctrl+shift+z",action:function(t){this.redo();t.preventDefault()},repeat:!1},ctrlA_selectAll:{keys:"ctrl+a",action:function(t){this.selectAll(!1)},repeat:!1},backspace_clearCellValues:{keys:"backspace",action:function(){this.clearCellValues(this._selection)},repeat:!1,active:function(){return this.allowEditCells}},
delete_clearCellValues:{keys:"delete",action:function(){this.clearCellValues(this._selection)},repeat:!1,active:function(){return this.allowEditCells}},esc_closeCellEditor:{keys:"esc",action:function(){this.closeCellEditor()},repeat:!1},ctrlShiftSlash_openContextMenu:{keys:"ctrl+shift+\\",action:function(){this.openContextMenu()},repeat:!1},esc_closeContextMenu:{keys:"esc",action:function(){this.constructor.contextMenu.close()},repeat:!1},downArrow_moveContextMenuCursorDown:{keys:"down",action:function(){this.constructor.contextMenu.moveCursorDown()},
repeat:!0},upArrow_moveContextMenuCursorUp:{keys:"up",action:function(){this.constructor.contextMenu.moveCursorUp()},repeat:!0},enter_hitContextMenuItem:{keys:"enter",action:function(){this.constructor.contextMenu.triggerHit()},repeat:!1}},Zr={cut:{label:"Cut",method:function(){this.cut()},shortcut:"Ctrl+X",shortcutMac:"⌘X",include:function(){return this.allowCut}},copy:{label:"Copy",method:function(){this.copy()},shortcut:"Ctrl+C",shortcutMac:"⌘C",include:function(){return this.allowCopy}},paste:{label:"Paste",
method:function(){this.paste()},shortcut:"Ctrl+V",shortcutMac:"⌘V",include:function(){return this.allowPaste}},delete_rows:{label:"Delete Row(s)",method:function(){this.deleteRows(this.getRowSelection())},disabled:function(){return!this.getRowSelection().length},include:function(){return this.allowDeleteRows}},insert_rows_before:{label:function(){var t=this.getRowSelection();if(!t.length)return"Insert Row (up)";t=t[0][1]-t[0][0]+1;return 1==t?"Insert Row (up)":"Insert $n\x3d"+t+" Rows (up)"},method:function(){var t=
this.getRowSelection();this.insertEmptyRows(t[0][1]-t[0][0]+1,this.getRowSelection()[0][0])},disabled:function(){},include:function(){return this.allowInsertRows&&1==this.getRowSelection().length}},insert_rows_after:{label:function(){var t=this.getRowSelection();if(!t.length)return"Insert Row (down)";t=t[0][1]-t[0][0]+1;return 1==t?"Insert Row (down)":"Insert $n\x3d"+t+" Rows (down)"},method:function(){var t=this.getRowSelection();this.insertEmptyRows(t[0][1]-t[0][0]+1,this.getRowSelection()[0][1]+
1)},disabled:function(){},include:function(){return this.allowInsertRows&&1==this.getRowSelection().length}},hide_rows:{label:function(){var t=this.getRowSelection();if(!t.length)return"Hide Row";t=t[0][1]-t[0][0]+1;return 1==t?"Hide Row":"Hide $n\x3d"+t+" Rows"},method:function(){this.hideRows(this.getRowSelection())},disabled:function(){return!this.getRowSelection().length},include:function(){return this.allowHideRows}},delete_cols:{label:"Delete Column(s)",method:function(){this.deleteCols(this.getColSelection())},
disabled:function(){return!this.getColSelection().length},include:function(){return this.allowDeleteCols}},insert_cols_before:{label:function(){var t=this.getColSelection();if(!t.length)return"Insert Column (left)";t=t[0][1]-t[0][0]+1;return 1==t?"Insert Column (left)":"Insert $n\x3d"+t+" Columns (left)"},method:function(){var t=this.getColSelection();this.insertEmptyCols(t[0][1]-t[0][0]+1,this.getColSelection()[0][0])},disabled:function(){},include:function(){return this.allowInsertCols&&1==this.getColSelection().length}},
insert_cols_after:{label:function(){var t=this.getColSelection();if(!t.length)return"Insert Column (right)";t=t[0][1]-t[0][0]+1;return 1==t?"Insert Column (right)":"Insert $n\x3d"+t+" Columns (right)"},method:function(){var t=this.getColSelection();this.insertEmptyCols(t[0][1]-t[0][0]+1,this.getColSelection()[0][1]+1)},disabled:function(){},include:function(){return this.allowInsertCols&&1==this.getColSelection().length}},hide_cols:{label:function(){var t=this.getColSelection();if(!t.length)return"Hide Column";
t=t[0][1]-t[0][0]+1;return 1==t?"Hide Column":"Hide $n\x3d"+t+" Columns"},method:function(){this.hideCols(this.getColSelection())},disabled:function(){return!this.getColSelection().length},include:function(){return this.allowHideCols}},sort_asc:{label:"Sort A to Z",method:function(){this.sort(this._cellCursorPosition.x,"asc")},disabled:function(){return!this.getColSelection().length},include:function(){return this.allowSort}},sort_desc:{label:"Sort Z to A",method:function(){this.sort(this._cellCursorPosition.x,
"desc")},disabled:function(){return!this.getColSelection().length},include:function(){return this.allowSort}}},$r={numbers:{indexToLabel:function(t){return String(1+t)},labelToIndex:function(t){return Number(t)-1}},letters:{indexToLabel:function(t){var e="";for(t++;0<t--;t=(t-t%26)/26)e=String.fromCharCode(t%26+65)+e;return e},labelToIndex:function(t){for(var e=0,i=0;i<t.length;i++)e=26*e+t.charCodeAt(i)-64;return e-1}}},Qr=["searchBar"],Jr=["fullscreenButton","inputBar","credits"],il={traverseSingleCell:"rightArrow_moveCellCursorRight downArrow_moveCellCursorDown leftArrow_moveCellCursorLeft upArrow_moveCellCursorUp tab_navigateNext shiftTab_navigatePrev enter_openCellEditor pageDown_moveCellCursorOneViewportDown pageUp_moveCellCursorOneViewportUp home_moveCellCursorToRowStart end_moveCellCursorToRowEnd ctrlLeftArrow_moveCellCursorToRowStart ctrlRightArrow_moveCellCursorToRowEnd ctrlUpArrow_moveCellCursorToColStart ctrlDownArrow_moveCellCursorToColEnd ctrlHome_moveCellCursorToSheetStart ctrlEnd_moveCellCursorToSheetEnd shiftRightArrow_modifyActiveRangeRightwards shiftDownArrow_modifyActiveRangeDownwards shiftLeftArrow_modifyActiveRangeLeftwards shiftUpArrow_modifyActiveRangeUpwards backspace_clearCellValues delete_clearCellValues ctrlZ_undo ctrlY_redo ctrlShiftZ_redo ctrlA_selectAll ctrlShiftSlash_openContextMenu".split(" "),
traverseMultiCell:"rightArrow_moveCellCursorRight downArrow_moveCellCursorDown leftArrow_moveCellCursorLeft upArrow_moveCellCursorUp tab_navigateNext shiftTab_navigatePrev enter_navigateNext shiftEnter_navigatePrev pageDown_moveCellCursorOneViewportDown pageUp_moveCellCursorOneViewportUp home_moveCellCursorToRowStart end_moveCellCursorToRowEnd ctrlLeftArrow_moveCellCursorToRowStart ctrlRightArrow_moveCellCursorToRowEnd ctrlUpArrow_moveCellCursorToColStart ctrlDownArrow_moveCellCursorToColEnd ctrlHome_moveCellCursorToSheetStart ctrlEnd_moveCellCursorToSheetEnd shiftRightArrow_modifyActiveRangeRightwards shiftDownArrow_modifyActiveRangeDownwards shiftLeftArrow_modifyActiveRangeLeftwards shiftUpArrow_modifyActiveRangeUpwards backspace_clearCellValues delete_clearCellValues ctrlZ_undo ctrlY_redo ctrlShiftZ_redo ctrlA_selectAll ctrlShiftSlash_openContextMenu".split(" "),
inputModeEnter:"rightArrow_moveCellCursorRight downArrow_moveCellCursorDown leftArrow_moveCellCursorLeft upArrow_moveCellCursorUp tab_navigateNext shiftTab_navigatePrev enter_navigateNext shiftEnter_navigatePrev pageDown_moveCellCursorOneViewportDown pageUp_moveCellCursorOneViewportUp home_moveCellCursorToRowStart end_moveCellCursorToRowEnd ctrlLeftArrow_moveCellCursorToRowStart ctrlRightArrow_moveCellCursorToRowEnd ctrlUpArrow_moveCellCursorToColStart ctrlDownArrow_moveCellCursorToColEnd ctrlHome_moveCellCursorToSheetStart ctrlEnd_moveCellCursorToSheetEnd esc_closeCellEditor".split(" "),
inputModeEdit:["tab_navigateNext","shiftTab_navigatePrev","enter_navigateNext","shiftEnter_navigatePrev","esc_closeCellEditor"],contextMenuOpen:"esc_closeContextMenu downArrow_moveContextMenuCursorDown upArrow_moveContextMenuCursorUp enter_hitContextMenuItem ctrlZ_undo ctrlY_redo ctrlShiftZ_redo ctrlA_selectAll".split(" ")},ol="cut copy paste hide_cols hide_rows insert_cols_before insert_cols_after delete_cols insert_rows_before insert_rows_after delete_rows sort_asc sort_desc".split(" "),sl={component:"#ffffff",
button:"#e8eaed","button-icon":"#5f6368",input:"#ffffff","input|text":"#000000","input|border":"#5f6368","input:focus|border":"#0078ff","input-info":"#5f6368",contextmenu:"#ffffff","contextmenu|text":"#000000","contextmenu-item:highlight":"#eeeeee","contextmenu-item-shortcut":"#aaaaaa",blanksheet:"#f3f3f3",sheet:"#ffffff","sheet|text":"#000000",scrollbar:"#ffffff","scrollbar|border":"#999999",gridline:"#555555","gridline-tip":"#000000","gridline|opacity":.2,header:"#f8f9fa","header|text":"#000000",
"header:highlight":"#e8eaed","header:selected":"#5f6368","header:selected|text":"#ffffff","header-icon":"#000000","cellrange:cut":"#0078ff","cellrange:copy":"#0078ff","cellrange:fill":"#000000",cellcursor:"#0078ff","cellrange:selected":"#0078ff","cellrange:selected|border":"#0078ff","cellrange:selected|opacity":.1,fillhandle:"#0078ff",celleditor:"#0078ff",searchcursor:"#000000","cell+found":"#89bf71","cell+found|opacity":.25,freezeline:"#dadfe8","freezeline-tip":"#bcbcbc",freezelineplaceholder:"#bcbcbc",
"move?ghost":"#000000","move?ghost|opacity":.15,"move?guide":"#5f6368","move?guide|opacity":1,"freeze?hint":"#a5c6fe","freeze?ghost":"#000000","freeze?ghost|opacity":.15,"freeze?guide":"#000000","freeze?guide|opacity":.3,"resize?hint":"#0078ff","resize?guide":"#0078ff","resize?guide|opacity":1,"show?hint":"#ffffff","show?hint-icon":"#000000","show?hint|border":"#0078ff"},nl={Copy:null,Cut:null,Paste:null,"Delete Row(s)":null,"Hide Row":null,"Hide $n Rows":null,"Hide Column":null,"Hide $n Columns":null,
"Insert Row (up)":null,"Insert $n Rows (up)":null,"Insert Row (down)":null,"Insert $n Rows (down)":null,"Delete Column(s)":null,"Insert Column (left)":null,"Insert $n Columns (left)":null,"Insert Column (right)":null,"Insert $n Columns (right)":null,"$n from $total":null,Deselect:null,"Sort A to Z":null,"Sort Z to A":null,Search:null,"Paste not available.":null,"Cannot delete all columns.":null,"Cannot delete all rows.":null,"Cannot hide all columns.":null,"Cannot hide all rows.":null,"Cannot delete all non-frozen columns.":null,
"Cannot delete all non-frozen rows.":null,"Cannot move columns in or out of the frozen section. Try turning off frozen columns first.":null,"Cannot move rows in or out of the frozen section. Try turning off frozen rows first.":null},rl={default:"default",cell:"default",colHeader:"default",rowHeader:"default",jointHeader:"default",horizontalScrollbar:"default",verticalScrollbar:"default",hiddenColGroupIcon:"default",hiddenRowGroupIcon:"default",freezeLineCol:"grab",freezeLineRow:"grab",freezeLinePlaceholderCol:"grab",
freezeLinePlaceholderRow:"grab",freezeLineColEnd:"grab",freezeLineRowEnd:"grab",selectedRowHeader:"grab",selectedColHeader:"grab",fillHandle:"crosshair",colHeaderEdge:"ew-resize",hiddenColGroupIcon:"pointer",hiddenRowGroupIcon:"pointer"},ll={selectCells:"default",selectCols:"default",selectRows:"default",moveCols:"grabbing",moveRows:"grabbing",fillCells:"crosshair",resizeCols:"ew-resize",freezeCols:"grabbing"},gl=function(t,i,o$jscomp$0){for(var s,n,r,l=[],h=0;h<t.length;h++){var a=[{x:t[h].range[0].x,
y:t[h].range[0].y},{x:t[h].range[1].x,y:t[h].range[1].y}];o$jscomp$0&&e$jscomp$22(i)&&(n=i.length-(1+a[1].y-a[0].y),r=i[0].length-(1+a[1].x-a[0].x),0<n&&(a[1].y+=n),0<r&&(a[1].x+=r));this.expandSheetOnPaste||(a[1].y=Math.min(a[1].y,this._rows.coordList.length-1),a[1].x=Math.min(a[1].x,this._cols.coordList.length-1));r=a;s=this._rows.store._lastId;for(var o=[],s$jscomp$0=r[0].y;s$jscomp$0<=r[1].y;s$jscomp$0++)null==(n=this.getRowIdByCoord(s$jscomp$0))&&s++,o.push(n||s);n=o;s=a;o=this._cols.store._lastId;
s$jscomp$0=[];for(var s$jscomp$1=s[0].x;s$jscomp$1<=s[1].x;s$jscomp$1++)null==(r=this.getColIdByCoord(s$jscomp$1))&&o++,s$jscomp$0.push(r||o);r=s$jscomp$0;if(e$jscomp$22(i))if(i.length!=n.length||i[0].length!=r.length){s=a;o=i;s$jscomp$0=[];s$jscomp$1=0;for(var s$jscomp$2,n$jscomp$0=s[0].y;n$jscomp$0<=s[1].y;n$jscomp$0++){s$jscomp$0.push([]);s$jscomp$2=0;for(var r$jscomp$0=s[0].x;r$jscomp$0<=s[1].x;r$jscomp$0++)s$jscomp$0[s$jscomp$1].push(o[s$jscomp$1%o.length][s$jscomp$2%o[0].length]),s$jscomp$2++;
s$jscomp$1++}s=s$jscomp$0}else s=i;else{s=a;o=i;s$jscomp$0=[];s$jscomp$1=0;for(s$jscomp$2=s[0].y;s$jscomp$2<=s[1].y;s$jscomp$2++){s$jscomp$0.push([]);for(n$jscomp$0=s[0].x;n$jscomp$0<=s[1].x;n$jscomp$0++)s$jscomp$0[s$jscomp$1].push(o);s$jscomp$1++}s=s$jscomp$0}l.push({range:a,rowIds:n,colIds:r,values:s})}return l},Xl=function(t){for(var e=0,i=0;i<t.colIds.length;i++)null==this.getColFromStore(t.colIds[i])&&e++;if(e)var o=vl.call(this,e,this._cols.coordList[this._cols.coordList.length-1]);return o||
[]},Yl=function(t){for(var e=0,i=0;i<t.rowIds.length;i++)null==this.getRowFromStore(t.rowIds[i])&&e++;if(e)var o=ml.call(this,e,this._rows.coordList[this._rows.coordList.length-1]);return o||[]},jl=function(t$jscomp$0){function i$jscomp$0(t){for(var e,i,s,n=[],r=null,l=0;l<t.length;l++)e=""!==(s=t[l])&&null!==s&&!isNaN(s)&&isFinite(s)&&Math.floor(s)===Number(s)?"number":"string",null==r?i=[t[l]]:e==r?i.push(t[l]):("number"==r&&i.length&&(i=o$jscomp$0(i,l-i.length)),Array.prototype.push.apply(n,i),
i=[t[l]]),r=e;return i.length&&("number"==r&&i.length&&(i=o$jscomp$0(i,l-i.length)),Array.prototype.push.apply(n,i)),n}function o$jscomp$0(t,e){for(var i=null,o=null,s=0;s<t.length-1;s++){if(i=t[s+1]-t[s],0<s&&i!=o){i=null;break}o=i}if(null!=i){e={base:Number(t[0]),increment:i,startIndex:e,size:t.length};var r=[];for(s=0;s<t.length;s++)r.push(e)}return r||t}for(var e$jscomp$0=0;e$jscomp$0<t$jscomp$0.length;e$jscomp$0++)t$jscomp$0[e$jscomp$0].groups=i$jscomp$0(t$jscomp$0[e$jscomp$0].series)},rh=function(t,
e){for(var i=[],o=0;o<t.length;o++)i.push({id:t[o],afterId:e});return i.reverse()},hh=function(t,e){if(this.getColCoordById(t[0])==e)return!0;for(var i=!0,o=0;o<t.length;o++)-1<this._cols.coordSections[0].indexOf(t[o])&&(i=!1);return e<this._cols.coordSections[0].length&&(i=!1),i},gh=function(){if(this._freezeLineColAfterId&&-1==this.getColIndexById(this._freezeLineColAfterId)){for(var t=null,e=this._cols.coordSections[0].slice(0,-1).reverse();e.length;){var i=e.shift();if(-1<this.getColIndexById(i)){t=
i;break}}this._freezeLineColAfterId=t}},Bh=function(t,e){for(var i=[],o=0;o<t.length;o++)i.push({id:t[o],afterId:e});return i.reverse()},Dh=function(t,e){if(this.getRowCoordById(t[0])==e)return!0;for(var i=!0,o=0;o<t.length;o++)-1<this._rows.coordSections[0].indexOf(t[o])&&(i=!1);return e<this._rows.coordSections[0].length&&(i=!1),i},Xh=function(){if(this._freezeLineRowAfterId&&-1==this.getRowIndexById(this._freezeLineRowAfterId)){for(var t=null,e=this._rows.coordSections[0].slice(0,-1).reverse();e.length;){var i=
e.shift();if(-1<this.getRowIndexById(i)){t=i;break}}this._freezeLineRowAfterId=t}},ca=function(t){for(var e=null,i=0;i<this._sortState.length;i++)if(this._sortState[i][0]==t){e=this._sortState[i][1];break}return e},Gc=function(t,e){void 0===t&&(t=null);void 0===e&&(e={});this._presetContextMenuItems=Zr;this._presetContextMenuTouchItems;this._presetKeyActions=jr;this._presetParts=Kr;this._defaultTheme=sl;this._defaultLocale=nl;this.events=new Yt(this);this.keys=new zr(this);this.undoManager=new Vr(this);
this.textParser=Wr;this.mouseCursorStatesIdle=rl;this.mouseCursorStatesDrag=ll;this.headerLabelSeries=$r;this.keyActionSets=il;this.allowFillCells=this.allowEditCells=!0;this.fillCellsDirection="xy";this.expandSheetOnPaste=this.allowPaste=this.allowCut=this.allowCopy=!0;this.instantCut=!1;this.allowSort=this.allowHideRows=this.allowFreezeRows=this.allowMoveRows=this.allowInsertRows=this.allowDeleteRows=this.allowResizeCols=this.allowHideCols=this.allowFreezeCols=this.allowMoveCols=this.allowInsertCols=
this.allowDeleteCols=!0;this.instantActivate=!1;this.colAlign="left";this.colHeaderHeight=28;this.colHeaderLabelAlign="left";this.colHeaderLabelFunction=tl;this.colHeaderLabelSuffix=this.colHeaderLabelPrefix="";this.colHeaderLabelType="letters";this.colWidth=100;this.frozenRows=this.frozenCols=0;this.rowHeaderLabelAlign="right";this.rowHeaderLabelFunction=el;this.rowHeaderLabelSuffix=this.rowHeaderLabelPrefix="";this.rowHeaderLabelType="numbers";this.rowHeaderWidth=50;this.rowHeight=28;this.columns=
void 0;this.contextMenuItems=ol;this.data=this.contextMenuTouchItems=void 0;this.fontSize=13;this.fontFamily="sans-serif";this.locale={};this.topBar=Qr;this.bottomBar=Jr;this.escapeQuotesOnCopy=this.hijackNativeSearchCommand=!1;this.cacheCredits=!0;this.cssTheme="light";this.theme={};this._dataFormat;this._actualRowHeight;this._scrollTop=this._scrollLeft=0;this._cd={};this._domNodes={};this._isFullscreen=this._isRedo=this._isUndo=this._isReady=!1;this._fillRange=this._cutRange=this._copyRange=this._currentDragAction=
null;this._cols={store:[],sections:[],tree:[],headerLevels:[],hiddenGroups:[],iconList:void 0,prevNodes:[],nextNodes:[],indexList:[],coordList:[]};this._rows={store:[],sections:[],tree:[],headerLevels:[],hiddenGroups:[],iconList:void 0,prevNodes:[],nextNodes:[],indexList:[],coordList:[]};this._columnNodes=[];this._topBarNodes=[];this._bottomBarNodes=[];this._colLines=[];this._rowLines=[];this._selection=[{range:[{x:0,y:0},{x:0,y:0}],type:"cell"}];this._cellCursorPosition={x:0,y:0};this._activeRangeIndex=
0;this._viewportPosition=null;this._viewportOverflowPx={x:0,y:0};this._isViewportConnectedTo={top:!0,left:!0};this._sectionsPerPaneX={left:[0],center:[1]};this._sectionsPerPaneY={top:[0],center:[1]};this._isActive=!1;this._commandKey=this.constructor._isMacOS?"metaKey":"ctrlKey";this._searchStr="";this._searchCellsFound=[];this._searchCellIndex=-1;this._sortState=[];this._sortFunctions={reset:new Function("a,b","return b[1] - a[1];")};this._rowOrderStore=[];Hr.call(this,t,e)};return Gc.prototype.clearCellValues=
function(t){if(void 0===t&&(t=null),null!=t)t=al.call(this,cl(t)),this.setCellValues(t,null)},Gc.prototype.setCellValues=function(t,e,i,o){return Wl.call(this,t,e,i,o)},Gc.prototype.fillCells=function(t,e,i){return Kl.call(this,t,e,i)},Gc.prototype.deleteCols=function(t){void 0===t&&(t=null);this.deleteColsById(ql.call(this,t))},Gc.prototype.freezeCols=function(t){void 0===t&&(t=1);t=$o(t,0,this._cols.indexList.length-1);this.freezeColsUntilId(this.getColIdByIndex(t-1))},Gc.prototype.hideCols=function(t){void 0===
t&&(t=null);this.hideColsById(ql.call(this,t))},Gc.prototype.insertEmptyCols=function(t,e){return eh.call(this,t,e)},Gc.prototype.moveCols=function(t,e){return lh.call(this,t,e)},Gc.prototype.resizeCols=function(t,e$jscomp$0){var e=e$jscomp$0;if(void 0===t&&(t=null),void 0===e&&(e=null),null!=t&&null!=e){e$jscomp$0=ql.call(this,t);t=[];e=2*Math.round(Math.max(Math.round(e),32)/2);for(var n=0;n<e$jscomp$0.length;n++)t.push(e);dh.call(this,e$jscomp$0,t,!0)}},Gc.prototype.resizeColsToFit=function(t){if(void 0===
t&&(t=null),null!=t){t=ql.call(this,t);for(var i=[],o=0;o<t.length;o++){for(var s,n=0,r=0;r<this._rows.coordList.length;r++)null!=(s=this._cellStore[this.getRowIdByCoord(r)-1][t[o]-1].value)&&(s=String(s).replace(/\n/g,"↵").replace(/\t/g," "),s=this._textWidthMeterCanvasContext.measureText(s).width,s>n&&(n=s));n+=12;i.push(2*Math.round(Math.max(Math.round(n),32)/2))}dh.call(this,t,i,!0)}},Gc.prototype.deleteColsById=function(t){return vh.call(this,t)},Gc.prototype.freezeColsUntilId=function(t){void 0===
t&&(t=null);xh.call(this,t,!0)},Gc.prototype.hideColsById=function(t){return Ih.call(this,t)},Gc.prototype.showColsById=function(t){return Lh.call(this,t)},Gc.prototype.deleteRows=function(t){void 0===t&&(t=null);this.deleteRowsById(Nh.call(this,t))},Gc.prototype.freezeRows=function(t){void 0===t&&(t=1);t=$o(t,0,this._rows.indexList.length-1);this.freezeRowsUntilId(this.getRowIdByIndex(t-1))},Gc.prototype.hideRows=function(t){this.hideRowsById(Nh.call(this,t))},Gc.prototype.insertEmptyRows=function(t,
e){return Fh.call(this,t,e)},Gc.prototype.moveRows=function(t,e){return Oh.call(this,t,e)},Gc.prototype.deleteRowsById=function(t){return Wh.call(this,t)},Gc.prototype.freezeRowsUntilId=function(t){void 0===t&&(t=null);jh.call(this,t,!0)},Gc.prototype.hideRowsById=function(t){return $h.call(this,t)},Gc.prototype.showRowsById=function(t){return Jh.call(this,t)},Gc.prototype.clearSearch=function(){if(this._searchCellsFound.length){var t=this._searchCellsFound[this._searchCellIndex];t={x:this.getColCoordById(t[1]),
y:this.getRowCoordById(t[0])};var i=cl.call(this,t);Il.call(this,i,t,0)}this.search("")},Gc.prototype.search=function(t){void 0===t&&(t="");if(Ol.call(this,t),this._searchCellsFound.length)t=this._searchCellsFound[this._searchCellIndex],Ll.call(this,{x:this.getColCoordById(t[1]),y:this.getRowCoordById(t[0])});Dl.call(this,"search");this.redraw()},Gc.prototype.searchPrev=function(){if(this._searchCellsFound.length){0==this._searchCellIndex?this._searchCellIndex=this._searchCellsFound.length-1:this._searchCellIndex--;
var t=this._searchCellsFound[this._searchCellIndex];Ll.call(this,{x:this.getColCoordById(t[1]),y:this.getRowCoordById(t[0])});Dl.call(this,"search");this.redraw()}},Gc.prototype.searchNext=function(){if(this._searchCellsFound.length){this._searchCellIndex==this._searchCellsFound.length-1?this._searchCellIndex=0:this._searchCellIndex++;var t=this._searchCellsFound[this._searchCellIndex];Ll.call(this,{x:this.getColCoordById(t[1]),y:this.getRowCoordById(t[0])});Dl.call(this,"search");this.redraw()}},
Gc.prototype.sort=function(t,e){return aa.call(this,t,e)},Gc.prototype.activate=function(){this._isActive=!0;mi.call(this,"document","mousedown");this.keys.resume()},Gc.prototype.deactivate=function(){this._isActive=!1;this._domNodes.cellEditor._isOpen&&this.closeCellEditorAndSave();xi.call(this,"document","mousedown");this.keys.suspend();this.deselectAll()},Gc.prototype.getColCoordById=function(t){return this._cols.coordList.indexOf(t)},Gc.prototype.getColIdByCoord=function(t){return this._cols.coordList[t]||
null},Gc.prototype.getColIdByIndex=function(t){return this._cols.indexList[t]||null},Gc.prototype.getColIndexByCoord=function(t){return this.getColIndexById(this.getColIdByCoord(t))},Gc.prototype.getColIndexById=function(t){return this._cols.indexList.indexOf(t)},Gc.prototype.getColPositionInViewport=function(t){var i=!1;var e=this._cd.panesX.left.offset+this._cd.rowHeaderSpace;for(var o=0;o<this._panesXids.left.length;o++){if(o==t){i=!0;break}e+=this.getColWidthById(this._panesXids.left[o])}if(i)t=
e;else{e=this._cd.panesX.center.offset;for(o=0;o<this._colView.length;o++){if(this.getColCoordById(this._colView[o])==t){i=!0;break}e+=this.getColWidthById(this._colView[o])}t=i?e:null}return t},Gc.prototype.getColWidthById=function(t){return null==this._cols.store[t-1]?null:this._cols.store[t-1].width},Gc.prototype.getColSectionFromCellCoords=function(t){a:{for(var e=0,i=0;i<this._cols.coordSections.length;i++)if(e+=this._cols.coordSections[i].length,t.x<e){t=i;break a}t=-1}return t},Gc.prototype.getPanePositionXfromCellCoords=
function(t){return t.x<this._panesXids.left.length?"left":"center"},Gc.prototype.getRowCoordById=function(t){return this._rows.coordList.indexOf(t)},Gc.prototype.getRowHeightById=function(t){return null==this._rows.store[t-1]?null:this._actualRowHeight},Gc.prototype.getRowIdByCoord=function(t){return this._rows.coordList[t]||null},Gc.prototype.getRowIdByIndex=function(t){return this._rows.indexList[t]||null},Gc.prototype.getRowIndexByCoord=function(t){return this.getRowIndexById(this.getRowIdByCoord(t))},
Gc.prototype.getRowIndexById=function(t){return this._rows.indexList.indexOf(t)},Gc.prototype.getRowPositionInViewport=function(t){var i=!1;var e=this._cd.panesY.top.offset+this._cd.colHeaderSpace;for(var o=0;o<this._panesYids.top.length;o++){if(o==t){i=!0;break}e+=this.getRowHeightById(this._panesYids.top[o])}if(i)t=e;else{e=this._cd.panesY.center.offset;for(o=0;o<this._rowView.length;o++){if(this.getRowCoordById(this._rowView[o])==t){i=!0;break}e+=this.getRowHeightById(this._rowView[o])}t=i?e:null}return t},
Gc.prototype.getRowSectionFromCellCoords=function(t){a:{for(var e=0,i=0;i<this._rows.coordSections.length;i++)if(e+=this._rows.coordSections[i].length,t.y<e){t=i;break a}t=-1}return t},Gc.prototype.getPanePositionYfromCellCoords=function(t){return t.y<this._panesYids.top.length?"top":"center"},Gc.prototype.closeCellEditor=function(){mi.call(this,"cellEditorInputField","copy");mi.call(this,"cellEditorInputField","paste");mi.call(this,"cellEditorInputField","cut");this._domNodes.cellEditor._isOpen=
!1;this._domNodes.cellEditor._coords=null;this._domNodes.cellEditor._mode=null;P$jscomp$0(this._domNodes.cellEditor,{opacity:0,height:"1px","z-index":-1});this.events.dispatch("closecelleditor",{})},Gc.prototype.closeCellEditorAndSave=function(){this.setCellValues(this._domNodes.cellEditor._coords,this._domNodes.cellEditorInputField.value);this.closeCellEditor()},Gc.prototype.openCellEditor=function(t){void 0===t&&(t="edit");xi.call(this,"cellEditorInputField","copy");xi.call(this,"cellEditorInputField",
"paste");xi.call(this,"cellEditorInputField","cut");Ll.call(this,this._cellCursorPosition);var e=this.getRowIdByCoord(this._cellCursorPosition.y),i=this.getColIdByCoord(this._cellCursorPosition.x);if(P$jscomp$0(this._domNodes.cellEditorInputField,{height:this.getRowHeightById(e)+1+"px",width:this.getColWidthById(i)+"px"}),P$jscomp$0(this._domNodes.cellEditor,{opacity:1,height:"auto","z-index":100,top:this.getRowPositionInViewport(this._cellCursorPosition.y)+"px",left:this.getColPositionInViewport(this._cellCursorPosition.x)+
"px"}),this._domNodes.cellEditor._coords={x:this._cellCursorPosition.x,y:this._cellCursorPosition.y},this._domNodes.cellEditor._mode=t,this._domNodes.cellEditor._isOpen=!0,"enter"==t?to.call(this,"inputModeEnter"):(to.call(this,"inputModeEdit"),this._domNodes.cellEditorInputField.value=this.getCellValue(this._cellCursorPosition)),"edit"==t&&(this._isIE||this._isIOS||this._isMacOS))t=this._domNodes.cellEditorInputField.value,this._domNodes.cellEditorInputField.value="",this._domNodes.cellEditorInputField.value=
t;io.call(this);this.redraw()},Gc.prototype.setCellEditorValue=function(t){this._domNodes.cellEditorInputField.value=t;this._domNodes.cellEditorInputField.dispatchEvent(new Event("input"))},Gc.prototype.copy=function(){wi.call(this,!0);this._domNodes.cellEditor._actualCommand="copy";this.constructor._isIOS?Fa.call(this):document.execCommand("copy")},Gc.prototype.cut=function(){wi.call(this,!0);this._domNodes.cellEditor._actualCommand="cut";this.constructor._isIOS?Fa.call(this):document.execCommand("copy")},
Gc.prototype.paste=function(){return Ba.call(this)},Gc.prototype.openContextMenu=function(){var t=this.getColPositionInViewport(this._cellCursorPosition.x),e=this.getRowPositionInViewport(this._cellCursorPosition.y),o=this.getRowHeightById(this._rows.coordList[this._cellCursorPosition.y]),s=this._domNodes.display.getBoundingClientRect();In.call(this,{snapPointX:t+window.scrollX+0+s.left,snapPointY:e+window.scrollY+o+s.top},null)},Gc.prototype.downloadDataAsCSV=function(t){void 0===t&&(t={});L$jscomp$0({},
t);t="";for(var i=0;i<this._rows.coordList.length;i++){for(var o=0;o<this._cols.coordList.length;o++){var s=this.getCellFromStore(this._rows.coordList[i],this._cols.coordList[o]).value;t+=null==s?"":s;o<this._cols.coordList.length-1&&(t+=",")}t+="\n"}t=new Blob([t],{type:"text/csv",name:"datagridxl.csv"});this.constructor._isIE?navigator.msSaveBlob(t,"datagridxl.csv"):(t=H("a",{class:"dgxl-downloadLink",href:URL.createObjectURL(t),download:"datagridxl.csv"}),t.textContent="Click here to download",
this._domNodes.component.appendChild(t),t.click(),this._domNodes.component.removeChild(t))},Gc.prototype.downloadDataAsJSON=function(t){void 0===t&&(t={});t=L$jscomp$0({useColTitles:!1,whitespace:2,includeDataField:!1},t);if(t.includeDataField)var i=(o={data:[]}).data;else{var o;i=o=[]}if(t.useColTitles)for(var s=0;s<this._rows.coordList.length;s++){i.push({});for(var n=0;n<this._cols.coordList.length;n++){this.getColFromStore(this._cols.coordList[n]);var r=Je.call(this,this._cols.coordList[n]),l=
this.getCellFromStore(this._rows.coordList[s],this._cols.coordList[n]).value;i[s][r]=null==l?"":l}}else for(s=0;s<this._rows.coordList.length;s++)for(i.push([]),n=0;n<this._cols.coordList.length;n++)l=this.getCellFromStore(this._rows.coordList[s],this._cols.coordList[n]).value,i[s].push(null==l?"":l);t=JSON.stringify(o,null,t.whitespace);t=new Blob([t],{type:"application/json",name:"datagridxl.json"});this.constructor._isIE?navigator.msSaveBlob(t,"datagridxl.json"):(t=H("a",{class:"dgxl-downloadLink",
href:URL.createObjectURL(t),download:"datagridxl.json"}),t.textContent="Click here to download",this._domNodes.component.appendChild(t),t.click(),this._domNodes.component.removeChild(t))},Gc.prototype.getCellRangeData=function(t){if(void 0===t&&(t=null),null!=t){for(var e=[],i=0,o=t[0].y;o<=t[1].y;o++){e.push([]);for(var s=t[0].x;s<=t[1].x;s++)e[i].push(this._cellStore[this._rows.coordList[o]-1][this._cols.coordList[s]-1].value);i++}t=e}else t=void 0;return t},Gc.prototype.getCellRangeText=function(t){if(null==
t)t="";else{if(this.escapeQuotesOnCopy)var e=this.textParser.unparse(this.getCellRangeData(t),{delimiter:"\t"});else{e="";for(var i=t[0].y;i<=t[1].y;i++){for(var o=t[0].x;o<=t[1].x;o++)e+=this._cellStore[this._rows.coordList[i]-1][this._cols.coordList[o]-1].value||"",o<t[1].x&&(e+="\t");i<t[1].y&&(e+="\n")}}t=(""==e&&(e+="\n"),e)}return t},Gc.prototype.getCellValue=function(t){a:{var e=this._cellStore[this.getRowIdByCoord(t.y)-1];if(null!=e&&(t=e[this.getColIdByCoord(t.x)-1],null!=t)){t=t.value;break a}t=
void 0}return t},Gc.prototype.getData=function(t){t=[];if("objectCollection"==this._dataFormat)for(var i=0;i<this._rows.coordList.length;i++){for(var o={},s=0;s<this._cols.coordList.length;s++)o[(n=this.getColFromStore(this._cols.coordList[s])).field]=this._cellStore[this._rows.coordList[i]-1][n.id-1].value;t.push(o)}else if("arrayCollection"==this._dataFormat)for(i=0;i<this._rows.coordList.length;i++){o=[];for(s=0;s<this._cols.coordList.length;s++){var n=this.getColFromStore(this._cols.coordList[s]);
o[s]=this._cellStore[this._rows.coordList[i]-1][n.id-1].value}t.push(o)}return t},Gc.prototype.toggleFullscreen=function(){if(this._isFullscreen)document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen();else{if(this.constructor._isIOS)this._domNodes.component.style.width="100vw",this._domNodes.component.style.height="100vh";else if(this.constructor._isMacOS){var e=window.outerHeight-window.innerHeight;
e=100>e?screen.availHeight:screen.availHeight-e;this._domNodes.component.style.width=screen.availWidth-(window.outerWidth-window.innerWidth)+"px";this._domNodes.component.style.height=e+"px"}this._domNodes.component.requestFullscreen?this._domNodes.component.requestFullscreen():this._domNodes.component.webkitRequestFullscreen?this._domNodes.component.webkitRequestFullscreen():this._domNodes.component.msRequestFullscreen&&this._domNodes.component.msRequestFullscreen()}},Gc.prototype.getSpreadsheetCoords=
function(t){return this.headerLabelSeries.letters.indexToLabel(this.getColIndexByCoord(t.x))+this.headerLabelSeries.numbers.indexToLabel(this.getRowIndexByCoord(t.y))},Gc.prototype.alertUser=function(t){alert(this.getLocaleSetting(t))},Gc.prototype.generateCssFromStyles=function(){var t="",e;for(e in Y)e.startsWith("reset")||(t+=e+" {\n",t+=k$jscomp$0(Y[e].call(this),!0),t+="}\n\n");t=t.substring(0,t.length-2);t=new Blob([t],{type:"octet/stream",name:"datagridxl.csv"});this.constructor._isIE?navigator.msSaveBlob(t,
"datagridxl.css"):(t=H("a",{class:"dgxl-downloadLink",href:URL.createObjectURL(t),download:"datagridxl.css"}),t.textContent="Click here to download",document.body.appendChild(t),t.click(),document.body.removeChild(t))},Gc.prototype.redraw=function(){return ec.call(this)},Gc.prototype.resize=function(){return ic.call(this)},Gc.prototype.getLocaleSetting=function(t$jscomp$0){var t=t$jscomp$0,e=void 0;void 0===e&&(e=!1);t$jscomp$0={};var s=t.match(/([$][\w]+)=([\w\d]+)/g);if(null!=s)for(var n=0;n<s.length;n++){var r=
s[n].split("\x3d");t$jscomp$0[r[0]]=r[1];t=t.replace(s[n],r[0])}t=t in this.locale&&null!==this.locale[t]?this.locale[t]:t in this._defaultLocale&&null!==this._defaultLocale[t]?this._defaultLocale[t]:t;s=e?"\x3cem\x3e":"";e=e?"\x3c/em\x3e":"";for(var n$jscomp$0 in t$jscomp$0)t=t.replace(n$jscomp$0,s+t$jscomp$0[n$jscomp$0]+e);return t},Gc.prototype.deselectAll=function(){this._selection=[];this._activeRangeIndex=-1;this._cellCursorPosition=null;this.redraw()},Gc.prototype.getAnyRangesFromCellCoords=
function(t){for(var e=[],i=0;i<this._selection.length;i++)Io(t,this._selection[i].range)&&e.push({range:this._selection[i].range,type:this._selection[i].type,index:i});return e},Gc.prototype.getSelection=function(t$jscomp$0){var t=t$jscomp$0;void 0===t&&(t=!1);t$jscomp$0=We(this._selection,{});if(!t){t=[];for(var o=0;o<t$jscomp$0.length;o++)t.push(t$jscomp$0[o].range);t$jscomp$0=t}return t$jscomp$0},Gc.prototype.selectAll=function(t){void 0===t&&(t=!0);Il.call(this,[{range:[{x:0,y:0},{x:this._cols.coordList.length-
1,y:this._rows.coordList.length-1}],type:"all"}],t?{x:0,y:0}:this._cellCursorPosition,0);this.redraw()},Gc.prototype.modifyActiveRange=function(t){switch(this._selection[this._activeRangeIndex].type){case "cell":var e,i,o=this._selection[this._activeRangeIndex].range,s={x:this._cellCursorPosition.x,y:this._cellCursorPosition.y};"right"==t?(e="x",o[0].y=o[0].y,o[1].y=o[1].y,s.x==o[0].x?(o[0].x=o[0].x,o[1].x+=1,i=1):(o[0].x+=1,o[1].x=o[1].x,i=0)):"left"==t?(e="x",o[0].y=o[0].y,o[1].y=o[1].y,s.x==o[1].x?
(--o[0].x,o[1].x=o[1].x,i=0):(o[0].x=o[0].x,--o[1].x,i=1)):"down"==t?(e="y",o[0].x=o[0].x,o[1].x=o[1].x,s.y==o[0].y?(o[0].y=o[0].y,o[1].y+=1,i=1):(o[0].y+=1,o[1].y=o[1].y,i=0)):"up"==t&&(e="y",o[0].x=o[0].x,o[1].x=o[1].x,s.y==o[1].y?(--o[0].y,o[1].y=o[1].y,i=0):(o[0].y=o[0].y,--o[1].y,i=1));t=this._selection;t[this._activeRangeIndex].range=o;Il.call(this,t,s,this._activeRangeIndex);t=Rl.call(this,{x:o[i].x,y:o[i].y},e);tn.call(this,{x:this._viewportPosition.x+t.x,y:this._viewportPosition.y+t.y});
break;case "col":if("left"==t||"right"==t)e=this._selection[this._activeRangeIndex].range,i={x:this._cellCursorPosition.x,y:this._cellCursorPosition.y},"right"==t?i.x==e[0].x?(e[0].x=e[0].x,e[1].x+=1,o=1):(e[0].x+=1,e[1].x=e[1].x,o=0):"left"==t&&(i.x==e[1].x?(--e[0].x,e[1].x=e[1].x,o=0):(e[0].x=e[0].x,--e[1].x,o=1)),t=this._selection,t[this._activeRangeIndex].range=e,Il.call(this,t,i,this._activeRangeIndex),t=Rl.call(this,{x:e[o].x,y:e[o].y},"x"),tn.call(this,{x:this._viewportPosition.x+t.x,y:this._viewportPosition.y+
t.y});break;case "row":if("up"==t||"down"==t)e=this._selection[this._activeRangeIndex].range,i={x:this._cellCursorPosition.x,y:this._cellCursorPosition.y},"down"==t?i.y==e[0].y?(e[0].y=e[0].y,e[1].y+=1,s=1):(e[0].y+=1,e[1].y=e[1].y,s=0):"up"==t&&(i.y==e[1].y?(--e[0].y,e[1].y=e[1].y,s=0):(e[0].y=e[0].y,--e[1].y,s=1)),t=this._selection,t[this._activeRangeIndex].range=e,Il.call(this,t,i,this._activeRangeIndex),t=Rl.call(this,{x:e[s].x,y:e[s].y},"y"),tn.call(this,{x:this._viewportPosition.x+t.x,y:this._viewportPosition.y+
t.y})}this.redraw()},Gc.prototype.getCellCursorPosition=function(){return null==this._cellCursorPosition?null:{x:this._cellCursorPosition.x,y:this._cellCursorPosition.y}},Gc.prototype.setCellCursorPosition=function(t$jscomp$0){var t=t$jscomp$0;t$jscomp$0=void 0;if(void 0===t&&(t=null),void 0===t$jscomp$0&&(t$jscomp$0=!0),null!=t)t=Is.call(this,t,"document"),t$jscomp$0=t$jscomp$0||!Io(t,this._selection[this._activeRangeIndex].range)?cl.call(this,t):this._selection,Il.call(this,t$jscomp$0,t,0),this.redraw()},
Gc.prototype.moveCellCursor=function(t){void 0===t&&(t=null);t=Is.call(this,{x:this._cellCursorPosition.x+t.x,y:this._cellCursorPosition.y+t.y},"document");Il.call(this,[{range:[t,t],type:"cell"}]);var i={x:this._viewportPosition.x,y:this._viewportPosition.y},o=Rl.call(this,t);t.x>=this._panesXids.left.length&&(i.x+=o.x);t.y>=this._panesYids.top.length&&(i.y+=o.y);tn.call(this,i);this.redraw()},Gc.prototype.moveCellCursorInsideSelection=function(t$jscomp$0){var t=t$jscomp$0;if(void 0===t&&(t=null),
null!=t){t$jscomp$0=this._selection[this._activeRangeIndex].range;if(1==this._selection.length&&Di.call(this,t$jscomp$0))t$jscomp$0=[{range:[r={x:this._cellCursorPosition.x+t.x,y:this._cellCursorPosition.y+t.y},r],type:"cell"}],Il.call(this,t$jscomp$0,r,0);else{r=this._cellCursorPosition.x+t.x;var s=this._cellCursorPosition.y+t.y,JSCompiler_object_inline_right_3384=t=!1,JSCompiler_object_inline_bottom_3385=!1,JSCompiler_object_inline_left_3386=!1;r>t$jscomp$0[1].x?(JSCompiler_object_inline_right_3384=
!0,r=t$jscomp$0[0].x,s<t$jscomp$0[1].y?s++:(s=t$jscomp$0[0].y,JSCompiler_object_inline_bottom_3385=!0)):r<t$jscomp$0[0].x&&(JSCompiler_object_inline_left_3386=!0,r=t$jscomp$0[1].x,s>t$jscomp$0[0].y?s--:(s=t$jscomp$0[1].y,t=!0));s>t$jscomp$0[1].y?(JSCompiler_object_inline_bottom_3385=!0,s=t$jscomp$0[0].y,r<t$jscomp$0[1].x?r++:(r=t$jscomp$0[0].x,JSCompiler_object_inline_right_3384=!0)):s<t$jscomp$0[0].y&&(t=!0,s=t$jscomp$0[1].y,r>t$jscomp$0[0].x?r--:(r=t$jscomp$0[1].x,JSCompiler_object_inline_left_3386=
!0));var r={x:r,y:s};t$jscomp$0=this._activeRangeIndex;JSCompiler_object_inline_right_3384&&JSCompiler_object_inline_bottom_3385&&(this._activeRangeIndex==this._selection.length-1?t$jscomp$0=0:t$jscomp$0++,r=this._selection[t$jscomp$0].range[0]);JSCompiler_object_inline_left_3386&&t&&(0==this._activeRangeIndex?t$jscomp$0=this._selection.length-1:t$jscomp$0--,r=this._selection[t$jscomp$0].range[1]);Il.call(this,this._selection,r,t$jscomp$0)}t$jscomp$0={x:this._viewportPosition.x,y:this._viewportPosition.y};
t=Rl.call(this,r);r.x>=this._panesXids.left.length&&(t$jscomp$0.x+=t.x);r.y>=this._panesYids.top.length&&(t$jscomp$0.y+=t.y);tn.call(this,t$jscomp$0);this.redraw()}},Gc.prototype.moveCellCursorOneViewportUp=function(){var t=this._cellCursorPosition.y-this._viewportPosition.y;0>t&&(t=0);for(var e=0,i=this._viewportPosition.y;e<this._cd.panesY.center.space&&-1!=i;)e+=this.getRowHeightById(this.getRowIdByCoord(i)),i--;t={x:this._cellCursorPosition.x,y:i+1+t};Il.call(this,[{range:[t,t],type:"cell"}]);
tn.call(this,{x:this._viewportPosition.x,y:i+1});this.redraw()},Gc.prototype.moveCellCursorOneViewportDown=function(){var t=this._cellCursorPosition.y-this._viewportPosition.y;0>t&&(t=0);var e=this._viewportPosition.y+(this._rowView.length-1);t={x:this._cellCursorPosition.x,y:e+t};Il.call(this,[{range:[t,t],type:"cell"}]);tn.call(this,{x:this._viewportPosition.x,y:e});this.redraw()},Gc.prototype.moveCellCursorToColStart=function(){var t={x:this._cellCursorPosition.x,y:0};Il.call(this,[{range:[t,t],
type:"cell"}]);var e={x:this._viewportPosition.x,y:this._viewportPosition.y},i=Rl.call(this,t);t.x>=this._panesXids.left.length&&(e.x+=i.x);t.y>=this._panesYids.top.length&&(e.y+=i.y);tn.call(this,e);this.redraw()},Gc.prototype.moveCellCursorToColEnd=function(){var t={x:this._cellCursorPosition.x,y:this._rows.coordList.length-1};Il.call(this,[{range:[t,t],type:"cell"}]);var e={x:this._viewportPosition.x,y:this._viewportPosition.y},i=Rl.call(this,t);t.x>=this._panesXids.left.length&&(e.x+=i.x);t.y>=
this._panesYids.top.length&&(e.y+=i.y);tn.call(this,e);this.redraw()},Gc.prototype.moveCellCursorToRowStart=function(){var t={x:0,y:this._cellCursorPosition.y};Il.call(this,[{range:[t,t],type:"cell"}]);var e={x:this._viewportPosition.x,y:this._viewportPosition.y},i=Rl.call(this,t);t.x>=this._panesXids.left.length&&(e.x+=i.x);t.y>=this._panesYids.top.length&&(e.y+=i.y);tn.call(this,e);this.redraw()},Gc.prototype.moveCellCursorToRowEnd=function(){var t={x:this._cols.coordList.length-1,y:this._cellCursorPosition.y};
Il.call(this,[{range:[t,t],type:"cell"}]);var e={x:this._viewportPosition.x,y:this._viewportPosition.y},i=Rl.call(this,t);t.x>=this._panesXids.left.length&&(e.x+=i.x);t.y>=this._panesYids.top.length&&(e.y+=i.y);tn.call(this,e);this.redraw()},Gc.prototype.moveCellCursorToSheetStart=function(){var t={x:this._panesXids.left.length,y:this._panesYids.top.length};Il.call(this,[{range:[t,t],type:"cell"}]);t=Rl.call(this,t);tn.call(this,{x:this._viewportPosition.x+t.x,y:this._viewportPosition.y+t.y});this.redraw()},
Gc.prototype.moveCellCursorToSheetEnd=function(){var t={x:this._cols.coordList.length-1,y:this._rows.coordList.length-1};Il.call(this,[{range:[t,t],type:"cell"}]);t=Rl.call(this,t);tn.call(this,{x:this._viewportPosition.x+t.x,y:this._viewportPosition.y+t.y});this.redraw()},Gc.prototype.setCellSelection=function(t){if(void 0===t&&(t=null),null!=t)t=cl.call(this,t),Il.call(this,t),this.redraw()},Gc.prototype.getCellSelection=function(t$jscomp$0){var t=t$jscomp$0;void 0===t&&(t=!1);t$jscomp$0=We(this._selection,
{type:"cell"});if(!t){t=[];for(var o=0;o<t$jscomp$0.length;o++)t.push(t$jscomp$0[o].range);t$jscomp$0=t}return t$jscomp$0},Gc.prototype.setCellRangeExtreme=function(t,e$jscomp$0){var e=e$jscomp$0;void 0===e&&(e=!1);e$jscomp$0=this._cellCursorPosition||{x:0,y:0};e?(t=[{range:[e$jscomp$0,Is.call(this,t)],type:"cell"}],Il.call(this,t,e$jscomp$0,0)):(e=[e$jscomp$0,Is.call(this,t)],(t=this._selection)[this._activeRangeIndex].range=e,Il.call(this,t,e$jscomp$0,this._activeRangeIndex));this.redraw()},Gc.prototype.addCellRangeToSelection=
function(t$jscomp$0){var t=t$jscomp$0;if(void 0===t&&(t=null),null!=t)t$jscomp$0=this._selection,t$jscomp$0.push({range:t,type:"cell"}),t=t$jscomp$0.length-1,Il.call(this,t$jscomp$0,{x:t$jscomp$0[t].range[0].x,y:t$jscomp$0[t].range[1].y},t),this.redraw()},Gc.prototype.getColRangesFromCoord=function(t){t={x:t,y:0};for(var i=[],o=0;o<this._selection.length;o++)Io(t,this._selection[o].range)&&"col"==this._selection[o].type&&i.push({range:this._selection[o].range,type:this._selection[o].type,index:o});
return i},Gc.prototype.getColSelection=function(t$jscomp$0){var t=t$jscomp$0;void 0===t&&(t=!1);t$jscomp$0=We(this._selection,{type:"col"});if(!t){t=[];for(var o=0;o<t$jscomp$0.length;o++)t.push(ps.call(this,t$jscomp$0[o].range));t$jscomp$0=t}return t$jscomp$0},Gc.prototype.setColSelection=function(t){if(void 0===t&&(t=null),null!=t)t=Ul.call(this,t),Il.call(this,t,{x:t[0].range[0].x,y:0}),this.redraw()},Gc.prototype.setColRangeExtreme=function(t,e$jscomp$0){var e=e$jscomp$0;void 0===e&&(e=!1);e$jscomp$0=
this._cellCursorPosition||{x:0,y:0};e?(t=[e$jscomp$0.x,zc.call(this,t)],t=[{range:ir.call(this,t),type:"col"}],Il.call(this,t,e$jscomp$0,0)):(t=[e$jscomp$0.x,zc.call(this,t)],e=ir.call(this,t),(t=this._selection)[this._activeRangeIndex].range=e,Il.call(this,t,e$jscomp$0,this._activeRangeIndex));this.redraw()},Gc.prototype.addColRangeToSelection=function(t){if(void 0===t&&(t=null),null!=t){var e=this._selection;e.push({range:ir.call(this,t),type:"col"});Il.call(this,e,{x:e[e.length-1].range[0].x,y:0},
e.length-1);this.redraw()}},Gc.prototype.getRowRangesFromCoord=function(t){t={x:0,y:t};for(var i=[],o=0;o<this._selection.length;o++)Io(t,this._selection[o].range)&&"row"==this._selection[o].type&&i.push({range:this._selection[o].range,type:this._selection[o].type,index:o});return i},Gc.prototype.getRowSelection=function(t$jscomp$0){var t=t$jscomp$0;void 0===t&&(t=!1);t$jscomp$0=We(this._selection,{type:"row"});if(!t){t=[];for(var o=0;o<t$jscomp$0.length;o++)t.push(Yo.call(this,t$jscomp$0[o].range));
t$jscomp$0=t}return t$jscomp$0},Gc.prototype.setRowSelection=function(t){if(void 0===t&&(t=null),null!=t)t=Ph.call(this,t),Il.call(this,t,{x:0,y:t[0].range[0].y}),this.redraw()},Gc.prototype.setRowRangeExtreme=function(t,e$jscomp$0){var e=e$jscomp$0;void 0===e&&(e=!1);e$jscomp$0=this._cellCursorPosition||{x:0,y:0};e?(t=[e$jscomp$0.y,Bc.call(this,t)],t=[{range:or.call(this,t),type:"row"}],Il.call(this,t,e$jscomp$0,0)):(t=[e$jscomp$0.y,Bc.call(this,t)],e=or.call(this,t),(t=this._selection)[this._activeRangeIndex].range=
e,Il.call(this,t,e$jscomp$0,this._activeRangeIndex));this.redraw()},Gc.prototype.addRowRangeToSelection=function(t){if(void 0===t&&(t=null),null!=t){var e=this._selection;e.push({range:or.call(this,t),type:"row"});Il.call(this,e,{x:0,y:e[e.length-1].range[0].y},e.length-1);this.redraw()}},Gc.prototype.getCellFromStore=function(t,e){t=this._cellStore[t-1];return null!=t&&t[e-1]||null},Gc.prototype.getColFromStore=function(t){return this._cols.store[t-1]||null},Gc.prototype.getRowFromStore=function(t){return this._rows.store[t-
1]||null},Gc.prototype.getThemeSetting=function(t){return this.theme[t]||this._defaultTheme[t]},Gc.prototype.undo=function(){this.undoManager.hasUndo()&&(this.undoManager.undo(),this._isUndo=!0)},Gc.prototype.redo=function(){this.undoManager.hasRedo()&&(this.undoManager.redo(),this._isRedo=!0)},Gc.prototype.getViewportPosition=function(){return null==this._viewportPosition?null:{x:this._viewportPosition.x,y:this._viewportPosition.y}},Gc.prototype.setViewportPosition=function(t){tn.call(this,t);this.redraw()},
Gc._domNodes={},Gc.instances=[],Gc._isIE=function(){var t=window.navigator.userAgent,e=t.indexOf("MSIE ");return 0<e?parseInt(t.substring(e+5,t.indexOf(".",e)),10):0<t.indexOf("Trident/")?(e=t.indexOf("rv:"),parseInt(t.substring(e+3,t.indexOf(".",e)),10)):!1}(),Gc._isMacOS=-1<navigator.platform.indexOf("Mac"),Gc._isIOS=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&1<navigator.maxTouchPoints,Gc._isTouchDevice=window.matchMedia("(pointer: coarse)").matches,
Gc.createEmptyData=function(t,e){for(var i=[],o=0;o<t;o++){i.push([]);for(var s=0;s<e;s++)i[o].push(null)}return i},Gc.createDummyData=function(t,e){for(var i=[],o=0;o<t;o++){i.push([]);for(var s=0;s<e;s++)i[o].push(o+1+";"+(s+1))}return i},Gc})}
//# sourceMappingURL=module$node_modules$$datagridxl$datagridxl2$datagridxl$datagridxl2_umd.js.map
