shadow$provide.module$node_modules$$sentry$core$dist$integrations$inboundfilters=function(global,require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("module$node_modules$tslib$tslib"),hub_1=require("module$node_modules$$sentry$hub$dist$index"),utils_1=require("module$node_modules$$sentry$utils$dist$index"),DEFAULT_IGNORE_ERRORS=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/];global=function(){function InboundFilters(_options){void 0===
_options&&(_options={});this._options=_options;this.name=InboundFilters.id}InboundFilters.prototype.setupOnce=function(){hub_1.addGlobalEventProcessor(function(event){var hub=hub_1.getCurrentHub();if(!hub)return event;var self=hub.getIntegration(InboundFilters);return self?(hub=(hub=hub.getClient())?hub.getOptions():{},hub="function"===typeof self._mergeOptions?self._mergeOptions(hub):{},"function"!==typeof self._shouldDropEvent?event:self._shouldDropEvent(event,hub)?null:event):event})};InboundFilters.prototype._shouldDropEvent=
function(event,options){return this._isSentryError(event,options)?(utils_1.logger.warn("Event dropped due to being internal Sentry Error.\nEvent: "+utils_1.getEventDescription(event)),!0):this._isIgnoredError(event,options)?(utils_1.logger.warn("Event dropped due to being matched by `ignoreErrors` option.\nEvent: "+utils_1.getEventDescription(event)),!0):this._isDeniedUrl(event,options)?(utils_1.logger.warn("Event dropped due to being matched by `denyUrls` option.\nEvent: "+utils_1.getEventDescription(event)+
".\nUrl: "+this._getEventFilterUrl(event)),!0):this._isAllowedUrl(event,options)?!1:(utils_1.logger.warn("Event dropped due to not being matched by `allowUrls` option.\nEvent: "+utils_1.getEventDescription(event)+".\nUrl: "+this._getEventFilterUrl(event)),!0)};InboundFilters.prototype._isSentryError=function(event,options){if(!options.ignoreInternal)return!1;try{return event&&event.exception&&event.exception.values&&event.exception.values[0]&&"SentryError"===event.exception.values[0].type||!1}catch(_oO){return!1}};
InboundFilters.prototype._isIgnoredError=function(event,options){return options.ignoreErrors&&options.ignoreErrors.length?this._getPossibleEventMessages(event).some(function(message){return options.ignoreErrors.some(function(pattern){return utils_1.isMatchingPattern(message,pattern)})}):!1};InboundFilters.prototype._isDeniedUrl=function(event,options){if(!options.denyUrls||!options.denyUrls.length)return!1;var url=this._getEventFilterUrl(event);return url?options.denyUrls.some(function(pattern){return utils_1.isMatchingPattern(url,
pattern)}):!1};InboundFilters.prototype._isAllowedUrl=function(event,options){if(!options.allowUrls||!options.allowUrls.length)return!0;var url=this._getEventFilterUrl(event);return url?options.allowUrls.some(function(pattern){return utils_1.isMatchingPattern(url,pattern)}):!0};InboundFilters.prototype._mergeOptions=function(clientOptions){void 0===clientOptions&&(clientOptions={});return{allowUrls:tslib_1.__spread(this._options.whitelistUrls||[],this._options.allowUrls||[],clientOptions.whitelistUrls||
[],clientOptions.allowUrls||[]),denyUrls:tslib_1.__spread(this._options.blacklistUrls||[],this._options.denyUrls||[],clientOptions.blacklistUrls||[],clientOptions.denyUrls||[]),ignoreErrors:tslib_1.__spread(this._options.ignoreErrors||[],clientOptions.ignoreErrors||[],DEFAULT_IGNORE_ERRORS),ignoreInternal:"undefined"!==typeof this._options.ignoreInternal?this._options.ignoreInternal:!0}};InboundFilters.prototype._getPossibleEventMessages=function(event){if(event.message)return[event.message];if(event.exception)try{var _a=
event.exception.values&&event.exception.values[0]||{},_b=_a.type,_c=_a.value;event=void 0===_c?"":_c;return[""+event,(void 0===_b?"":_b)+": "+event]}catch(oO){utils_1.logger.error("Cannot extract message for event "+utils_1.getEventDescription(event))}return[]};InboundFilters.prototype._getLastValidUrl=function(frames){void 0===frames&&(frames=[]);for(var _a,_b,i=frames.length-1;0<=i;i--){var frame=frames[i];if("\x3canonymous\x3e"!==(null===(_a=frame)||void 0===_a?void 0:_a.filename)&&"[native code]"!==
(null===(_b=frame)||void 0===_b?void 0:_b.filename))return frame.filename||null}return null};InboundFilters.prototype._getEventFilterUrl=function(event){try{return event.stacktrace?this._getLastValidUrl(event.stacktrace.frames):event.exception?this._getLastValidUrl(event.exception.values&&event.exception.values[0].stacktrace&&event.exception.values[0].stacktrace.frames):null}catch(oO){return utils_1.logger.error("Cannot extract url for event "+utils_1.getEventDescription(event)),null}};InboundFilters.id=
"InboundFilters";return InboundFilters}();exports.InboundFilters=global}
//# sourceMappingURL=module$node_modules$$sentry$core$dist$integrations$inboundfilters.js.map
