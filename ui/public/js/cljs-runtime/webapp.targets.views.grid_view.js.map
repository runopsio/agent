{"version":3,"sources":["webapp/targets/views/grid_view.cljs"],"mappings":"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","names":["js/webapp","js/webapp.targets","js/webapp.targets.views","js/webapp.targets.views.grid-view","js/webapp.targets.views.grid-view.item-state","webapp.targets.views.grid-view/item-state","reagent.core.atom","webapp.targets.views.grid-view/toggle-dropdown-status","item","cljs.core.swap_BANG_","cljs.core/assoc-in","cljs.core/not","cljs.core/deref","cljs.core.get_in","webapp.targets.views.grid-view/confirm-target-deactivation","target","webapp.components.headings/h2","webapp.components.divider/main","webapp.components.button/secondary","re-frame.core/dispatch","webapp.components.button/primary","webapp.targets.views.grid-view/deactivate","webapp.targets.views.grid-view/item-dropdown","webapp.targets.views.grid-view/target-card-popover","webapp.components.popover/right","webapp.targets.views.grid-view/card-empty-targets","webapp.targets.views.grid-view/target-card","admin?","active?","cljs.core._EQ_","iter__4652__auto__","s__30765","cljs.core/LazySeq","temp__5753__auto__","cljs.core/seq","cljs.core/chunked-seq?","c__4650__auto__","size__4651__auto__","cljs.core/count","b__30767","cljs.core/chunk-buffer","i__30766","cljs.core/-nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__30764","cljs.core/chunk-rest","cljs.core/first","cljs.core/cons","cljs.core/rest","group","webapp.components.badge/basic","webapp.targets.views.grid-view/main","_","user","re_frame.core.subscribe","targets","cljs.core/some","cljs.core.partial","cljs.core/=","cljs.core/empty?","s__30773","b__30775","i__30774","iter__30772","cljs.core/chunk-first"],"sourcesContent":["(ns webapp.targets.views.grid-view\n  (:require\n   [re-frame.core :as rf]\n   [reagent.core :as r]\n   [webapp.subs :as subs]\n   [webapp.targets.events :as events]\n   [webapp.components.badge :as badge]\n   [webapp.components.popover :as popover]\n   [webapp.components.headings :as headings]\n   [webapp.components.divider :as divider]\n   [webapp.components.button :as button]))\n\n(defonce item-state (r/atom {}))\n\n;; TODO find a better place to this kind of logic to be placed\n(defn toggle-dropdown-status [item]\n  (swap! item-state assoc-in\n         [(:name item) :dropdown-status]\n         (not (get-in @item-state [(:name item) :dropdown-status]))))\n\n(defn confirm-target-deactivation\n  [target]\n  [:div\n   [headings/h2 \"Target deactivation\" {:class \"mb-regular\"}]\n   (divider/main)\n   [:p.mb-regular\n    \"Do you really want to deactivate \"\n    [:b (:name target)]\n    \" target?\"]\n   (divider/main)\n   [:div.grid.grid-cols-2.gap-regular\n    (button/secondary {:text \"Cancel\"\n                       :on-click #(rf/dispatch [:close-modal])})\n    (button/primary {:text \"Confirm deactivation\"\n                     :on-click #(rf/dispatch\n                                 [::events/deactivate-target (:name target)])})]])\n\n(defn deactivate [item]\n  (toggle-dropdown-status item)\n  (rf/dispatch [:open-modal (confirm-target-deactivation item)]))\n\n(defn item-dropdown [item]\n  [:ul.text-right\n   [:li.border-b.py-small.px-regular\n    [:a.text-sm\n     {:href (str \"/targets/\" (:name item))\n      :on-click #(toggle-dropdown-status item)}\n     \"Edit\"]]\n   [:li.py-small.px-regular\n    [:a.text-red-600.text-sm\n     {:href \"#\"\n      :on-click #(deactivate item)}\n     \"Deactivate\"]]])\n\n(defn- target-card-popover [target]\n  [:div\n   {:class \"absolute right-small top-regular\"}\n   [:figure\n    {:class \"w-5 cursor-pointer\"\n     :on-click #(swap! item-state assoc-in\n                       [(:name target) :dropdown-status]\n                       (not (get-in @item-state [(:name target) :dropdown-status])))}\n    [:img {:src \"/icons/icon-dots-vertical.svg\"}]]\n   (popover/right {:open (get-in @item-state [(:name target) :dropdown-status])\n                   :component (item-dropdown target)\n                   :on-click-outside #(swap! item-state assoc-in\n                                             [(:name target) :dropdown-status]\n                                             false)})])\n\n(defn- card-empty-targets []\n  [:a {:class (str \"group flex flex-col justify-center items-center\"\n                   \" p-regular bg-white rounded-lg h-32\"\n                   \" border shadow-0 hover:shadow transition\")\n       :href \"/targets/new\"}\n   [:figure {:class \"w-16 opacity-40 group-hover:opacity-50 transition\"}\n    [:img {:class \"w-full\"\n           :src \"/icons/icon-plus-blue.svg\"}]]\n   [:span {:class \"text-xs text-blue-500\"}\n    \"Create a target\"]])\n\n(defn- target-card [target admin?]\n  (let [active? (= (:status target) \"active\")]\n    [:div\n     [:a {:class (str \"group flex flex-col relative p-regular bg-white rounded-lg\"\n                      \" border shadow-0 hover:shadow transition h-full\")\n          :href (str \"/targets/\" (:name target) \"/tasks/new\")}\n      [:div\n       {:class (str \"text-sm text-gray-900\"\n                    (when (not active?) \" opacity-50 italic\"))}\n       (:name target)\n       (when (not active?)\n         [:span\n          {:class \"font-italic text-xs text-gray-600\"}\n          \" (inactive)\"])]\n      [:div\n       {:class \"text-xs text-gray-500\"}\n       (:type target)]\n\n      [:div {:class \"flex items-start py-regular gap-small\"}\n       [:div\n        {:class \"flex flex-wrap gap-small\"}\n        (for [group (:groups target)]\n          ^{:key group}\n          [badge/basic group])]]\n      [:div {:class \"flex flex-grow justify-end items-end\"}\n       [:span {:class \"flex items-center gap-x-small text-xs text-blue-500\"}\n        [:span \"Open\"]\n        [:figure {:class \"w-3 transform group-hover:translate-x-0.5 transition\"}\n         [:img {:src \"/icons/icon-arrow-right-blue.svg\"}]]]] ]\n     (when admin? [target-card-popover target])]))\n\n(defn main [_]\n  (let [user (rf/subscribe [::subs/user])]\n    (fn [targets]\n      (let [admin? (some (partial = \"admin\") (:groups @user))]\n        [:section\n         {:class (str \"grid grid-cols-3 gap-small \"\n                      \"2xl:grid-cols-4\")}\n         (when (empty? targets)\n           (if admin?\n             [card-empty-targets]\n             [:div\n              {:class (str \"col-span-3 text-center p-x-large\"\n                                \" text-sm text-gray-400 font-semibold\" )}\n              (str \"You have no targets. \"\n                   \"If you need access to some, contact the admin\")]))\n         (for [target targets]\n           ^{:key (:name target)}\n           [target-card target admin?])]))))\n"]}