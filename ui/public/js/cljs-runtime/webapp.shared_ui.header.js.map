{"version":3,"sources":["webapp/shared_ui/header.cljs"],"mappings":"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","names":["webapp.shared-ui.header/dropdown-list","re-frame.core/dispatch","webapp.shared-ui.header/agent-resources","webapp.shared-ui.header/admin-resources","webapp.shared-ui.header/resources","js/webapp","js/webapp.shared-ui","js/webapp.shared-ui.header","js/webapp.shared-ui.header.dropdown-status","webapp.shared-ui.header/dropdown-status","reagent.core.atom","webapp.shared-ui.header/dropdown","cljs.core/deref","webapp.components.popover/right","webapp.shared-ui.header/nav-item","item","active-page","reviews-length","cljs.core._EQ_","js/webapp.shared-ui.header.nav","method-table__4747__auto__","cljs.core.atom","prefer-table__4748__auto__","method-cache__4749__auto__","cached-hierarchy__4750__auto__","hierarchy__4751__auto__","cljs.core.get","fexpr__30229","cljs.core/MultiFn","cljs.core.symbol","webapp.shared-ui.header/nav","cljs.core/identity","p__30230","map__30231","cljs.core/--destructure-map","_","portal-web-item-list","reviews","re_frame.core.subscribe","cljs.core.doall","iter__4652__auto__","s__30233","cljs.core/LazySeq","temp__5753__auto__","cljs.core/seq","cljs.core/chunked-seq?","c__4650__auto__","size__4651__auto__","cljs.core/count","b__30235","cljs.core/chunk-buffer","i__30234","cljs.core/-nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__30232","cljs.core/chunk-rest","cljs.core/first","cljs.core/cons","cljs.core/rest","p__30237","map__30238","agent-wizard-items-list","s__30240","b__30242","i__30241","iter__30239","webapp.shared-ui.header/navigation","admin?","js/window","nav-items-list","cljs.core.concat","agent-nav-items-list","webapp.config/client","webapp.shared-ui.header/header","user","cljs.core/not","cljs.core/some","cljs.core.partial","cljs.core/=","cljs.core/reset!","cljs.core/chunk-first"],"sourcesContent":["(ns webapp.shared-ui.header\n  (:require [re-frame.core :as rf]\n            [reagent.core :as r]\n            [webapp.components.popover :as popover]\n            [webapp.events :as events]\n            [webapp.config :as configs]\n            [webapp.subs :as subs]))\n\n(defn dropdown-list []\n  [:ul.w-36\n   [:li.py-small.px-regular.border-b\n    [:a.text-gray-700.text-sm\n     {:href \"/settings\"\n      :on-click #(rf/dispatch [:navigate :settings])}\n     :Settings]]\n   [:li.py-small.px-regular\n    [:a.text-red-600.text-sm\n     {:href \"#\"\n      :on-click #(rf/dispatch [:logout])}\n     \"Log out\"]]])\n\n(def ^:private agent-resources\n  [{:text \"secrets\" :uri \"/secrets\"}])\n\n(def ^:private admin-resources\n  [{:text \"dashboard\" :uri \"/dashboard/queries\"}])\n\n(def ^:private resources\n  [{:text \"connections\" :uri \"/connections\"}\n   {:text \"history\" :uri \"/queries\"}\n   {:text \"templates\" :uri \"/templates\"}\n   {:text \"reviews\" :uri \"/reviews\"}])\n\n(defonce dropdown-status (r/atom false))\n(defn- dropdown []\n  [:div.relative.flex.items-center\n   (popover/right {:open @dropdown-status :component (dropdown-list)})\n   [:figure.w-5\n    [:img {:src \"/icons/icon-cheveron-down.svg\"}]]])\n\n(defn- nav-item [item active-page reviews-length]\n  [:a\n   {:href (:uri item)\n    :class (str \"flex gap-1 items-center text-sm pr-regular \")}\n   [:span\n    {:class (if (= active-page (:uri item))\n              \"text-black underline\" \"text-gray-500 hover:text-gray-900 transition\")}\n    (:text item)]\n   (when (and (= (:text item) \"reviews\") (> reviews-length 0))\n     [:span\n      {:class (str (when (< reviews-length 10) \"w-3.5\")\n                   \" h-3.5 px-1 text-xxs font-bold text-gray-50\"\n                   \" rounded-full bg-red-500 text-center\")}\n      reviews-length])\n   (when (= (:text item) \"dashboard\")\n     [:span\n      {:class (str \" h-3.5 px-1 text-xxs text-white font-bold\"\n                   \" rounded-full bg-red-500 text-center\")}\n      \"new!\"])])\n\n(defmulti nav identity)\n(defmethod nav \"portal-web\" [_ {:keys [portal-web-item-list active-page]}]\n  (let [_ (rf/dispatch [:get-reviews])\n        reviews (rf/subscribe [:reviews])]\n    (doall (for [item portal-web-item-list]\n             ^{:key (:text item)}\n             [nav-item item active-page (count (:list @reviews))]))))\n\n(defmethod nav \"agent-wizard\" [_ {:keys [agent-wizard-items-list active-page]}]\n  (doall (for [item agent-wizard-items-list]\n           ^{:key (:text item)}\n           [nav-item item active-page])))\n\n(defn- navigation [admin?]\n  (let [active-page (.. js/window -location -pathname)\n        _ @(rf/subscribe [::subs/active-panel])\n        nav-items-list (concat resources (if admin? admin-resources {}))\n        agent-nav-items-list agent-resources]\n    [:nav {:class \"w-full flex\"}\n     (nav configs/client {:portal-web-item-list nav-items-list\n                          :agent-wizard-items-list agent-nav-items-list\n                          :active-page active-page})]))\n\n(defn header []\n  (let [user (rf/subscribe [::subs/user])]\n    (when (and (not @user) (= \"portal-web\" configs/client)) (rf/dispatch [::events/get-user]))\n    (fn []\n      (let [admin? (some (partial = \"admin\") (:groups @user))]\n        [:header\n         {:class (str \"w-full min-w-app__container \"\n                      \"bg-white shadow \"\n                      \"py-small px-large mb-regular \")}\n         [:div.flex.flex-cols-2.items-center\n          [:div.flex.flex-grow.gap-regular.items-center\n           [:figure\n            {:class \"w-24 px-small cursor-pointer\"}\n            [:img\n             {:src \"/images/Runops_Logo_Runops_Logo_Preto.png\"\n              :on-click #(rf/dispatch [:navigate :home])}]]\n           [navigation admin?]]\n          (when (= configs/client \"portal-web\")\n            [:div.flex.flex-shrink.flex-row-reverse.items-center.cursor-pointer\n             {:on-click #(reset! dropdown-status (not @dropdown-status))}\n             (dropdown)\n             [:span.text-xs.font-semibold.text-black (:name @user)]])]]))))\n"]}