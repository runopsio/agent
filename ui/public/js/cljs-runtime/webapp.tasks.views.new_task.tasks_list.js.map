{"version":3,"sources":["webapp/tasks/views/new_task/tasks_list.cljs"],"mappings":"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","names":["webapp.tasks.views.new-task.tasks-list/open-modal","task","_","re-frame.core/dispatch","webapp.tasks.views.task-details/main","js/webapp","js/webapp.tasks","js/webapp.tasks.views","js/webapp.tasks.views.new-task","js/webapp.tasks.views.new-task.tasks-list","js/webapp.tasks.views.new-task.tasks-list.refresh-tasks","method-table__4747__auto__","cljs.core.atom","prefer-table__4748__auto__","method-cache__4749__auto__","cached-hierarchy__4750__auto__","hierarchy__4751__auto__","cljs.core.get","fexpr__31155","cljs.core/MultiFn","cljs.core.symbol","webapp.tasks.views.new-task.tasks-list/refresh-tasks","cljs.core/identity","webapp.tasks.views.new-task.tasks-list/main","tasks","re_frame.core.subscribe","interval","js/window","cljs.core/not","js/document","reagent.core.create_class","cljs.core/deref","iter__4652__auto__","s__31166","cljs.core/LazySeq","temp__5753__auto__","cljs.core/seq","cljs.core/chunked-seq?","c__4650__auto__","size__4651__auto__","cljs.core/count","b__31168","cljs.core/chunk-buffer","i__31167","cljs.core/-nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__31165","cljs.core/chunk-rest","cljs.core/first","cljs.core/cons","cljs.core/rest","webapp.formatters/time-ago","cljs.core/chunk-first"],"sourcesContent":["(ns webapp.tasks.views.new-task.tasks-list\n  (:require\n   [reagent.core :as r]\n   [re-frame.core :as rf]\n   [webapp.formatters :as formatters]\n   [webapp.tasks.views.task-details :as task-details]))\n\n(defn- open-modal [task]\n  (let [_  (rf/dispatch [:get-task-by-id task])\n        _ (rf/dispatch [:open-modal\n                        [task-details/main] :large])]))\n\n(defmulti ^:private refresh-tasks identity)\n(defmethod ^:private refresh-tasks :loading [_]\n  [:div.flex.text-xs.flex-grow.items-center.justify-end\n   [:figure.w-4\n    [:img.animate-spin {:src \"/icons/icon-refresh.svg\"}]]\n   [:span [:i \"loading\"] ]])\n(defmethod ^:private refresh-tasks :default [_]\n  [:div.flex.text-xs.cursor-pointer.flex-grow.items-center.justify-end\n   {:on-click #(rf/dispatch [:new-task->get-history])}\n   [:figure.w-4\n    [:img {:src \"/icons/icon-refresh-blue.svg\"}]]\n   [:span.text-blue-500 \"refresh\"]])\n\n(defn main []\n  (let [tasks (rf/subscribe [:new-task->connection-history])\n        interval (.setInterval\n                  js/window\n                  (fn []\n                      (when (not (.-hidden js/document))\n                        (rf/dispatch [:new-task->get-history]))) 5000)]\n    (r/create-class\n     {:display-name \"queries-history\"\n      :component-will-unmount #(.clearInterval js/window interval)\n      :reagent-render\n      (fn []\n        [:div.pb-regular.mb-x-large\n         [:header.flex.mb-small.px-small\n          [:div.font-bold \"History\"]\n          [refresh-tasks (:status @tasks)]]\n         [:section\n          (for [task (:results @tasks)]\n            ^{:key (:id task)}\n            [:div.border-b.hover:bg-gray-100.p-small.cursor-pointer\n             {:on-click #(open-modal task)}\n             [:header.flex\n              [:div.text-xs.text-gray-500 (:id task)]\n              [:div.text-xs.text-gray-900.truncate.overflow-hidden.flex-grow.text-right.italic\n               (:status task)]]\n             [:div {:class \"text-xs text-gray-500\"}\n              (formatters/time-ago (:created task))]\n             [:section\n              {:class \"py-small\"}\n              [:div\n               {:class \"text-xs text-gray-900 font-bold truncate overflow-hidden\"}\n               (:target task)]\n              [:div\n               {:class \"text-xs text-gray-500 font-light truncate overflow-hidden\"}\n               (:script task)]]])]\n         [:footer.px-small.py-regular.text-sm.text-blue-500.cursor-pointer\n          \"Load more\"]])})))\n"]}