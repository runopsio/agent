{"version":3,"sources":["webapp/targets/views/main.cljs"],"mappings":";AAWA,2CAAA,3CAAMA,8FAAgBC;AAAtB,AAAA,0FAAA,mDAAA,2CAAA,wDAAA,oDAAA,mFAAA,gGAAA,mFAIKC,yDACF,gCAAA,AAAA,mFAAA,jGAAMD,oJACL,iCAAA,2CAAA,sDAAA,gBAAA,6DAAA,/MAACE;AAAD,AAC4B,8BAAA,mFAAA,gEAAA,+HAAA,KAAA,9SAACC,6PAA0BC;oBAFxD;;AAIH,sCAAA,tCAAMC;AAAN,AAAA,0FAAA,iHAAA,mFAAA,8DAGI,iCAAA,2CAAA,sDAAA,YAAA,6DAAA,3MAACH;AAAD,AAC4B,8BAAA,mFAAA,1GAACC;;;AAEjC,GAAA,QAAAG,mCAAAC,2CAAAC,iDAAAC,sDAAAC;AAAA;AAAA,AAAA,2CAAA,iBAAAC,6BAAA,AAAAC,6CAAA,tIAAoBS;IAApBR,6BAAA,AAAAD,6CAAA;IAAAE,6BAAA,AAAAF,6CAAA;IAAAG,iCAAA,AAAAH,6CAAA;IAAAI,0BAAA,AAAAC,4CAAA,mCAAA,gEAAA,iBAAAC,eAAA;AAAA,AAAA,QAAAA,6CAAAA,+CAAAA;;AAAA,AAAA,YAAAC,kBAAA,AAAAC,+CAAA,4BAAA,qCAAA,4DAAAJ,wBAAAL,2BAAAE,2BAAAC,2BAAAC,xLAAmCO;;;AACnC,AAAAD,qFAAA,oDAAA,WAA2CE,EAAEC;AAA7C,AAAA,0FACGC,oCAAeD;;AAClB,AAAAH,qFAAA,4DAAA,WAA8CE,EAAEC;AAAhD,AAAA,0FACGE,oCAAeF;;AAElB,4CAAA,oDAAAG,hGAAOG;AAAP,AAAA,IAAAF,aAAAD;IAAAC,iBAAA,AAAAC,4BAAAD;eAAA,AAAAX,4CAAAW,eAAA,tEAAgCG;eAAhC,AAAAd,4CAAAW,eAAA,tEAAyCI;iBAAzC,AAAAf,4CAAAW,eAAA,xEAAkDK;AAAlD,AAAA,0FAAA,mDAAA,2CAAA,wDAAA,0EAAA,mFAAA,qDAAA,2CAAA,wDAAA,gCAAA,mBAAA,mFAAA,qDAAA,2CAAA,8EAAA,mFAAA,yDAAA,2CAAA,4QAAA,mFAAA,mDAAA,2CAAA,iDAAA,YAAA,qDAAA,SAAA,oDAAA,4DAAA,mFAAA,qDAAA,2CAAA,8EAAA,mFAAA,yDAAA,2CAAA,4QAAA,mFAAA,mDAAA,2CAAA,iDAAA,YAAA,qDAAA,SAAA,oDAAA,p5DAKqBF,gQACA,CAAA,sBAAA,+BAEK,gHAAA,cAAA,5HAAI,wDAAA,xDAACG,6CAAED,2vBAIZD,gQACA,CAAA,sBAAA,+BAEK,gHAAA,cAAA,5HAAI,wDAAA,xDAACE,6CAAED;;AAKjC,kCAAA,lCAAME;AAAN,AACE,IAAMC,OAAK,sDAAA,mFAAA,zIAACC;IACNb,UAAQ,sDAAA,mFAAA,zIAACa;IACTC,oBAAkB,sDAAA,mFAAA,zIAACD;IACnBJ,aAAW,gDAAA,hDAACM;AAHlB,AAIE,uBAAA,mFAAA,1GAACpC;;AACD;AAAA,AACE,IAAMH,eAAO,AAACyC,eAAK,+DAAA,/DAACC,gDAAQC,wBAAW,AAAA,uFAAA,AAAAH,gBAAUJ;AAAjD,AAAA,0FAAA,qEAAA,iJAAA,6HAAA,2CAAA,4DAAA,lSAEIrC,yCAAeC,wGACf8B;AAHJ,AAGgC,wCAAA,jCAACc,sBAAOX;GAHxC,2DAAA;AAAA,AAIgC,wCAAA,jCAACW,sBAAOX;GAJxC,iEAAA,AAAAO,4CAAA,4HAAA,AAAAA,xJAKkCP,+GAC9BZ,yDAAgBY,YAAW,AAAA,0FAAA,AAAAO,gBAAWhB,kBACvC,yJAAA,KAAA,5JAAU,AAACqB,uBAAO,AAAA,0FAAA,AAAAL,gBAAWF,2BAAoB,AAACjC","names":["webapp.targets.views.main/section-header","admin?","webapp.targets.views.targets-filter/main","webapp.components.button/primary","re-frame.core/dispatch","webapp.targets.views.target-form-modal/form","webapp.targets.views.main/next-page","js/webapp","js/webapp.targets","js/webapp.targets.views","js/webapp.targets.views.main","js/webapp.targets.views.main.targets-layout","method-table__4747__auto__","cljs.core.atom","prefer-table__4748__auto__","method-cache__4749__auto__","cached-hierarchy__4750__auto__","hierarchy__4751__auto__","cljs.core.get","fexpr__30803","cljs.core/MultiFn","cljs.core.symbol","webapp.targets.views.main/targets-layout","cljs.core/identity","_","targets","webapp.targets.views.list-view/main","webapp.targets.views.grid-view/main","p__30804","map__30805","cljs.core/--destructure-map","webapp.targets.views.main/layout-switcher","set-grid","set-list","view-style","cljs.core._EQ_","webapp.targets.views.main/panel","user","re_frame.core.subscribe","targets-next-page","reagent.core.atom","cljs.core/deref","cljs.core/some","cljs.core.partial","cljs.core/=","cljs.core/reset!","cljs.core/empty?"],"sourcesContent":["(ns webapp.targets.views.main\n  (:require [re-frame.core :as rf]\n            [reagent.core :as r]\n            [webapp.targets.events :as events]\n            [webapp.subs :as subs]\n            [webapp.components.button :as button]\n            [webapp.targets.views.targets-filter :as targets-filter]\n            [webapp.targets.views.grid-view :as grid-view]\n            [webapp.targets.views.list-view :as list-view]\n            [webapp.targets.views.target-form-modal :as target-form-modal]))\n\n(defn section-header [admin?]\n  [:div\n   {:class \"grid grid-cols-4 gap-regular items-center\"}\n   [:div.search-bar.col-span-3\n    [targets-filter/main]]\n   (when admin? [:div\n    (button/primary {:text \"Create target\"\n                     :on-click #(rf/dispatch [:open-modal [target-form-modal/form nil :create]])})] )])\n\n(defn next-page []\n  [:div.flex.pt-regular.justify-center\n   [:div.w-48\n    (button/primary {:text \"Load more\"\n                     :on-click #(rf/dispatch [::events/get-next-page])})]])\n\n(defmulti ^:private targets-layout identity)\n(defmethod ^:private targets-layout :list [_ targets]\n  [list-view/main targets])\n(defmethod ^:private targets-layout :default [_ targets]\n  [grid-view/main targets])\n\n(defn- layout-switcher [{:keys [set-grid set-list view-style]}]\n  [:div\n   {:class \"flex gap-small text-xs pt-regular pb-small justify-end px-small\"}\n   [:span {:class \"text-xs text-gray-800\"}\n    \"View in:\"]\n   [:span {:on-click set-grid}\n    [:figure {:class (str \"w-4 cursor-pointer \"\n                          \"hover:opacity-80 transition \"\n                          (if (= view-style :grid) \"opacity-100\" \"opacity-50\"))}\n     [:img {:alt \"Grid view\"\n            :role \"button\"\n            :src \"/icons/icon-grid-gray.svg\"}]]]\n   [:span {:on-click set-list}\n    [:figure {:class (str \"w-4 cursor-pointer \"\n                          \"hover:opacity-80 transition \"\n                          (if (= view-style :list) \"opacity-100\" \"opacity-50\"))}\n     [:img {:alt \"List view\"\n            :role \"button\"\n            :src \"/icons/icon-list-gray.svg\"}]]]])\n\n(defn panel []\n  (let [user (rf/subscribe [::subs/user])\n        targets (rf/subscribe [::subs/targets])\n        targets-next-page (rf/subscribe [::subs/targets-next-page])\n        view-style (r/atom :grid)]\n    (rf/dispatch [:get-targets])\n    (fn []\n      (let [admin? (some (partial = \"admin\") (:groups @user))]\n        [:div.px-large\n         [section-header admin?]\n         [layout-switcher {:set-grid #(reset! view-style :grid)\n                           :set-list #(reset! view-style :list)\n                           :view-style @view-style}]\n         [targets-layout @view-style (:results @targets)]\n         (when-not (empty? (:results @targets-next-page)) (next-page))] ))))\n"]}